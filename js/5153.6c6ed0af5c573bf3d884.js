"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[5153],{95153:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var a=n(42982),l=n(15671),r=n(43144),i=n(79340),c=n(82963),s=n(61120),o=n(4361),u=n(89555),m=n(35356),d=n(76473),p=n(96486),g=n(92950),E=n.n(g),h=n(62012),f=n(844),k=n(1161),D=n(42807),_=n(61647),L=n(52713),v=n(90005);var b=function(e){return D.g.TASK_NAMES[e]&&u.ag._(D.g.TASK_NAMES[e])||e},T=function(e){(0,i.Z)(D,e);var t,n,g=(t=D,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,s.Z)(t);if(n){var l=(0,s.Z)(this).constructor;e=Reflect.construct(a,arguments,l)}else e=a.apply(this,arguments);return(0,c.Z)(this,e)});function D(e){var t;return(0,l.Z)(this,D),(t=g.call(this,e)).state={loading:!0,task:null,parentTask:null,childTasks:[],alerts:[],cancelModalVisible:!1,taskName:"",resources:[],redirect:null,polling:null},t}return(0,r.Z)(D,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"componentWillUnmount",value:function(){this.state.polling&&clearInterval(this.state.polling)}},{key:"componentDidUpdate",value:function(e){e.routeParams.task!==this.props.routeParams.task&&(this.setState({loading:!0}),this.loadContent())}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.task,l=t.parentTask,r=t.childTasks,i=t.cancelModalVisible,c=t.alerts,s=t.taskName,o=t.resources,g=t.redirect,f=[{url:(0,_.dI)(_.nB.taskList),name:u.ag._({id:"JET7Si"})},{name:a?s:""}],D=null;return l&&(D=(0,v.L)(l.pulp_href)),g?E().createElement(h.Navigate,{to:g}):n?E().createElement(k.AW,null):E().createElement(E().Fragment,null,E().createElement(k.UW,{alerts:c,closeAlert:function(t){return e.closeAlert(t)}}),i?this.renderCancelModal():null,E().createElement(k.UP,{title:s,breadcrumbs:E().createElement(k.Oo,{links:f}),pageControls:["running","waiting"].includes(a.state)&&E().createElement(m.Button,{variant:"secondary",onClick:function(){return e.setState({cancelModalVisible:!0})}},u.ag._({id:"iNUMdZ"})),status:E().createElement(k.Eg,{className:"hub-c-task-status",status:a.state})}),E().createElement(k.or,null,E().createElement(m.Flex,null,E().createElement(m.Flex,{direction:{default:"column"},flex:{default:"flex_1"}},E().createElement(m.FlexItem,null,E().createElement("section",{className:"body card-area"},E().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.ag._({id:"fqgZ6m"})),E().createElement("br",null),E().createElement(m.DescriptionList,{isHorizontal:!0},E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"ogBUiv"})),E().createElement(m.DescriptionListDescription,null,a.name)),a.name!==s&&E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"2Yhrad"})),E().createElement(m.DescriptionListDescription,null,s)),E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"IiN/kH"})),E().createElement(m.DescriptionListDescription,null,E().createElement(k.Id,{date:a.finished_at}))),E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"45O6zJ"})),E().createElement(m.DescriptionListDescription,null,E().createElement(k.Id,{date:a.pulp_created})))))),E().createElement(m.FlexItem,null,E().createElement("section",{className:"body card-area"},E().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.ag._({id:"j0dOoV"})),E().createElement("br",null),E().createElement(m.DescriptionList,{isHorizontal:!0},E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"In9f9E"})),E().createElement(m.DescriptionListDescription,null,a.task_group?a.task_group:u.ag._({id:"0t88cp"}))),E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"ggsFl6"})),E().createElement(m.DescriptionListDescription,null,l?E().createElement(h.Link,{to:(0,_.dI)(_.nB.taskDetail,{task:D})},b(l.name)):u.ag._({id:"TInr2q"}))),E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"dKlcTI"})),E().createElement(m.DescriptionListDescription,null,r.length?r.map((function(e){var t=(0,v.L)(e.pulp_href);return E().createElement(E().Fragment,{key:t},E().createElement(h.Link,{to:(0,_.dI)(_.nB.taskDetail,{task:t})},b(e.name)),E().createElement("br",null))})):u.ag._({id:"59KJyD"})))))),E().createElement(m.FlexItem,null,E().createElement("section",{className:"body card-area"},E().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.ag._({id:"7Ackjt"})),E().createElement("br",null),o.length?E().createElement(m.DescriptionList,{isHorizontal:!0},o.map((function(e,t){return E().createElement(E().Fragment,{key:e.type+t},E().createElement("hr",null),E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"+zy2Nq"})),E().createElement(m.DescriptionListDescription,null,e.type)),e.pluginName&&E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"fOuPPd"})),E().createElement(m.DescriptionListDescription,null,e.pluginName)),e.name&&E().createElement(m.DescriptionListGroup,null,E().createElement(m.DescriptionListTerm,null,u.ag._({id:"6YtxFj"})),E().createElement(m.DescriptionListDescription,null,e.name)))}))):u.ag._({id:"CJcaCv"})))),E().createElement(m.Flex,{direction:{default:"column"},flex:{default:"flex_1"}},E().createElement(m.FlexItem,null,!a.error&&E().createElement("section",{className:"body card-area"},E().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.ag._({id:"IsjXnX"})),E().createElement("br",null),a.progress_reports.length?E().createElement(m.DescriptionList,{isHorizontal:!0},a.progress_reports.reverse().map((function(e,t){return E().createElement(E().Fragment,{key:t},E().createElement("hr",null),Object.keys(e).map((function(t,n){return!!e[t]&&E().createElement(m.DescriptionListGroup,{key:t+n},E().createElement(m.DescriptionListTerm,null,{message:u.ag._({id:"xDAtGP"}),code:u.ag._({id:"EWPtMO"}),state:u.ag._({id:"RS0o7b"}),done:u.ag._({id:"DPfwMq"})}[t]||(0,p.capitalize)(t)),E().createElement(m.DescriptionListDescription,null,e[t]))}))," ")}))):E().createElement(k.WU,{icon:d.TF,title:u.ag._({id:"orUwNA"}),description:u.ag._({id:"orUwNA"})})),!!a.error&&E().createElement("section",{className:"body card-area"},E().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.ag._({id:"xi4nE2"})),E().createElement("br",null),E().createElement(E().Fragment,null,E().createElement(m.Title,{headingLevel:"h3"},u.ag._({id:"Nu4oKW"})),E().createElement(m.CodeBlock,null,a.error.description),E().createElement(m.Title,{headingLevel:"h3"},u.ag._({id:"g3fe3D"})),E().createElement(m.CodeBlock,{className:"hub-code-block"},a.error.traceback))))))))}},{key:"renderCancelModal",value:function(){var e=this,t=this.state.taskName;return E().createElement(k.sm,{cancelAction:function(){return e.setState({cancelModalVisible:!1})},confirmAction:function(){return e.cancelTask()},title:u.ag._({id:"iNUMdZ"}),confirmButtonTitle:u.ag._({id:"gspY5b"})},u.ag._({id:"NBEgeZ",values:{name:t}}))}},{key:"cancelTask",value:function(){var e=this,t=this.state,n=t.task,l=t.taskName;f.sb.patch((0,v.L)(n.pulp_href),{state:"canceled"}).then((function(){e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.Z)(e.state.alerts),[{variant:"success",title:l,description:E().createElement(o.cC,{id:"xnof66",values:{taskName:l}})}])}),e.loadContent()})).catch((function(t){var n=t.response,r=n.status,i=n.statusText;e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.Z)(e.state.alerts),[{variant:"danger",title:u.ag._({id:"M2gqxI",values:{taskName:l}}),description:(0,L.N3)(r,i)}])}),e.loadContent()}))}},{key:"loadContent",value:function(){var e=this;this.state.polling||this.state.task||this.setState({polling:setInterval((function(){return e.loadContent()}),1e4)});var t=this.props.routeParams.task;return f.sb.get(t).then((function(t){var n=[],a=null,l=[],r=[];if(["canceled","completed","failed"].includes(t.data.state)&&(clearInterval(e.state.polling),e.setState({polling:null})),t.data.parent_task){var i=(0,v.L)(t.data.parent_task);n.push(f.sb.get(i).then((function(e){a=e.data})).catch((function(){return!0})))}return t.data.child_tasks.length&&t.data.child_tasks.forEach((function(e){var t=(0,v.L)(e);n.push(f.sb.get(t).then((function(e){l.push(e.data)})).catch((function(){return!0})))})),t.data.reserved_resources_record.length&&t.data.reserved_resources_record.forEach((function(e){var t=e.replace("/api/automation-hub/pulp/api/v3/",""),a=(0,v.L)(t),l=t.split("/"),i="",c="";l.length>=3?(i="".concat(l[0],": ").concat(l[2]),c=l[1]):e=l[0],a?n.push(f.O8.get(t).then((function(e){r.push({name:e.data.name,type:i,pluginName:c})})).catch((function(){return!0}))):r.push({type:i})})),Promise.all(n).then((function(){e.setState({task:t.data,childTasks:l,parentTask:a,loading:!1,taskName:b(t.data.name),resources:r})}))})).catch((function(){e.setState({redirect:(0,_.dI)(_.nB.notFound)})}))}},{key:"closeAlert",get:function(){return(0,k.NQ)("alerts")}}]),D}(E().Component);const y=(0,L.EN)(T)}}]);
//# sourceMappingURL=../sourcemaps/5153.6840996fde9dd40422f626b360d41ed8.js.map