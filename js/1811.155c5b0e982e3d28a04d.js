"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[1811],{61811:(e,t,n)=>{n.d(t,{Bu:()=>d,bU:()=>v,PU:()=>f,MC:()=>y,Rq:()=>_,JJ:()=>b,Ub:()=>j,No:()=>B,sO:()=>g,DO:()=>h,e5:()=>O,cv:()=>N,hE:()=>w,W:()=>V});var r=n(35356),o=n(92950),a=n.n(o),i=n(41315),l=function(e){var t=e.buttonVariant,n=e.condition,o=void 0===n?function(){return!0}:n,l=e.disabled,c=void 0===l?function(){return null}:l,s=e.modal,u=void 0===s?null:s,d=e.onClick,m=e.title,p=e.visible,v=void 0===p?function(){return!0}:p;return{title:m,button:function(e,n){return o(n,e)&&v(e,n)?c(e,n)?a().createElement(i.u,{content:c(e,n),key:m},a().createElement(r.Button,{variant:t,isDisabled:!0},m)):a().createElement(r.Button,{variant:t,key:m,onClick:function(){return d(e,n)}},m):null},dropdownItem:function(e,t){return o(t,e)&&v(e,t)?c(e,t)?a().createElement(r.DropdownItem,{key:m,description:c(e,t),isDisabled:!0},m):a().createElement(r.DropdownItem,{key:m,onClick:function(){return d(e,t)}},m):null},modal:u,visible:v,disabled:c}},c=n(13855),s=n(61647),u=n(6640),d=l({condition:u.rH,title:c.ag._("Add remote"),onClick:function(e,t){return(0,t.navigate)((0,s.dI)(s.nB.ansibleRemoteEdit,{name:"_"}))}}),m=n(45586),p=n(92518),v=l({condition:u.nm,title:c.ag._("Delete"),modal:function(e){var t=e.addAlert,n=e.query,r=e.setState,o=e.state;return o.deleteModalOpen?a().createElement(i.X3,{closeAction:function(){return r({deleteModalOpen:null})},deleteAction:function(){return function(e,t){var n=e.name,r=e.pulpId,o=t.addAlert,a=t.setState,i=t.query;return m.GC.delete(r).then((function(e){var t=e.data;o((0,p.zT)(t.task,c.ag._("Removal started for remote {name}",{name:n}))),a({deleteModalOpen:null}),i()})).catch((0,p.rJ)(c.ag._("Failed to remove remote {name}",{name:n}),(function(){return null}),o))}(o.deleteModalOpen,{addAlert:t,setState:r,query:n})},name:o.deleteModalOpen.name}):null},onClick:function(e,t){var n=e.name,r=e.id,o=e.pulp_href;return(0,t.setState)({deleteModalOpen:{pulpId:r||(0,p.LL)(o),name:n}})}}),f=l({title:c.ag._("Download CA certificate"),onClick:function(e){var t=e.ca_cert;return(0,p.Qz)(t,"ca_cert")},visible:function(e){return!!e.ca_cert}}),y=l({title:c.ag._("Download client certificate"),onClick:function(e){var t=e.client_cert;return(0,p.Qz)(t,"client_cert")},visible:function(e){return!!e.client_cert}}),_=l({title:c.ag._("Download requirements YAML"),onClick:function(e){var t=e.requirements_file;return(0,p.Qz)(t,"requirements.yml")},visible:function(e){return!!e.requirements_file}}),b=l({condition:u.DQ,title:c.ag._("Edit"),onClick:function(e,t){var n=e.name;return(0,t.navigate)((0,s.dI)(s.nB.ansibleRemoteEdit,{name:n}))}}),g=l({title:c.ag._("Copy CLI configuration"),onClick:function(e,t){var n=t.addAlert,r=["[galaxy]","server_list = ".concat(e.name,"_repo"),"","[galaxy_server.".concat(e.name,"_repo]"),"url=".concat((0,p.qX)()),"token=<put your token here>"].join("\n");navigator.clipboard.writeText(r),n({title:c.ag._("Successfully copied to clipboard"),variant:"success",description:a().createElement("pre",null,r)})}}),h=l({condition:u.zN,title:c.ag._("Add repository"),onClick:function(e,t){return(0,t.navigate)((0,s.dI)(s.nB.ansibleRepositoryEdit,{name:"_"}))}}),C=n(42982),k=n(15861),E=n(64687),A=n.n(E),M=n(42807),O=l({condition:u.Xn,title:c.ag._("Delete"),modal:function(e){var t=e.addAlert,n=e.query,r=e.setState,o=e.state;return o.deleteModalOpen?a().createElement(i.Iq,{closeAction:function(){return r({deleteModalOpen:null})},deleteAction:function(){return function(e,t){return S.apply(this,arguments)}(o.deleteModalOpen,{addAlert:t,setState:r,query:n})},name:o.deleteModalOpen.name}):null},onClick:function(e,t){var n=e.name,r=e.id,o=e.pulp_href;return(0,t.setState)({deleteModalOpen:{pulpId:r||(0,p.LL)(o),name:n,pulp_href:o}})},disabled:function(e){var t=e.name;return M.g.PROTECTED_REPOSITORIES.includes(t)?c.ag._("Protected repositories cannot be deleted."):null}});function S(){return(S=(0,k.Z)(A().mark((function e(t,n){var r,o,a,i,l,s,u,d,v;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,o=t.pulp_href,a=t.pulpId,i=n.addAlert,l=n.setState,s=n.query,e.next=4,m.Lj.list({repository:o}).then((function(e){return e.data.results||[]})).catch((function(e){return(0,p.rJ)(c.ag._("Failed to list distributions, removing only the repository."),(function(){return null}),i)(e),[]}));case 4:return u=e.sent,d=m.UX.delete(a).then((function(e){var t=e.data;i((0,p.zT)(t.task,c.ag._("Removal started for repository {name}",{name:r})))})).catch((0,p.rJ)(c.ag._("Failed to remove repository {name}",{name:r}),(function(){return l({deleteModalOpen:null})}),i)),v=function(e){var t=e.name,n=e.pulp_href,r=(0,p.LL)(n);return m.Lj.delete(r).then((function(e){var n=e.data;return i((0,p.zT)(n.task,c.ag._("Removal started for distribution {name}",{name:t})))})).catch((0,p.rJ)(c.ag._("Failed to remove distribution {name}",{name:t}),(function(){return null}),i))},e.abrupt("return",Promise.all([d].concat((0,C.Z)(u.map(v)))).then((function(){l({deleteModalOpen:null}),s()})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=l({condition:u.lo,title:c.ag._("Edit"),onClick:function(e,t){var n=e.name;return(0,t.navigate)((0,s.dI)(s.nB.ansibleRepositoryEdit,{name:n}))}}),w=l({condition:u.vn,title:c.ag._("Sync"),onClick:function(e,t){var n=e.name,r=e.pulp_href,o=t.addAlert,a=t.query,i=(0,p.LL)(r);m.UX.sync(i,{mirror:!0}).then((function(e){var t=e.data;o((0,p.zT)(t.task,c.ag._('Sync started for repository "{name}".',{name:n}))),a()})).catch((0,p.rJ)(c.ag._('Failed to sync repository "{name}"',{name:n}),(function(){return null}),o))},visible:function(e,t){return(0,t.hasPermission)("ansible.change_collectionremote")},disabled:function(e){var t=e.remote,n=e.last_sync_task;return t?n&&["running","waiting"].includes(n.state)?c.ag._("Sync task is already queued."):null:c.ag._("There are no remotes associated with this repository.")}}),q=n(70885),D=n(14744),R=function(e){var t=e.version,n=e.cancelAction,i=e.revertAction,l=(0,o.useState)(!1),s=(0,q.Z)(l,2),u=s[0],d=s[1];return a().createElement(r.Modal,{actions:[a().createElement("div",{"data-cy":"delete-button",key:"delete"},a().createElement(r.Button,{key:"delete",onClick:function(){d(!0),i()},variant:"danger",isDisabled:u},c.ag._("Revert"),u&&a().createElement(r.Spinner,{size:"sm"}))),a().createElement(r.Button,{key:"cancel",onClick:n,variant:"link"},c.ag._("Cancel"))],isOpen:!0,onClose:n,title:c.ag._("Revert repository"),titleIconVariant:"warning",variant:"small","data-cy":"modal_checkbox"},a().createElement(D.cC,{id:"Are you sure you want to revert this repository to the version below?"}),a().createElement("br",null),a().createElement("b",null,t))},V=l({condition:u.Wt,title:c.ag._("Revert to this version"),modal:function(e){var t=e.addAlert,n=e.state,r=e.setState,o=e.query;return n.revertModal?a().createElement(R,{cancelAction:function(){return r({revertModal:null})},revertAction:function(){return function(e,t){var n=e.repositoryName,r=e.pulp_href,o=e.number,a=t.addAlert,i=t.setState,l=t.query,s=(0,p.LL)(r);return m.UX.revert(s,r).then((function(e){var t=e.data;a((0,p.zT)(t.task,c.ag._('Revert started for repository "{repositoryName}".',{repositoryName:n}))),i({revertModal:null}),l()})).catch((0,p.rJ)(c.ag._('Failed to revert repository "{repositoryName}" to version "{number}"',{repositoryName:n,number:o}),(function(){return i({revertModal:null})}),a))}(n.revertModal,{addAlert:t,setState:r,query:o})},version:n.revertModal.number}):null},onClick:function(e,t){var n=e.repositoryName,r=e.number,o=e.pulp_href;return(0,t.setState)({revertModal:{repositoryName:n,number:r,pulp_href:o}})},disabled:function(e){return e.isLatest?c.ag._("Already the current version"):null}}),L=n(4942);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,L.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){var t=e.addAction,n=e.closeAction,l=(0,o.useState)([]),s=(0,q.Z)(l,2),u=s[0],d=s[1],v=(0,o.useState)([]),f=(0,q.Z)(v,2),y=f[0],_=f[1],b=function(e){var t=T({},e.params);return t.ordering=t.sort,delete t.sort,m.eq.list(T({},t)).then((function(e){var t=e.data;return{data:{count:t.meta.count,results:t.data}}}))},g=(0,o.useState)({}),h=(0,q.Z)(g,2),k=h[0],E=h[1];return a().createElement(r.Modal,{actions:[a().createElement(r.Button,{key:"confirm",onClick:function(){return t(y)},variant:"primary",isDisabled:!y},c.ag._("Select")),a().createElement(r.Button,{key:"cancel",onClick:n,variant:"link"},c.ag._("Cancel"))],isOpen:!0,onClose:n,title:c.ag._("Select a collection"),variant:"large"},a().createElement("section",{className:"modal-body","data-cy":"modal-body"},a().createElement(i.qU,{actionContext:{addAlert:function(e){d([].concat((0,C.Z)(u),[e]))},state:k,setState:E,query:b,hasPermission:function(){throw"unused"}},defaultPageSize:10,defaultSort:"name",errorTitle:c.ag._("Collection versions could not be displayed."),filterConfig:[{id:"keywords",title:c.ag._("Keywords")},{id:"namespace",title:c.ag._("Namespace")},{id:"repository_name",title:c.ag._("Repository")}],noDataDescription:c.ag._("Collection versions will appear once a collection is uploaded."),noDataTitle:c.ag._("No collection versions yet"),query:b,renderTableRow:function(e,t){var n=e.collection_version,o=n.name,i=n.namespace,l=n.version,c=n.description,s=e.repository;return a().createElement("tr",{onClick:function(){return _(p.KU.pushToOrFilterOutCollections(e,y))},key:t},a().createElement("td",null,a().createElement(r.Checkbox,{"aria-label":"".concat(i,".").concat(o," v").concat(l),id:"collection-".concat(t),isChecked:y.includes(e),name:"collection-".concat(t)})),a().createElement("td",null,i,".",o," v",l),a().createElement("td",null,c),a().createElement("td",null,s.name))},sortHeaders:[{title:"",type:"none",id:"radio"},{title:c.ag._("Collection"),type:"none",id:"col1"},{title:c.ag._("Description"),type:"none",id:"col2"},{title:c.ag._("Repository"),type:"none",id:"col3"}],title:c.ag._("Collection versions")})),a().createElement(i.UW,{alerts:u,closeAlert:function(e){return(0,i.M6)(e,{alerts:u,setAlerts:d})}}))},j=l({condition:u.lo,title:c.ag._("Add collection"),modal:function(e){var t=e.addAlert,n=e.state,r=e.setState,o=e.query;return n.addCollectionVersionModal?a().createElement(I,{addAction:function(e){!function(e,t,n){var r=e.repositoryHref,o=e.repositoryName,a=n.addAlert,i=n.setState,l=n.query,s=(0,p.LL)(r),u=t.map((function(e){return e.collection_version.pulp_href}));m.UX.addContent(s,u).then((function(e){var n=e.data;t.map((function(e){var t=e.collection_version,r=t.name,s=t.namespace,u=t.version,d=e.repository;a((0,p.zT)(n.task,c.ag._('Started adding {namespace}.{name} v{version} from "{0}" to repository "{repositoryName}".',{0:d.name,namespace:s,name:r,version:u,repositoryName:o}))),i((function(e){return T(T({},e),{},{addCollectionVersionModal:null})})),l({})}))})).catch((0,p.rJ)(c.ag._('{0, plural, one {Failed to add collection to repository "{repositoryName}".} other {Failed to add collections to repository "{repositoryName}".}}',{0:t.length,repositoryName:o}),(function(){return i((function(e){return T(T({},e),{},{addCollectionVersionModal:null})}))}),a))}(n.addCollectionVersionModal,e,{addAlert:t,setState:r,query:o})},closeAction:function(){return r((function(e){return T(T({},e),{},{addCollectionVersionModal:null})}))}}):null},onClick:function(e,t){var n=t.state.repository,r=n.name,o=n.pulp_href;return(0,t.setState)((function(e){return T(T({},e),{},{addCollectionVersionModal:{repositoryHref:o,repositoryName:r}})}))}}),z=function(e){var t=e.name,n=e.namespace,l=e.repositoryName,s=e.version,u=e.closeAction,d=e.deleteAction,m=(0,o.useState)(!1),p=(0,q.Z)(m,2),v=p[0],f=p[1];return t?a().createElement(i.pf,{spinner:v,cancelAction:function(){f(!1),u()},deleteAction:function(){f(!1),d()},isDisabled:v,isRemove:!0,title:c.ag._("Remove collection version?")},a().createElement(r.Text,null,a().createElement(D.cC,{id:"Are you sure you want to remove the collection version <0>{namespace}.{name} v{version}</0> from the <1>{repositoryName}</1> repository?",values:{namespace:n,name:t,version:s,repositoryName:l},components:{0:a().createElement("b",null),1:a().createElement("b",null)}}))):null},B=l({condition:u.lo,title:c.ag._("Remove"),modal:function(e){var t=e.addAlert,n=e.state,r=e.setState,o=e.query;return n.removeCollectionVersionModal?a().createElement(z,{closeAction:function(){return r({removeCollectionVersionModal:null})},deleteAction:function(){return function(e,t){var n=e.collection,r=n.namespace,o=n.name,a=n.version,i=e.collectionVersionHref,l=e.repositoryHref,s=e.repositoryName,u=t.addAlert,d=t.setState,v=t.query,f=(0,p.LL)(l);return m.UX.removeContent(f,i).then((function(e){var t=e.data;u((0,p.zT)(t.task,c.ag._('Removal of {namespace}.{name} v{version} from repository "{repositoryName}" started.',{namespace:r,name:o,version:a,repositoryName:s}))),d({removeCollectionVersionModal:null}),v()})).catch((0,p.rJ)(c.ag._('Failed to remove {namespace}.{name} v{version} from repository "{repositoryName}".',{namespace:r,name:o,version:a,repositoryName:s}),(function(){return d({removeCollectionVersionModal:null})}),u))}(n.removeCollectionVersionModal,{addAlert:t,setState:r,query:o})},name:n.removeCollectionVersionModal.collection.name,namespace:n.removeCollectionVersionModal.collection.namespace,repositoryName:n.removeCollectionVersionModal.repositoryName,version:n.removeCollectionVersionModal.collection.version}):null},onClick:function(e,t){var n=e.collection_version,r=n.namespace,o=n.name,a=n.version,i=n.pulp_href,l=e.repository,c=l.name,s=l.pulp_href;return(0,t.setState)({removeCollectionVersionModal:{collection:{namespace:r,name:o,version:a},repositoryName:c,repositoryHref:s,collectionVersionHref:i}})}})},6640:(e,t,n)=>{n.d(t,{DQ:()=>l,MT:()=>c,Wt:()=>y,X0:()=>f,Xn:()=>d,fY:()=>v,lo:()=>m,nm:()=>i,rH:()=>a,vn:()=>p,yA:()=>s,zN:()=>u});var r=function(e){return function(t){var n=t.hasPermission,r=t.user;return n(e)||(null==r?void 0:r.is_superuser)}},o=function(e){return function(t,n){var r=t.hasPermission,o=t.hasObjectPermission,a=t.user;return r(e)||(null==o?void 0:o(e,n))||(null==a?void 0:a.is_superuser)}},a=r("ansible.add_collectionremote"),i=o("ansible.delete_collectionremote"),l=o("ansible.change_collectionremote"),c=o("ansible.view_collectionremote"),s=o("ansible.manage_roles_collectionremote"),u=r("ansible.add_ansiblerepository"),d=o("ansible.delete_ansiblerepository"),m=o("ansible.change_ansiblerepository"),p=m,v=function(e){var t=e.user;return t&&!t.is_anonymous},f=o("ansible.manage_roles_ansiblerepository"),y=m}}]);
//# sourceMappingURL=../sourcemaps/1811.8f47b056a6e61159ed3371610c8b1c31.js.map