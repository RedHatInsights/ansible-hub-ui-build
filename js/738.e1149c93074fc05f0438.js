"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[738],{67738:(e,t,a)=>{a.r(t),a.d(t,{TaskListView:()=>B,default:()=>C});var n=a(45458),i=a(23029),r=a(92901),l=a(56822),u=a(53954),s=a(15361),c=a(64467),o=a(42328),d=a(47712),m=a(30769),p=a(5924),f=a(64490),h=a(52565),v=a(72583),_=a(31554),T=a(97192),g=a(26805),E=a(52068),k=a(44914),y=a.n(k),R=a(78765),b=a(88696),A=a(35894),S=a(97899),x=a(60165),P=a(39799);function q(e,t,a){return t=(0,u.A)(t),(0,l.A)(e,w()?Reflect.construct(t,a||[],(0,u.A)(e).constructor):t.apply(e,a))}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}var B=function(e){function t(e){var a;(0,i.A)(this,t),a=q(this,t,[e]);var n=P.mb.parseParamString(e.location.search,["page","page_size"]);return n.page_size||(n.page_size=10),n.sort||(n.sort="-pulp_created"),a.state={params:n,items:[],loading:!0,itemCount:0,alerts:[],cancelModalVisible:!1,selectedTask:null,unauthorised:!1,inputText:""},a}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidMount",value:function(){var e=this.context.user;!e||e.is_anonymous?this.setState({loading:!1,unauthorised:!0}):this.queryTasks()}},{key:"render",value:function(){var e=this,t=this.state,a=t.params,n=t.itemCount,i=t.loading,r=t.items,l=t.alerts,u=t.cancelModalVisible,s=t.unauthorised,c=0===r.length&&!(0,P.l)(a,["name__contains","state"]);return y().createElement(y().Fragment,null,y().createElement(A.NS,{alerts:l,closeAlert:function(t){return(0,A.R$)(t,{alerts:l,setAlerts:function(t){return e.setState({alerts:t})}})}}),u?this.renderCancelModal():null,y().createElement(A.T$,{title:d.Ru._({id:"JET7Si"})}),s?y().createElement(A.Pd,null):c&&!i?y().createElement(A.a4,{title:d.Ru._({id:"qg0XeA"}),description:d.Ru._({id:"bOUnO9"})}):y().createElement(A.gZ,null,i?y().createElement(A.kt,null):y().createElement("section",{className:"body"},y().createElement("div",{className:"hub-toolbar"},y().createElement(m.M,null,y().createElement(p.P,null,y().createElement(f.$,null,y().createElement(h.T,null,y().createElement(A.Mw,{inputText:this.state.inputText,onChange:function(t){return e.setState({inputText:t})},updateParams:function(t){return e.updateParams(t,(function(){return e.queryTasks()}))},params:a,filterConfig:[{id:"name__contains",title:d.Ru._({id:"ogBUiv"})},{id:"state",title:d.Ru._({id:"uAQUqI"}),inputType:"select",options:[{id:"completed",title:d.Ru._({id:"qqWcBV"})},{id:"failed",title:d.Ru._({id:"7Bj3x9"})},{id:"running",title:d.Ru._({id:"RiQMUh"})},{id:"waiting",title:d.Ru._({id:"uUehLT"})}]}]}))))),y().createElement(A.w1,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryTasks()}))},count:n,isTop:!0})),y().createElement("div",null,y().createElement(A.lU,{updateParams:function(t){e.updateParams(t,(function(){return e.queryTasks()})),e.setState({inputText:""})},params:a,ignoredParams:["page_size","page","sort","ordering"],niceNames:{name__contains:d.Ru._({id:"ogBUiv"}),state:d.Ru._({id:"uAQUqI"})}})),i?y().createElement(A.kt,null):this.renderTable(a),y().createElement(A.w1,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryTasks()}))},count:n}))))}},{key:"renderTable",value:function(e){var t=this,a=this.state.items;if(0===a.length)return y().createElement(A.br,null);var n={headers:[{title:d.Ru._({id:"ogBUiv"}),type:"alpha",id:"name"},{title:d.Ru._({id:"Nu4oKW"}),type:"none",id:"description"},{title:d.Ru._({id:"45O6zJ"}),type:"numeric",id:"pulp_created"},{title:d.Ru._({id:"YgkVxJ"}),type:"numeric",id:"started_at"},{title:d.Ru._({id:"IiN/kH"}),type:"numeric",id:"finished_at"},{title:d.Ru._({id:"uAQUqI"}),type:"alpha",id:"state"}]};return y().createElement(_.X,{"aria-label":d.Ru._({id:"E1/c72"})},y().createElement(A.HW,{options:n,params:e,updateParams:function(e){return t.updateParams(e,(function(){return t.queryTasks()}))}}),y().createElement(T.N,null,a.map((function(e,a){return t.renderTableRow(e,a)}))))}},{key:"renderTableRow",value:function(e,t){var a=e.name,n=e.state,i=e.pulp_created,r=e.started_at,l=e.finished_at,u=e.pulp_href,s=(0,P.dx)(u),c=(0,P.qo)(a);return y().createElement(g.Tr,{key:t},y().createElement(E.Td,null,y().createElement(R.Link,{to:(0,x.jV)(x.Jh.taskDetail,{task:s})},a)),y().createElement(E.Td,null,c!==a?c:null),y().createElement(E.Td,null,y().createElement(A.gz,{date:i})),y().createElement(E.Td,null,y().createElement(A.gz,{date:r})),y().createElement(E.Td,null,y().createElement(A.gz,{date:l})),y().createElement(E.Td,null,y().createElement(A.kx,{status:n})),y().createElement(E.Td,null,this.cancelButton(n,e)))}},{key:"cancelButton",value:function(e,t){var a=this;switch(e){case"running":case"waiting":return y().createElement(v.$n,{variant:"secondary","aria-label":d.Ru._({id:"cnGeoo"}),key:"delete",onClick:function(){return a.setState({cancelModalVisible:!0,selectedTask:t})}},d.Ru._({id:"iNUMdZ"}))}}},{key:"renderCancelModal",value:function(){var e=this,t=this.state.selectedTask,a=(0,P.qo)(t.name);return y().createElement(A.uo,{cancelAction:function(){return e.setState({cancelModalVisible:!1})},title:d.Ru._({id:"7H2WNz"}),confirmAction:function(){return e.selectedTask(t,a)},confirmButtonTitle:d.Ru._({id:"gspY5b"})},d.Ru._({id:"t4TbT9",values:{name:a}}))}},{key:"selectedTask",value:function(e,t){var a=this,i=e.pulp_href;b.dw.patch((0,P.dx)(i),{state:"canceled"}).then((function(){a.setState({loading:!0,selectedTask:null,cancelModalVisible:!1,alerts:[].concat((0,n.A)(a.state.alerts),[{variant:"success",title:t,description:y().createElement(o.x6,{id:"BC6Shx",values:{name:t}})}])}),a.queryTasks()})).catch((function(e){var i=e.response,r=i.status,l=i.statusText;a.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,n.A)(a.state.alerts),[{variant:"danger",title:d.Ru._({id:"vwx3Sy",values:{name:t}}),description:(0,P.gJ)(r,l)}])})}))}},{key:"queryTasks",value:function(){var e=this;this.setState({loading:!0},(function(){b.dw.list(e.state.params).then((function(t){e.setState({items:t.data.results,itemCount:t.data.count,loading:!1})})).catch((function(t){var a=t.response,i=a.status,r=a.statusText;e.setState({loading:!1,items:[],itemCount:0,alerts:[].concat((0,n.A)(e.state.alerts),[{variant:"danger",title:d.Ru._({id:"PK3Bio"}),description:(0,P.gJ)(i,r)}])})}))}))}},{key:"addAlert",value:function(e,t,a){this.setState({alerts:[].concat((0,n.A)(this.state.alerts),[{description:a,title:e,variant:t}])})}},{key:"updateParams",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;P.mb.updateParams({params:e,navigate:function(e){return t.props.navigate(e)},setState:function(e){return t.setState(e,a)}})}}]),t}(k.Component);(0,c.A)(B,"contextType",S.B);const C=(0,P.y)(B)}}]);
//# sourceMappingURL=../sourcemaps/738.68de8a1d8738dc55bfd2e3a1251d059d.js.map