"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[378],{98809:(e,t,n)=>{n.r(t),n.d(t,{Repository:()=>Z,default:()=>N});var r,o,a,s,i,c,u=n(30168),l=n(43144),m=n(97326),d=n(60136),f=n(6215),p=n(61120),h=n(4942),g=n(15671),E=n(67294),b=n(5977),y=n(92942),v=n(6568),O=n(42807),M=n(74761),P=n(61542);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,h.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function e(){(0,g.Z)(this,e)},C=function(e){(0,d.Z)(P,e);var t,n,b=(t=P,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,p.Z)(t);if(n){var o=(0,p.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,f.Z)(this,e)});function P(e){var t;(0,g.Z)(this,P),t=b.call(this,e),(0,h.Z)((0,m.Z)(t),"nonQueryStringParams",["repository"]),(0,h.Z)((0,m.Z)(t),"selectRemoteToEdit",(function(e){t.unModifiedRemote=S({},e),t.setState({remoteToEdit:S({},e),showRemoteFormModal:!0})})),(0,h.Z)((0,m.Z)(t),"refreshContent",(function(){t.loadContent(!1)})),(0,h.Z)((0,m.Z)(t),"loadContent",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=t.state.params;t.setState({loading:e},(function(){if("remote"==n.tab)M.eU.list(v.q6.getReduced(n,t.nonQueryStringParams)).then((function(e){t.setState({loading:!1,content:e.data.data,itemCount:e.data.meta.count})}));else{var e=M.Pt;"insights"===O.g.INSIGHTS_DEPLOYMENT_MODE&&(e=M.g9),e.list().then((function(e){t.setState({loading:!1,content:e.data.data,itemCount:e.data.meta.count})}))}}))}));var n=v.q6.parseParamString(e.location.search,["page","page_size"]);return n.page_size||(n.page_size=10),n.tab||(n.tab="local"),n.tab||"insights"!==O.g.STANDALONE_DEPLOYMENT_MODE||(n.tab="local"),t.state={itemCount:1,params:n,loading:!1,showRemoteFormModal:!1,content:[],remoteToEdit:void 0,errorMessages:{}},t}return(0,l.Z)(P,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"render",value:function(){var e=this,t=this.state,n=t.params,i=t.loading,c=t.content,l=t.remoteToEdit,m=t.showRemoteFormModal,d=t.errorMessages,f=[_(r||(r=(0,u.Z)(["Local"]))),_(o||(o=(0,u.Z)(["Remote"])))];return E.createElement(E.Fragment,null,l&&m&&E.createElement(y.bi,{remote:l,updateRemote:function(t){return e.setState({remoteToEdit:t})},saveRemote:function(){var t=e.state.remoteToEdit;try{var n=t.repositories[0].distributions[0].base_path;M.eU.smartUpdate(n,t,e.unModifiedRemote).then((function(t){e.setState({errorMessages:{},showRemoteFormModal:!1,remoteToEdit:void 0},(function(){return e.loadContent()}))})).catch((function(t){return e.setState({errorMessages:(0,v.TQ)(t)})}))}catch(t){e.setState({errorMessages:{__nofield:_(a||(a=(0,u.Z)(["Can't update remote without a distribution attached to it."])))}})}},errorMessages:d,showModal:m,closeModal:function(){return e.setState({showRemoteFormModal:!1,errorMessages:{}})}}),E.createElement(y.UP,{title:_(s||(s=(0,u.Z)(["Repo Management"])))},"insights"!==O.g.STANDALONE_DEPLOYMENT_MODE||i?null:E.createElement("div",{className:"header-bottom"},E.createElement("div",{className:"tab-link-container"},E.createElement("div",{className:"tabs"},E.createElement(y.mQ,{tabs:f,params:n,updateParams:function(t){e.setState({content:[]},(function(){return e.updateParams(t,(function(){return e.loadContent()}))}))}}))))),i?E.createElement(y.AW,null):this.renderContent(n,c))}},{key:"renderContent",value:function(e,t){var n=this,r=this.context.user;return"insights"===O.g.INSIGHTS_DEPLOYMENT_MODE||e.tab&&"local"===e.tab.toLowerCase()?E.createElement(y.or,{className:"repository-list"},E.createElement("section",{className:"body"},E.createElement(y.j8,{repositories:t,updateParams:this.updateParams}))):e.tab&&"remote"===e.tab.toLowerCase()?0===t.length?E.createElement(y.vv,{title:_(i||(i=(0,u.Z)(["No remote repositories yet"]))),description:_(c||(c=(0,u.Z)(["Remote repositories will appear once added"])))}):E.createElement(y.or,{className:"repository-list"},E.createElement("section",{className:"body"},E.createElement(y.UK,{remotes:t,updateParams:this.updateParams,editRemote:function(e){return n.selectRemoteToEdit(e)},syncRemote:function(e){return M.eU.sync(e).then((function(e){return n.loadContent()}))},user:r,refreshRemotes:this.refreshContent}))):void 0}},{key:"updateParams",get:function(){return v.q6.updateParamsMixin(this.nonQueryStringParams)}}]),P}(E.Component);const N=(0,b.EN)(C);C.contextType=P.I}}]);
//# sourceMappingURL=../sourcemaps/repository-list.beba488ae5f3e134355d.js.map