"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[378],{98809:(e,t,r)=>{r.r(t),r.d(t,{Repository:()=>v,default:()=>M});var n=r(43144),o=r(97326),a=r(60136),s=r(6215),i=r(61120),c=r(4942),u=r(15671),l=r(67294),m=r(5977),d=r(98818),f=r(54213),p=r(6568),h=r(42807),g=r(38045),E=r(61542);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=function e(){(0,u.Z)(this,e)},O=function(e){(0,a.Z)(E,e);var t,r,m=(t=E,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,i.Z)(t);if(r){var o=(0,i.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function E(e){var t;(0,u.Z)(this,E),t=m.call(this,e),(0,c.Z)((0,o.Z)(t),"nonQueryStringParams",["repository"]),(0,c.Z)((0,o.Z)(t),"selectRemoteToEdit",(function(e){t.unModifiedRemote=y({},e),t.setState({remoteToEdit:y({},e),showRemoteFormModal:!0})})),(0,c.Z)((0,o.Z)(t),"refreshContent",(function(){t.loadContent(!1)})),(0,c.Z)((0,o.Z)(t),"loadContent",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=t.state.params;t.setState({loading:e},(function(){if("remote"==r.tab)g.eU.list(p.q6.getReduced(r,t.nonQueryStringParams)).then((function(e){t.setState({loading:!1,content:e.data.data,itemCount:e.data.meta.count})}));else{var e=g.Pt;"insights"===h.g.INSIGHTS_DEPLOYMENT_MODE&&(e=g.g9),e.list().then((function(e){t.setState({loading:!1,content:e.data.data,itemCount:e.data.meta.count})}))}}))}));var r=p.q6.parseParamString(e.location.search,["page","page_size"]);return r.page_size||(r.page_size=10),r.tab||(r.tab="local"),r.tab||"insights"!==h.g.STANDALONE_DEPLOYMENT_MODE||(r.tab="local"),t.state={itemCount:1,params:r,loading:!1,showRemoteFormModal:!1,content:[],remoteToEdit:void 0,errorMessages:{}},t}return(0,n.Z)(E,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"render",value:function(){var e=this,t=this.state,r=t.params,n=t.loading,o=t.content,a=t.remoteToEdit,s=t.showRemoteFormModal,i=t.errorMessages;return l.createElement(l.Fragment,null,a&&s&&l.createElement(d.bi,{remote:a,updateRemote:function(t){return e.setState({remoteToEdit:t})},saveRemote:function(){var t=e.state.remoteToEdit;try{var r=t.repositories[0].distributions[0].base_path;g.eU.smartUpdate(r,t,e.unModifiedRemote).then((function(t){e.setState({errorMessages:{},showRemoteFormModal:!1,remoteToEdit:void 0},(function(){return e.loadContent()}))})).catch((function(t){return e.setState({errorMessages:(0,p.TQ)(t)})}))}catch(t){e.setState({errorMessages:{__nofield:"Can't update remote without a distribution attached to it."}})}},errorMessages:i,showModal:s,closeModal:function(){return e.setState({showRemoteFormModal:!1,errorMessages:{}})}}),l.createElement(d.UP,{title:"Repo Management"},"insights"!==h.g.STANDALONE_DEPLOYMENT_MODE||n?null:l.createElement("div",{className:"header-bottom"},l.createElement("div",{className:"tab-link-container"},l.createElement("div",{className:"tabs"},l.createElement(d.mQ,{tabs:["Local","Remote"],params:r,updateParams:function(t){e.setState({content:[]},(function(){return e.updateParams(t,(function(){return e.loadContent()}))}))}}))))),n?l.createElement(d.AW,null):this.renderContent(r,o))}},{key:"renderContent",value:function(e,t){var r=this,n=this.context.user;return"insights"===h.g.INSIGHTS_DEPLOYMENT_MODE||e.tab&&"local"===e.tab.toLowerCase()?l.createElement(d.or,{className:"repository-list"},l.createElement(f.Z,{className:"body"},l.createElement(d.j8,{repositories:t,updateParams:this.updateParams}))):e.tab&&"remote"===e.tab.toLowerCase()?0===t.length?l.createElement(d.vv,{title:"No remote repositories yet",description:"Remote repositories will appear once added"}):l.createElement(d.or,{className:"repository-list"},l.createElement(f.Z,{className:"body"},l.createElement(d.UK,{remotes:t,updateParams:this.updateParams,editRemote:function(e){return r.selectRemoteToEdit(e)},syncRemote:function(e){return g.eU.sync(e).then((function(e){return r.loadContent()}))},user:n,refreshRemotes:this.refreshContent}))):void 0}},{key:"updateParams",get:function(){return p.q6.updateParamsMixin(this.nonQueryStringParams)}}]),E}(l.Component);const M=(0,m.EN)(O);O.contextType=E.I}}]);
//# sourceMappingURL=../sourcemaps/repository-list.bae87b8787466e467899.js.map