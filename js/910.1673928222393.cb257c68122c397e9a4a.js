"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[910],{9473:(e,t,n)=>{n.d(t,{Y:()=>i});var a=n(4942),c=n(95517),o=n(61647);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e){var t=e.forceReload,n=e.matchParams,a=e.navigate,r=e.selectedRepo,i=e.setCollection,l=e.stateParams;c.gu.getCached(n.namespace,n.collection,r,s(s({},l),{},{include_related:"my_permissions"}),t).then((function(e){return c.gu.list({name:n.collection},r).then((function(t){e.deprecated=t.data.data[0].deprecated,i(e)}))})).catch((function(){a((0,o.dI)(o.nB.notFound))}))}},27910:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var a=n(42982),c=n(70885),o=n(15671),r=n(43144),s=n(97326),i=n(79340),l=n(82963),u=n(61120),d=n(4942),p=n(27693),m=n(92950),f=n(29423),y=n(95517),h=n(48706),v=n(9473),g=n(61647),b=n(61542);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){(0,i.Z)(O,e);var t,n,b=(t=O,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,u.Z)(t);if(n){var c=(0,u.Z)(this).constructor;e=Reflect.construct(a,arguments,c)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function O(e){var t;(0,o.Z)(this,O),t=b.call(this,e),(0,d.Z)((0,s.Z)(t),"ignoredParams",["page_size","page","sort","name__icontains"]);var n=f.q6.parseParamString(e.location.search,["page","page_size"]);return n.sort=n.sort?"collection":"-collection",t.state={collection:void 0,dependencies_repos:[],params:n,usedByDependencies:[],usedByDependenciesCount:0,usedByDependenciesLoading:!0,alerts:[]},t}return(0,r.Z)(O,[{key:"componentDidMount",value:function(){this.loadData(!1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.collection,a=t.params,c=t.usedByDependencies,o=t.usedByDependenciesCount,r=t.usedByDependenciesLoading,s=t.alerts;if(!n)return m.createElement(h.gO,null);var i=[g.Th,{url:(0,g.dI)(g.nB.namespaceByRepo,{namespace:n.namespace.name,repo:this.context.selectedRepo}),name:n.namespace.name},{url:(0,g.dI)(g.nB.collectionByRepo,{namespace:n.namespace.name,collection:n.name,repo:this.context.selectedRepo}),name:n.name},{name:p.ag._("Dependencies")}],l=f.q6.getReduced(a,this.ignoredParams),u=f.q6.getReduced(a,["version"]),d=!Object.keys(n.latest_version.metadata.dependencies).length;return m.createElement(m.Fragment,null,m.createElement(h.UW,{alerts:s,closeAlert:function(t){return e.closeAlert(t)}}),m.createElement(h.X8,{reload:function(){return e.loadData(!0)},collection:n,params:l,updateParams:function(t){e.updateParams(e.combineParams(e.state.params,t),(function(){return e.loadData(!0)}))},breadcrumbs:i,activeTab:"dependencies",repo:this.context.selectedRepo}),m.createElement(h.or,null,m.createElement("section",{className:"body"},m.createElement("div",{className:"pf-c-content collection-dependencies"},m.createElement("h1",null,p.ag._("Dependencies")),!d||o||(0,f.vS)(a,["name__icontains"])?m.createElement(m.Fragment,null,m.createElement("p",null,p.ag._("This collections requires the following collections for use")),d?m.createElement(h.vv,{title:p.ag._("No dependencies"),description:p.ag._("Collection does not have any dependencies.")}):m.createElement(h.nW,{collection:this.state.collection,dependencies_repos:this.state.dependencies_repos}),m.createElement("p",null,p.ag._("This collection is being used by")),m.createElement(h.KQ,{repo:this.context.selectedRepo,usedByDependencies:c,itemCount:o,params:u,usedByDependenciesLoading:r,updateParams:function(t){return e.updateParams(e.combineParams(e.state.params,t),(function(){return e.loadUsedByDependencies()}))}})):m.createElement(h.vv,{title:p.ag._("No dependencies"),description:p.ag._("Collection does not have any dependencies.")})))))}},{key:"loadData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loadCollection(t,(function(){return e.loadCollectionsDependenciesRepos((function(){return e.loadUsedByDependencies()}))}))}},{key:"loadCollectionsDependenciesRepos",value:function(e){var t=this,n=this.state.collection.latest_version.metadata.dependencies,a=[],o=[];Object.keys(n).forEach((function(e){var r=e.split("."),s=(0,c.Z)(r,2),i=s[0],l={name:s[1],namespace:i,version_range:n[e],repo:"",path:""};a.push(l);var u=t.loadDependencyRepo(l);o.push(u)})),Promise.all(o).then((function(){t.setState({dependencies_repos:a},e())}))}},{key:"loadDependencyRepo",value:function(e){return y.eq.list({namespace:e.namespace,name:e.name,version_range:e.version_range,page_size:1}).then((function(t){e.repo=t.data.data[0].repository_list[0],e.path=(0,g.dI)(g.nB.collectionByRepo,{collection:e.name,namespace:e.namespace,repo:e.repo})})).catch((function(){}))}},{key:"loadUsedByDependencies",value:function(){var e=this;this.setState({usedByDependenciesLoading:!0},(function(){e.cancelToken&&e.cancelToken.cancel("request-canceled"),e.cancelToken=y.gu.getCancelToken(),y.gu.getUsedDependenciesByCollection(e.state.collection.namespace.name,e.state.collection.name,f.q6.getReduced(e.state.params,["version"]),e.cancelToken).then((function(t){var n=t.data;e.setState({usedByDependencies:n.data,usedByDependenciesCount:n.meta.count,usedByDependenciesLoading:!1})})).catch((function(t){var n=t.response,c=n.status,o=n.statusText;"request-canceled"!==(null==t?void 0:t.message)&&e.setState({usedByDependenciesLoading:!1,alerts:[].concat((0,a.Z)(e.state.alerts),[{variant:"danger",title:p.ag._("Dependent collections could not be displayed."),description:(0,f.N3)(c,o)}])})})).finally((function(){e.cancelToken=void 0}))}))}},{key:"loadCollection",value:function(e,t){var n=this;(0,v.Y)({forceReload:e,matchParams:this.props.routeParams,navigate:this.props.navigate,selectedRepo:this.context.selectedRepo,setCollection:function(e){return n.setState({collection:e},t)},stateParams:this.state.params.version?{version:this.state.params.version}:{}})}},{key:"updateParams",get:function(){return f.q6.updateParamsMixin()}},{key:"combineParams",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return D(D({},e),t)}))}},{key:"closeAlert",get:function(){return(0,h.NQ)("alerts")}},{key:"separateVersion",value:function(e){var t=e.match(/((\d+\.*)+)/);return t?{version:t[0]}:{}}}]),O}(m.Component);const _=(0,f.EN)(P);P.contextType=b.I}}]);
//# sourceMappingURL=../sourcemaps/910.7adf8fc743bcb4123b3d4dac57cf8eff.js.map