"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[408],{90408:(e,t,a)=>{a.r(t),a.d(t,{TaskListView:()=>S,default:()=>M});var n=a(60888),r=a(87088),i=a(92920),s=a(42232),l=a(76184),c=a(36884),u=a(58816),o=a(72956),d=a(77104),m=a(18232),p=a.n(m),_=a(50708),f=a(59072),h=a(49368),E=a(47580),k=a(76708),T=a(32004),v=a(58860);function y(e,t,a){return t=(0,l.c)(t),(0,s.c)(e,g()?Reflect.construct(t,a||[],(0,l.c)(e).constructor):t.apply(e,a))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}var b=function(e){return E.M.TASK_NAMES[e]&&o._s._(E.M.TASK_NAMES[e])||e},S=function(e){function t(e){var a;(0,r.c)(this,t),a=y(this,t,[e]);var n=v.us.parseParamString(e.location.search,["page","page_size"]);return n.page_size||(n.page_size=10),n.sort||(n.sort="-pulp_created"),a.state={params:n,items:[],loading:!0,itemCount:0,alerts:[],cancelModalVisible:!1,selectedTask:null,unauthorised:!1,inputText:""},a}return(0,c.c)(t,e),(0,i.c)(t,[{key:"componentDidMount",value:function(){var e=this.context.user;!e||e.is_anonymous?this.setState({loading:!1,unauthorised:!0}):this.queryTasks()}},{key:"render",value:function(){var e=this,t=this.state,a=t.params,n=t.itemCount,r=t.loading,i=t.items,s=t.alerts,l=t.cancelModalVisible,c=t.unauthorised,u=0===i.length&&!(0,v.o5)(a,["name__contains","state"]);return p().createElement(p().Fragment,null,p().createElement(h.WW,{alerts:s,closeAlert:function(t){return e.closeAlert(t)}}),l?this.renderCancelModal():null,p().createElement(h.wy,{title:o._s._({id:"JET7Si"})}),c?p().createElement(h.a8,null):u&&!r?p().createElement(h.BL,{title:o._s._({id:"qg0XeA"}),description:o._s._({id:"bOUnO9"})}):p().createElement(h.GK,null,r?p().createElement(h.cI,null):p().createElement("section",{className:"body"},p().createElement("div",{className:"hub-toolbar"},p().createElement(d.Toolbar,null,p().createElement(d.ToolbarContent,null,p().createElement(d.ToolbarGroup,null,p().createElement(d.ToolbarItem,null,p().createElement(h.oh,{inputText:this.state.inputText,onChange:function(t){return e.setState({inputText:t})},updateParams:function(t){return e.updateParams(t,(function(){return e.queryTasks()}))},params:a,filterConfig:[{id:"name__contains",title:o._s._({id:"ogBUiv"})},{id:"state",title:o._s._({id:"uAQUqI"}),inputType:"select",options:[{id:"completed",title:o._s._({id:"qqWcBV"})},{id:"failed",title:o._s._({id:"7Bj3x9"})},{id:"running",title:o._s._({id:"RiQMUh"})},{id:"waiting",title:o._s._({id:"uUehLT"})}]}]}))))),p().createElement(h.eM,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryTasks()}))},count:n,isTop:!0})),p().createElement("div",null,p().createElement(h.IP,{updateParams:function(t){e.updateParams(t,(function(){return e.queryTasks()})),e.setState({inputText:""})},params:a,ignoredParams:["page_size","page","sort","ordering"],niceNames:{name__contains:o._s._({id:"ogBUiv"}),state:o._s._({id:"uAQUqI"})}})),r?p().createElement(h.cI,null):this.renderTable(a),p().createElement(h.eM,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryTasks()}))},count:n}))))}},{key:"renderTable",value:function(e){var t=this,a=this.state.items;if(0===a.length)return p().createElement(h.YX,null);var n={headers:[{title:o._s._({id:"ogBUiv"}),type:"alpha",id:"name"},{title:o._s._({id:"45O6zJ"}),type:"numeric",id:"pulp_created"},{title:o._s._({id:"YgkVxJ"}),type:"numeric",id:"started_at"},{title:o._s._({id:"IiN/kH"}),type:"numeric",id:"finished_at"},{title:o._s._({id:"uAQUqI"}),type:"alpha",id:"state"}]};return p().createElement("table",{"aria-label":o._s._({id:"E1/c72"}),className:"hub-c-table-content pf-c-table"},p().createElement(h.K_,{options:n,params:e,updateParams:function(e){return t.updateParams(e,(function(){return t.queryTasks()}))}}),p().createElement("tbody",null,a.map((function(e,a){return t.renderTableRow(e,a)}))))}},{key:"renderTableRow",value:function(e,t){var a=e.name,n=e.state,r=e.pulp_created,i=e.started_at,s=e.finished_at,l=e.pulp_href,c=(0,v.oL)(l);return p().createElement("tr",{key:t},p().createElement("td",null,p().createElement(_.Link,{to:(0,T.oD)(T.uk.taskDetail,{task:c})},p().createElement(h.o5,{content:b(a)},a))),p().createElement("td",null,p().createElement(h.i4,{date:r})),p().createElement("td",null,p().createElement(h.i4,{date:i})),p().createElement("td",null,p().createElement(h.i4,{date:s})),p().createElement("td",null,p().createElement(h.CO,{status:n})),p().createElement("td",null,this.cancelButton(n,e)))}},{key:"cancelButton",value:function(e,t){var a=this;switch(e){case"running":case"waiting":return p().createElement(d.Button,{variant:"secondary","aria-label":o._s._({id:"cnGeoo"}),key:"delete",onClick:function(){return a.setState({cancelModalVisible:!0,selectedTask:t})}},o._s._({id:"iNUMdZ"}))}}},{key:"renderCancelModal",value:function(){var e=this,t=this.state.selectedTask,a=b(t.name);return p().createElement(h.GO,{cancelAction:function(){return e.setState({cancelModalVisible:!1})},title:o._s._({id:"7H2WNz"}),confirmAction:function(){return e.selectedTask(e.state.selectedTask,a)},confirmButtonTitle:o._s._({id:"gspY5b"})},o._s._({id:"t4TbT9",values:{name:a}}))}},{key:"selectedTask",value:function(e,t){var a=this;f.SQ.patch((0,v.oL)(e.pulp_href),{state:"canceled"}).then((function(){a.setState({loading:!0,selectedTask:null,cancelModalVisible:!1,alerts:[].concat((0,n.c)(a.state.alerts),[{variant:"success",title:t,description:p().createElement(u.mk,{id:"BC6Shx",values:{name:t}})}])}),a.queryTasks()})).catch((function(e){var r=e.response,i=r.status,s=r.statusText;a.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,n.c)(a.state.alerts),[{variant:"danger",title:o._s._({id:"vwx3Sy",values:{name:t}}),description:(0,v._A)(i,s)}])})}))}},{key:"closeAlert",get:function(){return(0,h.Yi)("alerts")}},{key:"queryTasks",value:function(){var e=this;this.setState({loading:!0},(function(){f.SQ.list(e.state.params).then((function(t){e.setState({items:t.data.results,itemCount:t.data.count,loading:!1})})).catch((function(t){var a=t.response,r=a.status,i=a.statusText;e.setState({loading:!1,items:[],itemCount:0,alerts:[].concat((0,n.c)(e.state.alerts),[{variant:"danger",title:o._s._({id:"PK3Bio"}),description:(0,v._A)(r,i)}])})}))}))}},{key:"addAlert",value:function(e,t,a){this.setState({alerts:[].concat((0,n.c)(this.state.alerts),[{description:a,title:e,variant:t}])})}},{key:"updateParams",get:function(){return v.us.updateParamsMixin()}}]),t}(p().Component);const M=(0,v.Ak)(S);S.contextType=k.c}}]);
//# sourceMappingURL=../sourcemaps/408.3e15ebdb1fb31adf670b8696a38565ec.js.map