"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[671],{89671:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var a=n(45458),l=n(23029),r=n(92901),c=n(50388),u=n(53954),i=n(15361),s=n(42328),o=n(47712),d=n(72583),m=n(96998),E=n(96553),h=n(97901),p=n(84693),f=n(32034),g=n(78755),k=n(1319),_=n(54709),v=n(3913),R=n(21079),b=n(44914),N=n.n(b),y=n(78765),x=n(88696),A=n(35894),C=n(60165),W=n(39799);function z(e,t,n){return t=(0,u.A)(t),(0,c.A)(e,M()?Reflect.construct(t,n||[],(0,u.A)(e).constructor):t.apply(e,n))}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}var T=function(e){function t(e){var n;return(0,l.A)(this,t),(n=z(this,t,[e])).state={alerts:[],cancelModalVisible:!1,childTasks:[],loading:!0,parentTask:null,polling:null,redirect:null,resources:[],task:null,taskName:""},n}return(0,i.A)(t,e),(0,r.A)(t,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"componentWillUnmount",value:function(){this.state.polling&&clearInterval(this.state.polling)}},{key:"componentDidUpdate",value:function(e){e.routeParams.task!==this.props.routeParams.task&&(this.setState({loading:!0}),this.loadContent())}},{key:"render",value:function(){var e=this,t=this.state,n=t.alerts,a=t.cancelModalVisible,l=t.childTasks,r=t.loading,c=t.parentTask,u=t.redirect,i=t.resources,s=t.task,x=t.taskName,z=[{url:(0,C.jV)(C.Jh.taskList),name:o.Ru._({id:"JET7Si"})},{name:s?x:""}],M=c?(0,W.dx)(c.pulp_href):null;return u?N().createElement(y.Navigate,{to:u}):r?N().createElement(A.kt,null):N().createElement(N().Fragment,null,N().createElement(A.NS,{alerts:n,closeAlert:function(t){return(0,A.R$)(t,{alerts:n,setAlerts:function(t){return e.setState({alerts:t})}})}}),a?this.renderCancelModal():null,N().createElement(A.T$,{title:x,breadcrumbs:N().createElement(A.BI,{links:z}),pageControls:["running","waiting"].includes(s.state)&&N().createElement(d.$n,{variant:"secondary",onClick:function(){return e.setState({cancelModalVisible:!0})}},o.Ru._({id:"iNUMdZ"})),status:N().createElement(A.kx,{className:"hub-c-task-status",status:s.state})}),N().createElement(A.gZ,null,N().createElement(m.s,null,N().createElement(m.s,{direction:{default:"column"},flex:{default:"flex_1"}},N().createElement(E.Z,null,N().createElement("section",{className:"body card-area"},N().createElement(h.h,{headingLevel:"h2",size:"lg"},o.Ru._({id:"fqgZ6m"})),N().createElement("br",null),N().createElement(p.B,{isHorizontal:!0},N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"ogBUiv"})),N().createElement(k.d,null,s.name)),s.name!==x&&N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"Nu4oKW"})),N().createElement(k.d,null,x)),N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"IiN/kH"})),N().createElement(k.d,null,N().createElement(A.gz,{date:s.finished_at}))),N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"45O6zJ"})),N().createElement(k.d,null,N().createElement(A.gz,{date:s.pulp_created})))))),N().createElement(E.Z,null,N().createElement("section",{className:"body card-area"},N().createElement(h.h,{headingLevel:"h2",size:"lg"},o.Ru._({id:"j0dOoV"})),N().createElement("br",null),N().createElement(p.B,{isHorizontal:!0},N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"In9f9E"})),N().createElement(k.d,null,s.task_group?s.task_group:o.Ru._({id:"0t88cp"}))),N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"ggsFl6"})),N().createElement(k.d,null,c?N().createElement(y.Link,{to:(0,C.jV)(C.Jh.taskDetail,{task:M})},(0,W.qo)(c.name)):o.Ru._({id:"TInr2q"}))),N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"dKlcTI"})),N().createElement(k.d,null,l.length?l.map((function(e){var t=(0,W.dx)(e.pulp_href);return N().createElement(b.Fragment,{key:t},N().createElement(y.Link,{to:(0,C.jV)(C.Jh.taskDetail,{task:t})},(0,W.qo)(e.name)),N().createElement("br",null))})):o.Ru._({id:"59KJyD"})))))),N().createElement(E.Z,null,N().createElement("section",{className:"body card-area"},N().createElement(h.h,{headingLevel:"h2",size:"lg"},o.Ru._({id:"7Ackjt"})),N().createElement("br",null),i.length?N().createElement(p.B,{isHorizontal:!0},i.map((function(e,t){return N().createElement(b.Fragment,{key:e.type+t},N().createElement("hr",null),N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"+zy2Nq"})),N().createElement(k.d,null,e.type)),e.pluginName&&N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"fOuPPd"})),N().createElement(k.d,null,e.pluginName)),e.name&&N().createElement(f.W,null,N().createElement(g.X,null,o.Ru._({id:"6YtxFj"})),N().createElement(k.d,null,e.name)))}))):o.Ru._({id:"CJcaCv"})))),N().createElement(m.s,{direction:{default:"column"},flex:{default:"flex_1"}},N().createElement(E.Z,null,!s.error&&N().createElement("section",{className:"body card-area"},N().createElement(h.h,{headingLevel:"h2",size:"lg"},o.Ru._({id:"IsjXnX"})),N().createElement("br",null),s.progress_reports.length?N().createElement(p.B,{isHorizontal:!0},s.progress_reports.reverse().map((function(e,t){return N().createElement(b.Fragment,{key:t},N().createElement("hr",null),Object.keys(e).map((function(t,n){return!!e[t]&&N().createElement(f.W,{key:t+n},N().createElement(g.X,null,{message:o.Ru._({id:"xDAtGP"}),code:o.Ru._({id:"EWPtMO"}),state:o.Ru._({id:"RS0o7b"}),done:o.Ru._({id:"DPfwMq"})}[t]||(0,R.capitalize)(t)),N().createElement(k.d,null,e[t]))}))," ")}))):N().createElement(A.IL,{icon:v.Ay,title:o.Ru._({id:"orUwNA"}),description:o.Ru._({id:"orUwNA"})})),!!s.error&&N().createElement("section",{className:"body card-area"},N().createElement(h.h,{headingLevel:"h2",size:"lg"},o.Ru._({id:"xi4nE2"})),N().createElement("br",null),N().createElement(N().Fragment,null,N().createElement(h.h,{headingLevel:"h3"},o.Ru._({id:"Nu4oKW"})),N().createElement(_.N,null,s.error.description),N().createElement(h.h,{headingLevel:"h3"},o.Ru._({id:"g3fe3D"})),N().createElement(_.N,{className:"hub-code-block"},s.error.traceback))))))))}},{key:"renderCancelModal",value:function(){var e=this,t=this.state.taskName;return N().createElement(A.uo,{cancelAction:function(){return e.setState({cancelModalVisible:!1})},confirmAction:function(){return e.cancelTask()},title:o.Ru._({id:"iNUMdZ"}),confirmButtonTitle:o.Ru._({id:"gspY5b"})},o.Ru._({id:"NBEgeZ",values:{name:t}}))}},{key:"cancelTask",value:function(){var e=this,t=this.state,n=t.task,l=t.taskName;x.dw.patch((0,W.dx)(n.pulp_href),{state:"canceled"}).then((function(){e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.A)(e.state.alerts),[{variant:"success",title:l,description:N().createElement(s.x6,{id:"xnof66",values:{taskName:l}})}])}),e.loadContent()})).catch((function(t){var n=t.response,r=n.status,c=n.statusText;e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.A)(e.state.alerts),[{variant:"danger",title:o.Ru._({id:"M2gqxI",values:{taskName:l}}),description:(0,W.gJ)(r,c)}])}),e.loadContent()}))}},{key:"loadContent",value:function(){var e=this;this.state.polling||this.state.task||this.setState({polling:setInterval((function(){return e.loadContent()}),1e4)});var t=this.props.routeParams.task;return x.dw.get(t).then((function(t){var n=[],a=null,l=[],r=[];if(["canceled","completed","failed"].includes(t.data.state)&&(clearInterval(e.state.polling),e.setState({polling:null})),t.data.parent_task){var c=(0,W.dx)(t.data.parent_task);n.push(x.dw.get(c).then((function(e){a=e.data})).catch((function(){return!0})))}return t.data.child_tasks.length&&t.data.child_tasks.forEach((function(e){var t=(0,W.dx)(e);n.push(x.dw.get(t).then((function(e){l.push(e.data)})).catch((function(){return!0})))})),t.data.reserved_resources_record.length&&t.data.reserved_resources_record.forEach((function(e){var t=e.replace("/api/automation-hub/pulp/api/v3/",""),a=(0,W.dx)(t),l=t.split("/"),c="",u="";l.length>=3?(c="".concat(l[0],": ").concat(l[2]),u=l[1]):e=l[0],a?n.push(x.X_.get(t).then((function(e){r.push({name:e.data.name,type:c,pluginName:u})})).catch((function(){return!0}))):r.push({type:c})})),Promise.all(n).then((function(){e.setState({task:t.data,childTasks:l,parentTask:a,loading:!1,taskName:(0,W.qo)(t.data.name),resources:r})}))})).catch((function(){e.setState({redirect:(0,C.jV)(C.Jh.notFound)})}))}}])}(b.Component);const X=(0,W.y)(T)}}]);
//# sourceMappingURL=../sourcemaps/671.66364b89cb232e4a9643e51ef101e4a4.js.map