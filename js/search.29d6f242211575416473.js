"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[464],{50140:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var a=n(4942),r=n(87462),c=n(15671),s=n(43144),l=n(60136),o=n(6215),i=n(61120),u=n(67294),p=n(5977),m=n(54213),d=n(84812),f=n(78919),y=n(33109),g=n(1595),v=n(13946),h=n(31765),E=n(98818),O=n(38045),P=n(43819),_=n(42807),C=n(61542),b=n(6568),S=n(61647);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){(0,l.Z)(p,e);var t,n,a=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,i.Z)(t);if(n){var r=(0,i.Z)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,o.Z)(this,e)});function p(e){var t;(0,c.Z)(this,p),t=a.call(this,e);var n=P.q.parseParamString(e.location.search,["page","page_size"]);return n.page_size||(n.page_size=_.g.CARD_DEFAULT_PAGE_SIZE),n.view_type||(n.view_type=localStorage.getItem(_.g.SEARCH_VIEW_TYPE_LOCAL_KEY)),t.state={collections:[],params:n,numberOfResults:0,loading:!0,synclist:void 0},t}return(0,s.Z)(p,[{key:"componentDidMount",value:function(){this.queryCollections(),"insights"===_.g.INSIGHTS_DEPLOYMENT_MODE&&this.getSynclist()}},{key:"render",value:function(){var e=this,t=this.state,n=t.collections,a=t.params,r=t.numberOfResults,c=0===n.length&&!(0,b.vS)(a,["keywords","tags"]);return u.createElement("div",{className:"search-page"},u.createElement(E.UP,{className:"header",title:"Collections",contextSelector:u.createElement(E.e4,{selectedRepo:this.context.selectedRepo,path:S.nB.searchByRepo})},!c&&u.createElement("div",{className:"toolbar-wrapper"},u.createElement("div",{className:"toolbar"},u.createElement(d.o,null,u.createElement(f.c,null,u.createElement(y.k,null,u.createElement(g.E,null,u.createElement(E.Kv,{updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},params:a,filterConfig:[{id:"keywords",title:"Keywords"},{id:"tags",title:"Tag",inputType:"multiple",options:["cloud","linux","networking","storage","security","windows","infrastructure","monitoring","tools","database","application"].map((function(e){return{id:e,title:e}}))}]}),u.createElement(g.E,null,u.createElement(E.M$,{style:{marginTop:"16px"},updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},params:a,ignoredParams:["page_size","page","sort","view_type"]})))))),u.createElement("div",{className:"pagination-container"},u.createElement("div",{className:"card-list-switcher"},u.createElement(E.nH,{size:"sm",params:a,updateParams:function(t){return e.updateParams(t,(function(){return localStorage.setItem(_.g.SEARCH_VIEW_TYPE_LOCAL_KEY,e.state.params.view_type)}))}})),u.createElement(E.tl,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},count:r,perPageOptions:_.g.CARD_DEFAULT_PAGINATION_OPTIONS,isTop:!0}))))),c?u.createElement(E.vv,{title:"No collections yet",description:"Collections will appear once uploaded"}):u.createElement(u.Fragment,null,u.createElement(m.Z,{className:"collection-container"},this.renderCollections(n,a)),u.createElement(m.Z,{className:"footer"},u.createElement(E.tl,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},perPageOptions:_.g.CARD_DEFAULT_PAGINATION_OPTIONS,count:r}))))}},{key:"renderCollections",value:function(e,t){return this.state.loading?u.createElement(E.AW,null):0===e.length?u.createElement(E.ei,null):"list"===t.view_type?this.renderList(e):this.renderCards(e)}},{key:"renderCards",value:function(e){var t=this;return u.createElement("div",{className:"cards"},e.map((function(e){return u.createElement(E.zt,(0,r.Z)({className:"card",key:e.id},e,{footer:t.renderSyncToggle(e.name,e.namespace.name),repo:t.context.selectedRepo}))})))}},{key:"renderSyncToggle",value:function(e,t){var n=this;return this.state.synclist?u.createElement(v.r,{id:t+"."+e,className:"sync-toggle",label:"Sync",isChecked:this.isCollectionSynced(e,t),onChange:function(){return n.toggleCollectionSync(e,t)}}):null}},{key:"toggleCollectionSync",value:function(e,t){var n=this,a=w({},this.state.synclist),r=a.collections.findIndex((function(n){return n.name===e&&n.namespace===t}));r<0?a.collections.push({name:e,namespace:t}):a.collections.splice(r,1),O.vy.update(a.id,a).then((function(e){n.setState({synclist:e.data}),O.vy.curate(a.id).then((function(){return null}))}))}},{key:"isCollectionSynced",value:function(e,t){var n=this.state.synclist,a=n.collections.find((function(n){return n.name===e&&n.namespace===t}));return"include"===n.policy?!(void 0===a):void 0===a}},{key:"renderList",value:function(e){var t=this;return u.createElement("div",{className:"list-container"},u.createElement("div",{className:"list"},u.createElement(h.FR,{className:"data-list","aria-label":"List of Collections"},e.map((function(e){return u.createElement(E.Op,(0,r.Z)({showNamespace:!0,key:e.id},e,{controls:t.renderSyncToggle(e.name,e.namespace.name),repo:t.context.selectedRepo}))})))))}},{key:"getSynclist",value:function(){var e=this;O.vy.list().then((function(t){1===t.data.meta.count?e.setState({synclist:t.data.data[0]}):console.error("my-synclist returned ".concat(t.data.meta.count," synclists"))}))}},{key:"queryCollections",value:function(){var e=this;this.setState({loading:!0},(function(){O.gu.list(w(w({},P.q.getReduced(e.state.params,["view_type"])),{},{deprecated:!1}),e.context.selectedRepo).then((function(t){e.setState({collections:t.data.data,numberOfResults:t.data.meta.count,loading:!1})}))}))}},{key:"updateParams",get:function(){return P.q.updateParamsMixin()}}]),p}(u.Component);const R=(0,p.EN)(k);k.contextType=C.I}}]);
//# sourceMappingURL=../sourcemaps/search.bae87b8787466e467899.js.map