"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[2044],{52044:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var n=r(52536),a=r(98920),o=r(58816),s=r(72956),l=r(18232),i=r.n(l),u=r(47492),c=r(59072),d=r(49368),m=r(32004),p=r(24760),f=r(58860),v=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,o=r.featureFlags,u=r.hasPermission,v=r.state.params,_=r.user,b=(null==t?void 0:t.pulp_href)&&(0,f.oL)(t.pulp_href),y=(0,l.useState)(null==t?void 0:t.name),h=(0,a.c)(y,2),E=h[0],g=h[1],O=(0,l.useState)(null),P=(0,a.c)(O,2),S=P[0],w=P[1],R=(0,l.useState)(null),j=(0,a.c)(R,2),k=j[0],D=j[1],C=(0,l.useState)(!1),G=(0,a.c)(C,2),z=G[0],U=G[1],x=(0,l.useState)(null),N=(0,a.c)(x,2),A=N[0],F=N[1],T=(0,l.useState)(null),V=(0,a.c)(T,2),L=V[0],M=V[1],q=(0,l.useState)(null),Q=(0,a.c)(q,2),B=Q[0],W=Q[1],I=(0,l.useState)(null),Y=(0,a.c)(I,2),H=Y[0],K=Y[1],J=(0,l.useState)(null),Z=(0,a.c)(J,2),X=Z[0],$=Z[1],ee=(0,l.useState)(null),te=(0,a.c)(ee,2),re=te[0],ne=te[1],ae=(0,l.useState)(null),oe=(0,a.c)(ae,2),se=oe[0],le=oe[1],ie=(0,l.useState)(null),ue=(0,a.c)(ie,2),ce=ue[0],de=ue[1],me=function(){D(null),w(null),c.CG.myPermissions(b).then((function(e){var t=e.data.permissions;U((0,p.OM)({hasPermission:u,hasObjectPermission:function(e){return t.includes(e)},user:_,featureFlags:o})),c.CG.listRoles(b,{page_size:100}).then((function(e){var t=e.data.roles,r=(0,f.KM)(t),n=r.users,a=r.groups;g(E),D(n),w(a)})).catch((function(){D([]),w([])}))})).catch((function(){D([]),w([]),U(!1)}))},pe=function(e){var t=e.roles,r=e.alertSuccess,a=e.alertFailure,o=e.stateUpdate;Promise.all(t).then((function(){n({title:r,variant:"success"}),me()})).catch((function(e){var t=e.response,r=t.status,o=t.statusText;n({title:a,variant:"danger",description:(0,f._A)(r,o)})})).finally((function(){fe(o)}))},fe=function(e){Object.entries(e).forEach((function(e){var t=(0,a.c)(e,2),r=t[0],n=t[1];switch(r){case"showUserRemoveModal":W(n);break;case"showUserSelectWizard":K(n);break;case"showGroupRemoveModal":$(n);break;case"showGroupSelectWizard":ne(n);break;case"showRoleRemoveModal":le(n);break;case"showRoleSelectWizard":de(n);break;default:console.error("updateProps",r,n)}}))};return(0,l.useEffect)(me,[t.pulp_href]),(0,l.useEffect)((function(){k&&(null!=v&&v.user?c.Qv.list({username:v.user}).then((function(e){var t=e.data.data;M(k.find((function(e){return e.username===t[0].username})))})):M(null))}),[null==v?void 0:v.user,k]),(0,l.useEffect)((function(){S&&(null!=v&&v.group?c.gH.list({name:v.group}).then((function(e){var t=e.data.data;F(S.find((function(e){return e.name===t[0].name})))})):F(null))}),[null==v?void 0:v.group,S]),i().createElement(d.sF,{addGroup:function(e,t){var r=t.map((function(t){return c.CG.addRole(b,{role:t.name,groups:[e.name]})}));pe({roles:r,alertSuccess:s._s._({id:"lylrvu",values:{0:e.name,name:E}}),alertFailure:s._s._({id:"9/YKZd",values:{0:e.name,name:E}}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var r=t.map((function(t){return c.CG.addRole(b,{role:t.name,groups:[e.name]})}));pe({roles:r,alertSuccess:s._s._({id:"svLSRe",values:{0:e.name,name:E}}),alertFailure:s._s._({id:"eeQk9h",values:{0:e.name,name:E}}),stateUpdate:{showRoleSelectWizard:null}})},addUser:function(e,t){var r=t.map((function(t){return c.CG.addRole(b,{role:t.name,users:[e.username]})}));pe({roles:r,alertSuccess:s._s._({id:"J7EvK0",values:{0:e.username,name:E}}),alertFailure:s._s._({id:"0P+eGj",values:{0:e.username,name:E}}),stateUpdate:{showUserSelectWizard:null}})},addUserRole:function(e,t){var r=t.map((function(t){return c.CG.addRole(b,{role:t.name,users:[e.username]})}));pe({roles:r,alertSuccess:s._s._({id:"ifVlo4",values:{0:e.username,name:E}}),alertFailure:s._s._({id:"xJC6dy",values:{0:e.username,name:E}}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:z,group:A,groups:S,name:E,pulpObjectType:"repositories/ansible/ansible",removeGroup:function(e){var t=e.object_roles.map((function(t){return c.CG.removeRole(b,{role:t,groups:[e.name]})}));pe({roles:t,alertSuccess:s._s._({id:"94LxzI",values:{0:e.name,name:E}}),alertFailure:s._s._({id:"j17tAi",values:{0:e.name,name:E}}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var r=c.CG.removeRole(b,{role:e,groups:[t.name]});pe({roles:[r],alertSuccess:s._s._({id:"svLSRe",values:{0:t.name,name:E}}),alertFailure:s._s._({id:"eeQk9h",values:{0:t.name,name:E}}),stateUpdate:{showRoleRemoveModal:null}})},removeUser:function(e){var t=e.object_roles.map((function(t){return c.CG.removeRole(b,{role:t,users:[e.username]})}));pe({roles:t,alertSuccess:s._s._({id:"ekGBsh",values:{0:e.username,name:E}}),alertFailure:s._s._({id:"O21voo",values:{0:e.username,name:E}}),stateUpdate:{showUserRemoveModal:null}})},removeUserRole:function(e,t){var r=c.CG.removeRole(b,{role:e,users:[t.username]});pe({roles:[r],alertSuccess:s._s._({id:"ifVlo4",values:{0:t.username,name:E}}),alertFailure:s._s._({id:"xJC6dy",values:{0:t.username,name:E}}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:s._s._({id:"WoaabF"}),showGroupRemoveModal:X,showGroupSelectWizard:re,showRoleRemoveModal:se,showRoleSelectWizard:ce,showUserRemoveModal:B,showUserSelectWizard:H,updateProps:fe,user:L,users:k,urlPrefix:(0,m.oD)(m.uk.ansibleRepositoryDetail,{name:E})})},_=r(50708);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,n.c)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,o=r.hasPermission,p=function(){var e=y({},(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params);e.ordering=e.sort,delete e.sort;var r=(0,f.oL)(t.pulp_href);return c.Rz.list(y({repository:r},e)).then((function(e){var t=e.data;return{data:{count:t.meta.count,results:t.data}}}))},v=(0,l.useState)({repository:t}),b=(0,a.c)(v,2),h=b[0],E=b[1];return(0,l.useEffect)((function(){return E((function(e){return y(y({},e),{},{repository:t})}))}),[t]),i().createElement(d.iI,{actionContext:{addAlert:n,state:h,setState:E,query:p,hasPermission:o,hasObjectPermission:function(e){var r,n;return null==t||null===(r=t.my_permissions)||void 0===r||null===(n=r.includes)||void 0===n?void 0:n.call(r,e)}},defaultPageSize:10,defaultSort:"name",errorTitle:s._s._({id:"GNyQoC"}),filterConfig:[{id:"keywords",title:s._s._({id:"/n/HCO"})},{id:"namespace",title:s._s._({id:"wMe2Qp"})}],headerActions:[u.Yb],listItemActions:[u.YP],noDataButton:u.Yb.button,noDataDescription:s._s._({id:"wATscz"}),noDataTitle:s._s._({id:"Ut02fq"}),query:p,renderTableRow:function(e,t,r,n){var a=e.collection_version,o=a.name,s=a.namespace,l=a.version,u=a.description,c=e.repository,p=n.map((function(t){return t.dropdownItem(e,r)}));return i().createElement("tr",{key:t},i().createElement("td",null,i().createElement(_.Link,{to:(0,m.oD)(m.uk.collectionByRepo,{repo:c.name,namespace:s,collection:o},{version:l})},s,".",o," v",l)),i().createElement("td",null,u),i().createElement(d.gJ,{kebabItems:p}))},sortHeaders:[{title:s._s._({id:"q+hNag"}),type:"none",id:"col1"},{title:s._s._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:s._s._({id:"QGV1gp"})})},E=function(e){var t,r=e.item;return i().createElement(d.Sk,{fields:[{label:s._s._({id:"0xnmlQ"}),value:null==r?void 0:r.name},{label:s._s._({id:"Nu4oKW"}),value:(null==r?void 0:r.description)||s._s._({id:"EdQY6l"})},{label:s._s._({id:"B/CcxR"}),value:null!==(t=null==r?void 0:r.retain_repo_versions)&&void 0!==t?t:s._s._({id:"N40H+G"})},{label:s._s._({id:"vU/Hht"}),value:i().createElement(d.Ss,{repositoryHref:null==r?void 0:r.pulp_href})},{label:s._s._({id:"UXGlf6"}),value:null!=r&&r.distroBasePath?i().createElement(d.An,{url:(0,f.uo)(r.distroBasePath)}):"---"},{label:s._s._({id:"h8DugX"}),value:i().createElement(d.eE,{labels:null==r?void 0:r.pulp_labels})},{label:s._s._({id:"zwBp5t"}),value:null!=r&&r.private?s._s._({id:"l75CjT"}):s._s._({id:"1UzENP"})},{label:s._s._({id:"qlAIQ1"}),value:null!=r&&r.remote?i().createElement(_.Link,{to:(0,m.oD)(m.uk.ansibleRemoteDetail,{name:null==r?void 0:r.remote.name})},null==r?void 0:r.remote.name):s._s._({id:"EdQY6l"})}]})},g=r(45072),O=r(92920),P=r(87088),S=r(42232),w=r(76184),R=r(83136),j=r(36884),k=r(77104);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,n.c)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function G(e,t,r){return t=(0,w.c)(t),(0,S.c)(e,z()?Reflect.construct(t,r||[],(0,w.c)(e).constructor):t.apply(e,r))}function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(z=function(){return!!e})()}var U=function(e){var t=e.href,r=e.addAlert,o=e.hasPermission,u=e.repositoryName,p=(0,l.useState)({}),f=(0,a.c)(p,2),v=f[0],b=f[1];if(!t)return null;var y=function(e){return new(function(t){function r(){var t;(0,P.c)(this,r);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return t=G(this,r,[].concat(o)),(0,n.c)((0,R.c)(t),"apiPath",e.replace("/api/automation-hub/pulp/api/v3/","")),t}return(0,j.c)(r,t),(0,O.c)(r)}(c.oj))}(t),h=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params;return y.list(e)};return i().createElement(d.iI,{actionContext:{addAlert:r,state:v,setState:b,query:h,hasPermission:o},defaultPageSize:10,defaultSort:"name",errorTitle:s._s._({id:"GNyQoC"}),noDataDescription:s._s._({id:"RXBYdl"}),noDataTitle:s._s._({id:"Ut02fq"}),query:h,renderTableRow:function(e){var t=e.manifest.collection_info,r=t.namespace,n=t.name,a=t.version,o=e.description;return i().createElement("tr",null,i().createElement("td",null,i().createElement(_.Link,{to:(0,m.oD)(m.uk.collectionByRepo,{repo:u,namespace:r,collection:n},{version:a})},r,".",n," v",a)),i().createElement("td",null,o))},sortHeaders:[{title:s._s._({id:"q+hNag"}),type:"none",id:"col1"},{title:s._s._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:s._s._({id:"QGV1gp"})})},x=function(e){var t=e.data;return Object.keys(t).length?i().createElement("table",{className:"pf-c-table"},i().createElement("tr",null,i().createElement("th",null,s._s._({id:"wBMjJ2"})),i().createElement("th",null,s._s._({id:"rZfa42"}))),Object.entries(t).map((function(e){var t=(0,a.c)(e,2),r=t[0],n=t[1];return i().createElement("tr",{key:r},i().createElement("td",null,n.count),i().createElement("th",null,r))}))):i().createElement(i().Fragment,null,s._s._({id:"EdQY6l"}))},N=function(e){var t=e.repositoryName,r=e.data;if(!r)return i().createElement(i().Fragment,null,s._s._({id:"EdQY6l"}));var n=r.split("/").at(-2);return i().createElement(_.Link,{to:(0,m.oD)(m.uk.ansibleRepositoryDetail,{name:t},{repositoryVersion:n,tab:"repository-versions"})},n)},A=function(e){var t,r,n,o=e.item,p=e.actionContext,v=p.addAlert,b=p.state,y=p.hasPermission,h=p.hasObjectPermission,E=(0,f.oL)(o.pulp_href),O=o.latest_version_href,P=o.name,S=function(e){var t=e.params;return c.CG.listVersions(E,t)},w=(0,l.useState)({}),R=(0,a.c)(w,2),j=R[0],D=R[1],G=(0,l.useState)(null),z=(0,a.c)(G,2),A=z[0],F=z[1];return(0,l.useEffect)((function(){var e,t;b.params.repositoryVersion?(e={number:b.params.repositoryVersion},t=e.number,c.CG.listVersions(E,{number:t})).then((function(e){var t,r=e.data;null!=r&&null!==(t=r.results)&&void 0!==t&&t[0]||v({variant:"danger",title:s._s._({id:"/NE1Mg"})}),F(r.results[0])})):F(null)}),[b.params.repositoryVersion]),b.params.repositoryVersion?A?i().createElement(i().Fragment,null,i().createElement(d.Sk,{fields:[{label:s._s._({id:"jazdz0"}),value:A.number},{label:s._s._({id:"69Z/4c"}),value:i().createElement(d.i4,{date:A.pulp_created})},{label:s._s._({id:"4w69Y9"}),value:i().createElement(x,{data:null===(t=A.content_summary)||void 0===t?void 0:t.added})},{label:s._s._({id:"aE2TFq"}),value:i().createElement(x,{data:null===(r=A.content_summary)||void 0===r?void 0:r.removed})},{label:s._s._({id:"ESNb89"}),value:i().createElement(x,{data:null===(n=A.content_summary)||void 0===n?void 0:n.present})},{label:s._s._({id:"DgzWiz"}),value:i().createElement(N,{repositoryName:P,data:A.base_version})}]}),i().createElement("div",{className:"pf-c-page__main-section",style:{padding:"8px 0",margin:"24px -16px 0"}}),i().createElement(U,(0,g.c)({},A.content_summary.present["ansible.collection_version"],{repositoryName:P}))):i().createElement(k.Spinner,{size:"md"}):i().createElement(d.iI,{actionContext:{addAlert:v,state:j,setState:D,query:S,hasPermission:y,hasObjectPermission:h},defaultPageSize:10,defaultSort:"-pulp_created",errorTitle:s._s._({id:"0e4kDo"}),filterConfig:null,listItemActions:[u.U3],noDataButton:null,noDataDescription:s._s._({id:"fjbxkP"}),noDataTitle:s._s._({id:"asZQa0"}),query:S,renderTableRow:function(e,t,r,n){var a=e.number,o=e.pulp_created,l=e.pulp_href,u=O===l,c=n.map((function(t){return t.dropdownItem(C(C({},e),{},{isLatest:u,repositoryName:P}),r)}));return i().createElement("tr",{key:t},i().createElement("td",null,i().createElement(_.Link,{to:(0,m.oD)(m.uk.ansibleRepositoryDetail,{name:P},{repositoryVersion:a,tab:"repository-versions"})},a),u?" "+s._s._({id:"DlLZIu"}):null),i().createElement("td",null,i().createElement(d.i4,{date:o})),i().createElement(d.gJ,{kebabItems:c}))},sortHeaders:[{title:s._s._({id:"jazdz0"}),type:"numeric",id:"number"},{title:s._s._({id:"69Z/4c"}),type:"numeric",id:"pulp_created"}],title:s._s._({id:"K9TbzM"})})};function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,n.c)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const V=(0,d.K6)({breadcrumbs:function(e){var t=e.name,r=e.tab,n=e.params,a=n.repositoryVersion,o=n.user,l=n.group;return[{url:(0,m.oD)(m.uk.ansibleRepositories),name:s._s._({id:"ooullr"})},{url:(0,m.oD)(m.uk.ansibleRepositoryDetail,{name:t}),name:t},"access"===r.id&&(l||o)||"repository-versions"===r.id&&a?{url:(0,m.oD)(m.uk.ansibleRepositoryDetail,{name:t},{tab:r.id}),name:r.name}:null,"access"===r.id&&l?{name:s._s._({id:"8uT/P7",values:{group:l}})}:null,"access"===r.id&&o?{name:s._s._({id:"AkUbn7",values:{user:o}})}:null,"repository-versions"===r.id&&a?{name:s._s._({id:"s7PA8t",values:{repositoryVersion:a}})}:null,"access"===r.id&&!o&&!l||"repository-versions"===r.id&&!a?{name:r.name}:null].filter(Boolean)},condition:p.qI,displayName:"AnsibleRepositoryDetail",errorTitle:{id:"tKqvEr"},headerActions:[u.Gv,u.Oj,u.gd,u.y],headerDetails:function(e){return i().createElement(i().Fragment,null,(null==e?void 0:e.last_sync_task)&&i().createElement("p",{className:"hub-m-truncated"},i().createElement(o.mk,{id:"Lpz3xV",values:{0:(0,f.Fu)(e)}})," ",(0,f.E$)(e)))},listUrl:(0,m.oD)(m.uk.ansibleRepositories),query:function(e){var t=e.name;return c.CG.list({name:t,page_size:1}).then((function(e){return e.data.results[0]})).then((function(e){if(!e)return Promise.reject({response:{status:404}});var t=function(e){return function(t){return console.error(t),e}};return Promise.all([(0,f.cV)(e.name,e.pulp_href).catch(t(null)),c.CG.myPermissions((0,f.oL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch(t([])),e.remote?c.E3.get((0,f.oL)(e.remote)).then((function(e){return e.data})).catch((function(){return null})):null]).then((function(t){var r=(0,a.c)(t,3),n=r[0],o=r[1],s=r[2];return T(T({},e),{},{distroBasePath:n,my_permissions:o,remote:s})}))}))},renderTab:function(e,t,r){return{details:i().createElement(E,{item:t,actionContext:r}),access:i().createElement(v,{item:t,actionContext:r}),"collection-versions":i().createElement(h,{item:t,actionContext:r}),"repository-versions":i().createElement(A,{item:t,actionContext:r})}[e]},tabs:[{id:"details",name:{id:"URmyfc"}},{id:"access",name:{id:"LuXP9q"}},{id:"collection-versions",name:{id:"QGV1gp"}},{id:"repository-versions",name:{id:"IYNSdp"}}],tabUpdateParams:function(e){return delete e.repositoryVersion,delete e.group,delete e.user,e}})}}]);
//# sourceMappingURL=../sourcemaps/2044.6927549569e348c91f273f2b32a6285d.js.map