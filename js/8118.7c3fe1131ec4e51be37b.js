"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[8118],{48118:(e,t,r)=>{r.r(t),r.d(t,{default:()=>C});var n=r(4942),a=r(70885),o=r(4361),i=r(89555),l=r(92950),s=r.n(l),u=r(61811),c=r(76265),d=r(1161),m=r(61647),p=r(6640),f=r(52713);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,o=r.featureFlags,u=r.hasPermission,b=r.state.params,y=r.user,g=(null==t?void 0:t.pulp_href)&&(0,f.LL)(t.pulp_href),h=(0,l.useState)(null==t?void 0:t.name),_=(0,a.Z)(h,2),E=_[0],O=_[1],P=(0,l.useState)(null),j=(0,a.Z)(P,2),w=j[0],S=j[1],R=(0,l.useState)(!1),Z=(0,a.Z)(R,2),D=Z[0],k=Z[1],U=(0,l.useState)(null),I=(0,a.Z)(U,2),x=I[0],L=I[1],A=(0,l.useState)(null),N=(0,a.Z)(A,2),T=N[0],z=N[1],C=(0,l.useState)(null),B=(0,a.Z)(C,2),q=B[0],G=B[1],Q=(0,l.useState)(null),V=(0,a.Z)(Q,2),X=V[0],F=V[1],W=(0,l.useState)(null),M=(0,a.Z)(W,2),Y=M[0],H=M[1],K=function(){S(null),c.UX.myPermissions(g).then((function(e){var t=e.data.permissions;k((0,p.X0)({hasPermission:u,hasObjectPermission:function(e){return t.includes(e)},user:y,featureFlags:o})),c.UX.listRoles(g).then((function(e){var t,r=e.data.roles,n=[],a=v(r);try{for(a.s();!(t=a.n()).done;){var o,i=t.value,l=i.groups,s=i.role,u=v(l);try{var c=function(){var e=o.value,t=n.findIndex((function(t){return t.name===e}));-1==t?n.push({name:e,object_roles:[s]}):n[t].object_roles.push(s)};for(u.s();!(o=u.n()).done;)c()}catch(e){u.e(e)}finally{u.f()}}}catch(e){a.e(e)}finally{a.f()}O(E),S(n)})).catch((function(){S([])}))})).catch((function(){S([]),k(!1)}))},J=function(e){var t=e.roles,r=e.alertSuccess,a=e.alertFailure,o=e.stateUpdate;Promise.all(t).then((function(){n({title:r,variant:"success"}),K()})).catch((function(e){var t=e.response,r=t.status,o=t.statusText;n({title:a,variant:"danger",description:(0,f.N3)(r,o)})})).finally((function(){$(o)}))},$=function(e){Object.entries(e).forEach((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];switch(r){case"showGroupRemoveModal":z(n);break;case"showGroupSelectWizard":G(n);break;case"showRoleRemoveModal":F(n);break;case"showRoleSelectWizard":H(n);break;default:console.error("updateProps",r,n)}}))};return(0,l.useEffect)(K,[t.pulp_href]),(0,l.useEffect)((function(){w&&(null!=b&&b.group?c.lO.list({name:b.group}).then((function(e){var t=e.data.data;L(w.find((function(e){return e.name===t[0].name})))})):L(null))}),[null==b?void 0:b.group,w]),s().createElement(d.yW,{addGroup:function(e,t){var r=t.map((function(t){return c.UX.addRole(g,{role:t.name,groups:[e.name]})}));J({roles:r,alertSuccess:i.ag._({id:"lylrvu",values:{0:e.name,name:E}}),alertFailure:i.ag._({id:"9/YKZd",values:{0:e.name,name:E}}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var r=t.map((function(t){return c.UX.addRole(g,{role:t.name,groups:[e.name]})}));J({roles:r,alertSuccess:i.ag._({id:"svLSRe",values:{0:e.name,name:E}}),alertFailure:i.ag._({id:"eeQk9h",values:{0:e.name,name:E}}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:D,group:x,groups:w,name:E,pulpObjectType:"repositories/ansible/ansible",removeGroup:function(e){var t=e.object_roles.map((function(t){return c.UX.removeRole(g,{role:t,groups:[e.name]})}));J({roles:t,alertSuccess:i.ag._({id:"94LxzI",values:{0:e.name,name:E}}),alertFailure:i.ag._({id:"j17tAi",values:{0:e.name,name:E}}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var r=c.UX.removeRole(g,{role:e,groups:[t.name]});J({roles:[r],alertSuccess:i.ag._({id:"svLSRe",values:{0:t.name,name:E}}),alertFailure:i.ag._({id:"eeQk9h",values:{0:t.name,name:E}}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:i.ag._({id:"WoaabF"}),showGroupRemoveModal:T,showGroupSelectWizard:q,showRoleRemoveModal:X,showRoleSelectWizard:Y,updateProps:$,urlPrefix:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:E})})},g=r(62012);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,o=r.hasPermission,p=function(e){var r=_({},e.params);r.ordering=r.sort,delete r.sort;var n=(0,f.LL)(t.pulp_href);return c.eq.list(_({repository:n},r)).then((function(e){var t=e.data;return{data:{count:t.meta.count,results:t.data}}}))},v=(0,l.useState)({repository:t}),b=(0,a.Z)(v,2),y=b[0],h=b[1];return(0,l.useEffect)((function(){return h((function(e){return _(_({},e),{},{repository:t})}))}),[t]),s().createElement(d.qU,{actionContext:{addAlert:n,state:y,setState:h,query:p,hasPermission:o,hasObjectPermission:function(e){var r,n;return null==t||null===(r=t.my_permissions)||void 0===r||null===(n=r.includes)||void 0===n?void 0:n.call(r,e)}},defaultPageSize:10,defaultSort:"name",errorTitle:i.ag._({id:"GNyQoC"}),filterConfig:[{id:"keywords",title:i.ag._({id:"/n/HCO"})},{id:"namespace",title:i.ag._({id:"wMe2Qp"})}],headerActions:[u.Ub],listItemActions:[u.No],noDataButton:u.Ub.button,noDataDescription:i.ag._({id:"wATscz"}),noDataTitle:i.ag._({id:"Ut02fq"}),query:p,renderTableRow:function(e,t,r,n){var a=e.collection_version,o=a.name,i=a.namespace,l=a.version,u=a.description,c=e.repository,p=n.map((function(t){return t.dropdownItem(e,r)}));return s().createElement("tr",{key:t},s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.collectionByRepo,{repo:c.name,namespace:i,collection:o},{version:l})},i,".",o," v",l)),s().createElement("td",null,u),s().createElement(d.cT,{kebabItems:p}))},sortHeaders:[{title:i.ag._({id:"q+hNag"}),type:"none",id:"col1"},{title:i.ag._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:i.ag._({id:"QGV1gp"})})},O=function(e){var t,r,n=e.item,o=(0,l.useState)(null),u=(0,a.Z)(o,2),p=u[0],v=u[1];return(0,l.useEffect)((function(){var e=n.remote&&(0,f.LL)(n.remote);e?c.GC.get(e).then((function(e){var t=e.data;return v(t)})):v(null)}),[n.remote]),s().createElement(d.PO,{fields:[{label:i.ag._({id:"0xnmlQ"}),value:null==n?void 0:n.name},{label:i.ag._({id:"Nu4oKW"}),value:(null==n?void 0:n.description)||i.ag._({id:"EdQY6l"})},{label:i.ag._({id:"B/CcxR"}),value:null!==(t=null==n?void 0:n.retain_repo_versions)&&void 0!==t?t:i.ag._({id:"N40H+G"})},{label:i.ag._({id:"vU/Hht"}),value:s().createElement(d.QW,{distributions:n.distributions})},{label:i.ag._({id:"UXGlf6"}),value:null!==(r=n.distributions)&&void 0!==r&&r.length?s().createElement(d.TO,{url:(0,f.hv)(n.distributions[0].base_path)}):"---"},{label:i.ag._({id:"h8DugX"}),value:s().createElement(d.rT,{labels:null==n?void 0:n.pulp_labels})},{label:i.ag._({id:"zwBp5t"}),value:null!=n&&n.private?i.ag._({id:"l75CjT"}):i.ag._({id:"1UzENP"})},{label:i.ag._({id:"qlAIQ1"}),value:p?s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRemoteDetail,{name:p.name})},p.name):i.ag._({id:"EdQY6l"})}]})},P=r(87462),j=r(43144),w=r(15671),S=r(97326),R=r(79340),Z=r(82963),D=r(61120),k=r(35356);function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=function(e){var t=e.href,r=e.addAlert,o=e.hasPermission,u=e.repositoryName,p=(0,l.useState)({}),f=(0,a.Z)(p,2),v=f[0],b=f[1];if(!t)return null;var y=function(e){return new(function(t){(0,R.Z)(i,t);var r,a,o=(r=i,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,D.Z)(r);if(a){var n=(0,D.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,Z.Z)(this,e)});function i(){var t;(0,w.Z)(this,i);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t=o.call.apply(o,[this].concat(a)),(0,n.Z)((0,S.Z)(t),"useOrdering",!0),(0,n.Z)((0,S.Z)(t),"apiPath",e.replace("/api/automation-hub/pulp/api/v3/","")),t}return(0,j.Z)(i)}(c.jx))}(t),h=function(e){var t=e.params;return y.list(t)};return s().createElement(d.qU,{actionContext:{addAlert:r,state:v,setState:b,query:h,hasPermission:o},defaultPageSize:10,defaultSort:"name",errorTitle:i.ag._({id:"GNyQoC"}),noDataDescription:i.ag._({id:"RXBYdl"}),noDataTitle:i.ag._({id:"Ut02fq"}),query:h,renderTableRow:function(e){var t=e.manifest.collection_info,r=t.namespace,n=t.name,a=t.version,o=e.description;return s().createElement("tr",null,s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.collectionByRepo,{repo:u,namespace:r,collection:n},{version:a})},r,".",n," v",a)),s().createElement("td",null,o))},sortHeaders:[{title:i.ag._({id:"q+hNag"}),type:"none",id:"col1"},{title:i.ag._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:i.ag._({id:"QGV1gp"})})},L=function(e){var t=e.data;return Object.keys(t).length?s().createElement("table",{className:"pf-c-table"},s().createElement("tr",null,s().createElement("th",null,i.ag._({id:"wBMjJ2"})),s().createElement("th",null,i.ag._({id:"rZfa42"}))),Object.entries(t).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return s().createElement("tr",{key:r},s().createElement("td",null,n.count),s().createElement("th",null,r))}))):s().createElement(s().Fragment,null,i.ag._({id:"EdQY6l"}))},A=function(e){var t=e.repositoryName,r=e.data;if(!r)return s().createElement(s().Fragment,null,i.ag._({id:"EdQY6l"}));var n=r.split("/").at(-2);return s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t},{repositoryVersion:n,tab:"repository-versions"})},n)},N=function(e){var t,r,n,o=e.item,p=e.actionContext,v=p.addAlert,b=p.state,y=p.hasPermission,h=p.hasObjectPermission,_=(0,f.LL)(o.pulp_href),E=o.latest_version_href,O=o.name,j=function(e){var t=e.params;return c.UX.listVersions(_,t)},w=(0,l.useState)({}),S=(0,a.Z)(w,2),R=S[0],Z=S[1],D=(0,l.useState)(null),U=(0,a.Z)(D,2),N=U[0],T=U[1];return(0,l.useEffect)((function(){var e,t;b.params.repositoryVersion?(e={number:b.params.repositoryVersion},t=e.number,c.UX.listVersions(_,{number:t})).then((function(e){var t,r=e.data;null!=r&&null!==(t=r.results)&&void 0!==t&&t[0]||v({variant:"danger",title:i.ag._({id:"/NE1Mg"})}),T(r.results[0])})):T(null)}),[b.params.repositoryVersion]),b.params.repositoryVersion?N?s().createElement(s().Fragment,null,s().createElement(d.PO,{fields:[{label:i.ag._({id:"jazdz0"}),value:N.number},{label:i.ag._({id:"69Z/4c"}),value:s().createElement(d.Id,{date:N.pulp_created})},{label:i.ag._({id:"4w69Y9"}),value:s().createElement(L,{data:null===(t=N.content_summary)||void 0===t?void 0:t.added})},{label:i.ag._({id:"aE2TFq"}),value:s().createElement(L,{data:null===(r=N.content_summary)||void 0===r?void 0:r.removed})},{label:i.ag._({id:"ESNb89"}),value:s().createElement(L,{data:null===(n=N.content_summary)||void 0===n?void 0:n.present})},{label:i.ag._({id:"DgzWiz"}),value:s().createElement(A,{repositoryName:O,data:N.base_version})}]}),s().createElement("div",{className:"pf-c-page__main-section",style:{padding:"8px 0",margin:"24px -16px 0"}}),s().createElement(x,(0,P.Z)({},N.content_summary.present["ansible.collection_version"],{repositoryName:O}))):s().createElement(k.Spinner,{size:"md"}):s().createElement(d.qU,{actionContext:{addAlert:v,state:R,setState:Z,query:j,hasPermission:y,hasObjectPermission:h},defaultPageSize:10,defaultSort:"-pulp_created",errorTitle:i.ag._({id:"0e4kDo"}),filterConfig:null,listItemActions:[u.W],noDataButton:null,noDataDescription:i.ag._({id:"fjbxkP"}),noDataTitle:i.ag._({id:"asZQa0"}),query:j,renderTableRow:function(e,t,r,n){var a=e.number,o=e.pulp_created,l=e.pulp_href,u=E===l,c=n.map((function(t){return t.dropdownItem(I(I({},e),{},{isLatest:u,repositoryName:O}),r)}));return s().createElement("tr",{key:t},s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:O},{repositoryVersion:a,tab:"repository-versions"})},a),u?" "+i.ag._({id:"DlLZIu"}):null),s().createElement("td",null,s().createElement(d.Id,{date:o})),s().createElement(d.cT,{kebabItems:c}))},sortHeaders:[{title:i.ag._({id:"jazdz0"}),type:"numeric",id:"number"},{title:i.ag._({id:"69Z/4c"}),type:"numeric",id:"pulp_created"}],title:i.ag._({id:"K9TbzM"})})};function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const C=(0,d.L9)({breadcrumbs:function(e){var t=e.name,r=e.tab,n=e.params,a=n.repositoryVersion,o=n.group;return[{url:(0,m.dI)(m.nB.ansibleRepositories),name:i.ag._({id:"ooullr"})},{url:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t}),name:t},"repository-versions"===r.id&&a||"access"===r.id&&o?{url:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t},{tab:r.id}),name:r.name}:null,"repository-versions"===r.id&&a?{name:i.ag._({id:"s7PA8t",values:{repositoryVersion:a}})}:"access"===r.id&&o?{name:i.ag._({id:"8uT/P7",values:{group:o}})}:{name:r.name}].filter(Boolean)},condition:p.fY,displayName:"AnsibleRepositoryDetail",errorTitle:{id:"tKqvEr"},headerActions:[u.cv,u.hE,u.sO,u.e5],headerDetails:function(e){return s().createElement(s().Fragment,null,(null==e?void 0:e.last_sync_task)&&s().createElement("p",{className:"hub-m-truncated"},s().createElement(o.cC,{id:"Lpz3xV",values:{0:(0,f.Fr)(e)}})," ",(0,f.Eb)(e)))},query:function(e){var t=e.name;return c.UX.list({name:t}).then((function(e){return e.data.results[0]})).then((function(e){if(!e)return Promise.reject({response:{status:404}});var t=function(e){return console.error(e),[]};return Promise.all([c.Lj.list({repository:e.pulp_href}).then((function(e){return e.data.results})).catch(t),c.UX.myPermissions((0,f.LL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch(t)]).then((function(t){var r=(0,a.Z)(t,2),n=r[0],o=r[1];return z(z({},e),{},{distributions:n,my_permissions:o})}))}))},renderTab:function(e,t,r){return{details:s().createElement(O,{item:t,actionContext:r}),access:s().createElement(y,{item:t,actionContext:r}),"collection-versions":s().createElement(E,{item:t,actionContext:r}),"repository-versions":s().createElement(N,{item:t,actionContext:r})}[e]},tabs:[{id:"details",name:{id:"URmyfc"}},{id:"access",name:{id:"LuXP9q"}},{id:"collection-versions",name:{id:"QGV1gp"}},{id:"repository-versions",name:{id:"IYNSdp"}}],tabUpdateParams:function(e){return delete e.repositoryVersion,delete e.group,e}})}}]);
//# sourceMappingURL=../sourcemaps/8118.b8b5fb3d2004ac0c1a4c4cb6fabb8e9e.js.map