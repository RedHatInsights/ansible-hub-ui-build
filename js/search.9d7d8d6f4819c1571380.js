"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[464],{50140:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a,r,c,s,l,o=n(4942),i=n(87462),u=n(30168),p=n(15671),m=n(43144),d=n(60136),f=n(61544),y=n(61120),g=n(67294),v=n(5977),h=n(13946),E=n(31765),O=n(92942),P=n(74761),S=n(43819),b=n(42807),C=n(61542),N=n(6568),R=n(61647);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){(0,d.Z)(v,e);var t,n,o=(t=v,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,y.Z)(t);if(n){var r=(0,y.Z)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,f.Z)(this,e)});function v(e){var t;(0,p.Z)(this,v),t=o.call(this,e);var n=S.q.parseParamString(e.location.search,["page","page_size"]);return n.page_size||(n.page_size=b.g.CARD_DEFAULT_PAGE_SIZE),n.view_type||(n.view_type=localStorage.getItem(b.g.SEARCH_VIEW_TYPE_LOCAL_KEY)),t.state={collections:[],params:n,numberOfResults:0,loading:!0,synclist:void 0},t}return(0,m.Z)(v,[{key:"componentDidMount",value:function(){this.queryCollections(),"insights"===b.g.INSIGHTS_DEPLOYMENT_MODE&&this.getSynclist()}},{key:"render",value:function(){var e=this,t=this.state,n=t.collections,s=t.params,l=t.numberOfResults,o=0===n.length&&!(0,N.vS)(s,["keywords","tags"]),i=function(t){return e.updateParams(t,(function(){return e.queryCollections()}))};return g.createElement("div",{className:"search-page"},g.createElement(O.UP,{className:"header",title:_(a||(a=(0,u.Z)(["Collections"]))),contextSelector:g.createElement(O.e4,{selectedRepo:this.context.selectedRepo,path:R.nB.searchByRepo})},!o&&g.createElement("div",{className:"toolbar-wrapper"},g.createElement("div",{className:"toolbar"},g.createElement(O.Ls,{ignoredParams:["page","page_size","sort","view_type"],params:s,updateParams:i}),g.createElement("div",{className:"pagination-container"},g.createElement("div",{className:"card-list-switcher"},g.createElement(O.nH,{size:"sm",params:s,updateParams:function(t){return e.updateParams(t,(function(){return localStorage.setItem(b.g.SEARCH_VIEW_TYPE_LOCAL_KEY,e.state.params.view_type)}))}})),g.createElement(O.tl,{params:s,updateParams:i,count:l,perPageOptions:b.g.CARD_DEFAULT_PAGINATION_OPTIONS,isTop:!0}))))),o?g.createElement(O.vv,{title:_(r||(r=(0,u.Z)(["No collections yet"]))),description:_(c||(c=(0,u.Z)(["Collections will appear once uploaded"])))}):g.createElement(g.Fragment,null,g.createElement("section",{className:"collection-container"},this.renderCollections(n,s,i)),g.createElement("section",{className:"footer"},g.createElement(O.tl,{params:s,updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},perPageOptions:b.g.CARD_DEFAULT_PAGINATION_OPTIONS,count:l}))))}},{key:"renderCollections",value:function(e,t,n){return this.state.loading?g.createElement(O.AW,null):0===e.length?g.createElement(O.ei,{clearAllFilters:function(){S.q.clearAllFilters({params:t,ignoredParams:["page","page_size","sort","view_type"],updateParams:n})}}):"list"===t.view_type?this.renderList(e):this.renderCards(e)}},{key:"renderCards",value:function(e){var t=this;return g.createElement("div",{className:"cards"},e.map((function(e){return g.createElement(O.zt,(0,i.Z)({className:"card",key:e.id},e,{footer:t.renderSyncToggle(e.name,e.namespace.name),repo:t.context.selectedRepo}))})))}},{key:"renderSyncToggle",value:function(e,t){var n=this;return this.state.synclist?g.createElement(h.r,{id:t+"."+e,className:"sync-toggle",label:_(s||(s=(0,u.Z)(["Sync"]))),isChecked:this.isCollectionSynced(e,t),onChange:function(){return n.toggleCollectionSync(e,t)}}):null}},{key:"toggleCollectionSync",value:function(e,t){var n=this,a=w({},this.state.synclist),r=a.collections.findIndex((function(n){return n.name===e&&n.namespace===t}));r<0?a.collections.push({name:e,namespace:t}):a.collections.splice(r,1),P.vy.update(a.id,a).then((function(e){n.setState({synclist:e.data}),P.vy.curate(a.id).then((function(){return null}))}))}},{key:"isCollectionSynced",value:function(e,t){var n=this.state.synclist,a=n.collections.find((function(n){return n.name===e&&n.namespace===t}));return"include"===n.policy?!(void 0===a):void 0===a}},{key:"renderList",value:function(e){var t=this;return g.createElement("div",{className:"list-container"},g.createElement("div",{className:"list"},g.createElement(E.FR,{className:"data-list","aria-label":_(l||(l=(0,u.Z)(["List of Collections"])))},e.map((function(e){return g.createElement(O.Op,(0,i.Z)({showNamespace:!0,key:e.id},e,{controls:t.renderSyncToggle(e.name,e.namespace.name),repo:t.context.selectedRepo}))})))))}},{key:"getSynclist",value:function(){var e=this;P.vy.list().then((function(t){1===t.data.meta.count?e.setState({synclist:t.data.data[0]}):console.error("my-synclist returned ".concat(t.data.meta.count," synclists"))}))}},{key:"queryCollections",value:function(){var e=this;this.setState({loading:!0},(function(){P.gu.list(w(w({},S.q.getReduced(e.state.params,["view_type"])),{},{deprecated:!1}),e.context.selectedRepo).then((function(t){e.setState({collections:t.data.data,numberOfResults:t.data.meta.count,loading:!1})}))}))}},{key:"updateParams",get:function(){return S.q.updateParamsMixin()}}]),v}(g.Component);const T=(0,v.EN)(A);A.contextType=C.I}}]);
//# sourceMappingURL=../sourcemaps/search.cd34b606bfe2c3fbae5d.js.map