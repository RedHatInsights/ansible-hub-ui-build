"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[1147],{31147:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var n=r(64467),a=r(80296),l=r(42328),o=r(47712),i=r(32995),u=r.n(i),s=r(35489),c=r(88756),d=r(62017),m=r(60165),p=r(5093),f=r(18712),v=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,l=r.featureFlags,s=r.hasPermission,v=r.state.params,b=r.user,R=(null==t?void 0:t.pulp_href)&&(0,f.dx)(t.pulp_href),h=(0,i.useState)(null==t?void 0:t.name),y=(0,a.A)(h,2),_=y[0],j=y[1],E=(0,i.useState)(null),g=(0,a.A)(E,2),O=g[0],P=g[1],S=(0,i.useState)(null),w=(0,a.A)(S,2),A=w[0],D=w[1],k=(0,i.useState)(!1),z=(0,a.A)(k,2),x=z[0],U=z[1],V=(0,i.useState)(null),C=(0,a.A)(V,2),F=C[0],N=C[1],J=(0,i.useState)(null),T=(0,a.A)(J,2),B=T[0],G=T[1],X=(0,i.useState)(null),q=(0,a.A)(X,2),Q=q[0],M=q[1],W=(0,i.useState)(null),L=(0,a.A)(W,2),H=L[0],I=L[1],Y=(0,i.useState)(null),K=(0,a.A)(Y,2),Z=K[0],$=K[1],ee=(0,i.useState)(null),te=(0,a.A)(ee,2),re=te[0],ne=te[1],ae=(0,i.useState)(null),le=(0,a.A)(ae,2),oe=le[0],ie=le[1],ue=(0,i.useState)(null),se=(0,a.A)(ue,2),ce=se[0],de=se[1],me=function(){D(null),P(null),c.Xj.myPermissions(R).then((function(e){var t=e.data.permissions;U((0,p.Fs)({hasPermission:s,hasObjectPermission:function(e){return t.includes(e)},user:b,featureFlags:l})),c.Xj.listRoles(R,{page_size:100}).then((function(e){var t=e.data.roles,r=(0,f.LF)(t),n=r.users,a=r.groups;j(_),D(n),P(a)})).catch((function(){D([]),P([])}))})).catch((function(){D([]),P([]),U(!1)}))},pe=function(e){var t=e.roles,r=e.alertSuccess,a=e.alertFailure,l=e.stateUpdate;Promise.all(t).then((function(){n({title:r,variant:"success"}),me()})).catch((function(e){var t=e.response,r=t.status,l=t.statusText;n({title:a,variant:"danger",description:(0,f.gJ)(r,l)})})).finally((function(){fe(l)}))},fe=function(e){Object.entries(e).forEach((function(e){var t=(0,a.A)(e,2),r=t[0],n=t[1];switch(r){case"showUserRemoveModal":M(n);break;case"showUserSelectWizard":I(n);break;case"showGroupRemoveModal":$(n);break;case"showGroupSelectWizard":ne(n);break;case"showRoleRemoveModal":ie(n);break;case"showRoleSelectWizard":de(n);break;default:console.error("updateProps",r,n)}}))};return(0,i.useEffect)(me,[t.pulp_href]),(0,i.useEffect)((function(){A&&(null!=v&&v.user?c.QS.list({username:v.user}).then((function(e){var t=e.data.data;G(A.find((function(e){return e.username===t[0].username})))})):G(null))}),[null==v?void 0:v.user,A]),(0,i.useEffect)((function(){O&&(null!=v&&v.group?c.YF.list({name:v.group}).then((function(e){var t=e.data.data;N(O.find((function(e){return e.name===t[0].name})))})):N(null))}),[null==v?void 0:v.group,O]),u().createElement(d.Gj,{addGroup:function(e,t){var r=t.map((function(t){return c.Xj.addRole(R,{role:t.name,groups:[e.name]})}));pe({roles:r,alertSuccess:o.Ru._({id:"lylrvu",values:{0:e.name,name:_}}),alertFailure:o.Ru._({id:"9/YKZd",values:{0:e.name,name:_}}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var r=t.map((function(t){return c.Xj.addRole(R,{role:t.name,groups:[e.name]})}));pe({roles:r,alertSuccess:o.Ru._({id:"svLSRe",values:{0:e.name,name:_}}),alertFailure:o.Ru._({id:"eeQk9h",values:{0:e.name,name:_}}),stateUpdate:{showRoleSelectWizard:null}})},addUser:function(e,t){var r=t.map((function(t){return c.Xj.addRole(R,{role:t.name,users:[e.username]})}));pe({roles:r,alertSuccess:o.Ru._({id:"J7EvK0",values:{0:e.username,name:_}}),alertFailure:o.Ru._({id:"0P+eGj",values:{0:e.username,name:_}}),stateUpdate:{showUserSelectWizard:null}})},addUserRole:function(e,t){var r=t.map((function(t){return c.Xj.addRole(R,{role:t.name,users:[e.username]})}));pe({roles:r,alertSuccess:o.Ru._({id:"ifVlo4",values:{0:e.username,name:_}}),alertFailure:o.Ru._({id:"xJC6dy",values:{0:e.username,name:_}}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:x,group:F,groups:O,name:_,pulpObjectType:"repositories/ansible/ansible",removeGroup:function(e){var t=e.object_roles.map((function(t){return c.Xj.removeRole(R,{role:t,groups:[e.name]})}));pe({roles:t,alertSuccess:o.Ru._({id:"94LxzI",values:{0:e.name,name:_}}),alertFailure:o.Ru._({id:"j17tAi",values:{0:e.name,name:_}}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var r=c.Xj.removeRole(R,{role:e,groups:[t.name]});pe({roles:[r],alertSuccess:o.Ru._({id:"svLSRe",values:{0:t.name,name:_}}),alertFailure:o.Ru._({id:"eeQk9h",values:{0:t.name,name:_}}),stateUpdate:{showRoleRemoveModal:null}})},removeUser:function(e){var t=e.object_roles.map((function(t){return c.Xj.removeRole(R,{role:t,users:[e.username]})}));pe({roles:t,alertSuccess:o.Ru._({id:"ekGBsh",values:{0:e.username,name:_}}),alertFailure:o.Ru._({id:"O21voo",values:{0:e.username,name:_}}),stateUpdate:{showUserRemoveModal:null}})},removeUserRole:function(e,t){var r=c.Xj.removeRole(R,{role:e,users:[t.username]});pe({roles:[r],alertSuccess:o.Ru._({id:"ifVlo4",values:{0:t.username,name:_}}),alertFailure:o.Ru._({id:"xJC6dy",values:{0:t.username,name:_}}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:o.Ru._({id:"WoaabF"}),showGroupRemoveModal:Z,showGroupSelectWizard:re,showRoleRemoveModal:oe,showRoleSelectWizard:ce,showUserRemoveModal:Q,showUserSelectWizard:H,updateProps:fe,user:B,users:A,urlPrefix:(0,m.jV)(m.Jh.ansibleRepositoryDetail,{name:_})})},b=r(49634);function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,l=r.hasPermission,p=function(){var e=h({},(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params);e.ordering=e.sort,delete e.sort;var r=(0,f.dx)(t.pulp_href);return c.R4.list(h({repository:r},e)).then((function(e){var t=e.data;return{data:{count:t.meta.count,results:t.data}}}))},v=(0,i.useState)({repository:t}),R=(0,a.A)(v,2),y=R[0],_=R[1];return(0,i.useEffect)((function(){return _((function(e){return h(h({},e),{},{repository:t})}))}),[t]),u().createElement(d.cJ,{actionContext:{addAlert:n,state:y,setState:_,query:p,hasPermission:l,hasObjectPermission:function(e){var r,n;return null==t||null===(r=t.my_permissions)||void 0===r||null===(n=r.includes)||void 0===n?void 0:n.call(r,e)}},defaultPageSize:10,defaultSort:"name",errorTitle:o.Ru._({id:"GNyQoC"}),filterConfig:[{id:"keywords",title:o.Ru._({id:"/n/HCO"})},{id:"namespace",title:o.Ru._({id:"wMe2Qp"})}],headerActions:[s.Oz],listItemActions:[s.$6],noDataButton:s.Oz.button,noDataDescription:o.Ru._({id:"wATscz"}),noDataTitle:o.Ru._({id:"Ut02fq"}),query:p,renderTableRow:function(e,t,r,n){var a=e.collection_version,l=a.name,o=a.namespace,i=a.version,s=a.description,c=e.repository,p=n.map((function(t){return t.dropdownItem(e,r)}));return u().createElement("tr",{key:t},u().createElement("td",null,u().createElement(b.Link,{to:(0,m.jV)(m.Jh.collectionByRepo,{repo:c.name,namespace:o,collection:l},{version:i})},o,".",l," v",i)),u().createElement("td",null,s),u().createElement(d.dO,{kebabItems:p}))},sortHeaders:[{title:o.Ru._({id:"q+hNag"}),type:"none",id:"col1"},{title:o.Ru._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:o.Ru._({id:"QGV1gp"})})},_=function(e){var t,r=e.item;return u().createElement(d.B_,{fields:[{label:o.Ru._({id:"0xnmlQ"}),value:null==r?void 0:r.name},{label:o.Ru._({id:"Nu4oKW"}),value:(null==r?void 0:r.description)||o.Ru._({id:"EdQY6l"})},{label:o.Ru._({id:"B/CcxR"}),value:null!==(t=null==r?void 0:r.retain_repo_versions)&&void 0!==t?t:o.Ru._({id:"N40H+G"})},{label:o.Ru._({id:"vU/Hht"}),value:u().createElement(d.S9,{repositoryHref:null==r?void 0:r.pulp_href})},{label:o.Ru._({id:"UXGlf6"}),value:null!=r&&r.distroBasePath?u().createElement(d.hi,{url:(0,f.k9)(r.distroBasePath)}):"---"},{label:o.Ru._({id:"h8DugX"}),value:u().createElement(d.H7,{labels:null==r?void 0:r.pulp_labels})},{label:o.Ru._({id:"zwBp5t"}),value:null!=r&&r.private?o.Ru._({id:"l75CjT"}):o.Ru._({id:"1UzENP"})},{label:o.Ru._({id:"qlAIQ1"}),value:null!=r&&r.remote?u().createElement(b.Link,{to:(0,m.jV)(m.Jh.ansibleRemoteDetail,{name:null==r?void 0:r.remote.name})},null==r?void 0:r.remote.name):o.Ru._({id:"EdQY6l"})}]})},j=r(58168),E=r(92901),g=r(23029),O=r(56822),P=r(53954),S=r(9417),w=r(15361),A=r(85889);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return t=(0,P.A)(t),(0,O.A)(e,x()?Reflect.construct(t,r||[],(0,P.A)(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var U=function(e){var t=e.href,r=e.addAlert,l=e.hasPermission,s=e.repositoryName,p=(0,i.useState)({}),f=(0,a.A)(p,2),v=f[0],R=f[1];if(!t)return null;var h=function(e){return new(function(t){function r(){var t;(0,g.A)(this,r);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return t=z(this,r,[].concat(l)),(0,n.A)((0,S.A)(t),"apiPath",e.replace("/api/automation-hub/pulp/api/v3/","")),t}return(0,w.A)(r,t),(0,E.A)(r)}(c.y$))}(t),y=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params;return h.list(e)};return u().createElement(d.cJ,{actionContext:{addAlert:r,state:v,setState:R,query:y,hasPermission:l},defaultPageSize:10,defaultSort:"name",errorTitle:o.Ru._({id:"GNyQoC"}),noDataDescription:o.Ru._({id:"RXBYdl"}),noDataTitle:o.Ru._({id:"Ut02fq"}),query:y,renderTableRow:function(e){var t=e.manifest.collection_info,r=t.namespace,n=t.name,a=t.version,l=e.description;return u().createElement("tr",null,u().createElement("td",null,u().createElement(b.Link,{to:(0,m.jV)(m.Jh.collectionByRepo,{repo:s,namespace:r,collection:n},{version:a})},r,".",n," v",a)),u().createElement("td",null,l))},sortHeaders:[{title:o.Ru._({id:"q+hNag"}),type:"none",id:"col1"},{title:o.Ru._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:o.Ru._({id:"QGV1gp"})})},V=function(e){var t=e.data;return Object.keys(t).length?u().createElement("table",{className:"pf-c-table"},u().createElement("tr",null,u().createElement("th",null,o.Ru._({id:"wBMjJ2"})),u().createElement("th",null,o.Ru._({id:"rZfa42"}))),Object.entries(t).map((function(e){var t=(0,a.A)(e,2),r=t[0],n=t[1];return u().createElement("tr",{key:r},u().createElement("td",null,n.count),u().createElement("th",null,r))}))):u().createElement(u().Fragment,null,o.Ru._({id:"EdQY6l"}))},C=function(e){var t=e.repositoryName,r=e.data;if(!r)return u().createElement(u().Fragment,null,o.Ru._({id:"EdQY6l"}));var n=r.split("/").at(-2);return u().createElement(b.Link,{to:(0,m.jV)(m.Jh.ansibleRepositoryDetail,{name:t},{repositoryVersion:n,tab:"repository-versions"})},n)},F=function(e){var t,r,n,l=e.item,p=e.actionContext,v=p.addAlert,R=p.state,h=p.hasPermission,y=p.hasObjectPermission,_=(0,f.dx)(l.pulp_href),E=l.latest_version_href,g=l.name,O=function(e){var t=e.params;return c.Xj.listVersions(_,t)},P=(0,i.useState)({}),S=(0,a.A)(P,2),w=S[0],D=S[1],z=(0,i.useState)(null),x=(0,a.A)(z,2),F=x[0],N=x[1];return(0,i.useEffect)((function(){var e,t;R.params.repositoryVersion?(e={number:R.params.repositoryVersion},t=e.number,c.Xj.listVersions(_,{number:t})).then((function(e){var t,r=e.data;null!=r&&null!==(t=r.results)&&void 0!==t&&t[0]||v({variant:"danger",title:o.Ru._({id:"/NE1Mg"})}),N(r.results[0])})):N(null)}),[R.params.repositoryVersion]),R.params.repositoryVersion?F?u().createElement(u().Fragment,null,u().createElement(d.B_,{fields:[{label:o.Ru._({id:"jazdz0"}),value:F.number},{label:o.Ru._({id:"69Z/4c"}),value:u().createElement(d.gz,{date:F.pulp_created})},{label:o.Ru._({id:"4w69Y9"}),value:u().createElement(V,{data:null===(t=F.content_summary)||void 0===t?void 0:t.added})},{label:o.Ru._({id:"aE2TFq"}),value:u().createElement(V,{data:null===(r=F.content_summary)||void 0===r?void 0:r.removed})},{label:o.Ru._({id:"ESNb89"}),value:u().createElement(V,{data:null===(n=F.content_summary)||void 0===n?void 0:n.present})},{label:o.Ru._({id:"DgzWiz"}),value:u().createElement(C,{repositoryName:g,data:F.base_version})}]}),u().createElement("div",{className:"pf-c-page__main-section",style:{padding:"8px 0",margin:"24px -16px 0"}}),u().createElement(U,(0,j.A)({},F.content_summary.present["ansible.collection_version"],{repositoryName:g}))):u().createElement(A.Spinner,{size:"md"}):u().createElement(d.cJ,{actionContext:{addAlert:v,state:w,setState:D,query:O,hasPermission:h,hasObjectPermission:y},defaultPageSize:10,defaultSort:"-pulp_created",errorTitle:o.Ru._({id:"0e4kDo"}),filterConfig:null,listItemActions:[s.Th],noDataButton:null,noDataDescription:o.Ru._({id:"fjbxkP"}),noDataTitle:o.Ru._({id:"asZQa0"}),query:O,renderTableRow:function(e,t,r,n){var a=e.number,l=e.pulp_created,i=e.pulp_href,s=E===i,c=n.map((function(t){return t.dropdownItem(k(k({},e),{},{isLatest:s,repositoryName:g}),r)}));return u().createElement("tr",{key:t},u().createElement("td",null,u().createElement(b.Link,{to:(0,m.jV)(m.Jh.ansibleRepositoryDetail,{name:g},{repositoryVersion:a,tab:"repository-versions"})},a),s?" "+o.Ru._({id:"DlLZIu"}):null),u().createElement("td",null,u().createElement(d.gz,{date:l})),u().createElement(d.dO,{kebabItems:c}))},sortHeaders:[{title:o.Ru._({id:"jazdz0"}),type:"numeric",id:"number"},{title:o.Ru._({id:"69Z/4c"}),type:"numeric",id:"pulp_created"}],title:o.Ru._({id:"K9TbzM"})})};function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const T=(0,d.UE)({breadcrumbs:function(e){var t=e.name,r=e.tab,n=e.params,a=n.repositoryVersion,l=n.user,i=n.group;return[{url:(0,m.jV)(m.Jh.ansibleRepositories),name:o.Ru._({id:"ooullr"})},{url:(0,m.jV)(m.Jh.ansibleRepositoryDetail,{name:t}),name:t},"access"===r.id&&(i||l)||"repository-versions"===r.id&&a?{url:(0,m.jV)(m.Jh.ansibleRepositoryDetail,{name:t},{tab:r.id}),name:r.name}:null,"access"===r.id&&i?{name:o.Ru._({id:"8uT/P7",values:{group:i}})}:null,"access"===r.id&&l?{name:o.Ru._({id:"AkUbn7",values:{user:l}})}:null,"repository-versions"===r.id&&a?{name:o.Ru._({id:"s7PA8t",values:{repositoryVersion:a}})}:null,"access"===r.id&&!l&&!i||"repository-versions"===r.id&&!a?{name:r.name}:null].filter(Boolean)},condition:p.k3,displayName:"AnsibleRepositoryDetail",errorTitle:{id:"tKqvEr"},headerActions:[s.Bq,s._F,s.i6,s.Kf],headerDetails:function(e){return u().createElement(u().Fragment,null,(null==e?void 0:e.last_sync_task)&&u().createElement("p",{className:"hub-m-truncated"},u().createElement(l.x6,{id:"Lpz3xV",values:{0:(0,f.xf)(e)}})," ",(0,f.Oy)(e)))},listUrl:(0,m.jV)(m.Jh.ansibleRepositories),query:function(e){var t=e.name;return c.Xj.list({name:t,page_size:1}).then((function(e){return e.data.results[0]})).then((function(e){if(!e)return Promise.reject({response:{status:404}});var t=function(e){return function(t){return console.error(t),e}};return Promise.all([(0,f.Jh)(e.name,e.pulp_href).catch(t(null)),c.Xj.myPermissions((0,f.dx)(e.pulp_href)).then((function(e){return e.data.permissions})).catch(t([])),e.remote?c.DY.get((0,f.dx)(e.remote)).then((function(e){return e.data})).catch((function(){return null})):null]).then((function(t){var r=(0,a.A)(t,3),n=r[0],l=r[1],o=r[2];return J(J({},e),{},{distroBasePath:n,my_permissions:l,remote:o})}))}))},renderTab:function(e,t,r){return{details:u().createElement(_,{item:t,actionContext:r}),access:u().createElement(v,{item:t,actionContext:r}),"collection-versions":u().createElement(y,{item:t,actionContext:r}),"repository-versions":u().createElement(F,{item:t,actionContext:r})}[e]},tabs:[{id:"details",name:{id:"URmyfc"}},{id:"access",name:{id:"LuXP9q"}},{id:"collection-versions",name:{id:"QGV1gp"}},{id:"repository-versions",name:{id:"IYNSdp"}}],tabUpdateParams:function(e){return delete e.repositoryVersion,delete e.group,delete e.user,e}})}}]);
//# sourceMappingURL=../sourcemaps/1147.b8dbe0d67619d3edb3b3e49085737dd8.js.map