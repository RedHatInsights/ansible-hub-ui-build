"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[6176],{75907:(e,t,n)=>{n.d(t,{Bu:()=>d,bU:()=>f,PU:()=>v,MC:()=>b,Rq:()=>_,JJ:()=>y,sO:()=>g,DO:()=>h,e5:()=>C,cv:()=>k,hE:()=>S,W:()=>O});var r=n(35356),a=n(92950),o=n.n(a),l=n(41315),i=function(e){var t=e.buttonVariant,n=e.condition,a=void 0===n?function(){return!0}:n,i=e.disabled,u=void 0===i?function(){return null}:i,c=e.modal,s=void 0===c?null:c,d=e.onClick,m=e.title,p=e.visible,f=void 0===p?function(){return!0}:p;return{title:m,button:function(e,n){return a(n,e)&&f(e,n)?u(e,n)?o().createElement(l.u,{content:u(e,n),key:m},o().createElement(r.Button,{variant:t,isDisabled:!0},m)):o().createElement(r.Button,{variant:t,key:m,onClick:function(){return d(e,n)}},m):null},dropdownItem:function(e,t){return a(t,e)&&f(e,t)?u(e,t)?o().createElement(r.DropdownItem,{key:m,description:u(e,t),isDisabled:!0},m):o().createElement(r.DropdownItem,{key:m,onClick:function(){return d(e,t)}},m):null},modal:s,visible:f,disabled:u}},u=n(13855),c=n(61647),s=n(6640),d=i({condition:s.rH,title:u.ag._("Add remote"),onClick:function(e,t){return(0,t.navigate)((0,c.dI)(c.nB.ansibleRemoteEdit,{name:"_"}))}}),m=n(45586),p=n(92518),f=i({condition:s.nm,title:u.ag._("Delete"),modal:function(e){var t=e.addAlert,n=e.query,r=e.setState,a=e.state;return a.deleteModalOpen?o().createElement(l.X3,{closeAction:function(){return r({deleteModalOpen:null})},deleteAction:function(){return function(e,t){var n=e.name,r=e.pulpId,a=t.addAlert,o=t.setState,l=t.query;return m.GC.delete(r).then((function(e){var t=e.data;a((0,p.zT)(t.task,u.ag._("Removal started for remote {name}",{name:n}))),o({deleteModalOpen:null}),l()})).catch((0,p.rJ)(u.ag._("Failed to remove remote {name}",{name:n}),(function(){return null}),a))}(a.deleteModalOpen,{addAlert:t,setState:r,query:n})},name:a.deleteModalOpen.name}):null},onClick:function(e,t){var n=e.name,r=e.id,a=e.pulp_href;return(0,t.setState)({deleteModalOpen:{pulpId:r||(0,p.LL)(a),name:n}})}}),v=i({title:u.ag._("Download CA certificate"),onClick:function(e){var t=e.ca_cert;return(0,p.Qz)(t,"ca_cert")},visible:function(e){return!!e.ca_cert}}),b=i({title:u.ag._("Download client certificate"),onClick:function(e){var t=e.client_cert;return(0,p.Qz)(t,"client_cert")},visible:function(e){return!!e.client_cert}}),_=i({title:u.ag._("Download requirements YAML"),onClick:function(e){var t=e.requirements_file;return(0,p.Qz)(t,"requirements.yml")},visible:function(e){return!!e.requirements_file}}),y=i({condition:s.DQ,title:u.ag._("Edit"),onClick:function(e,t){var n=e.name;return(0,t.navigate)((0,c.dI)(c.nB.ansibleRemoteEdit,{name:n}))}}),g=i({title:u.ag._("Copy CLI configuration"),onClick:function(e,t){var n=t.addAlert,r=["[galaxy]","server_list = ".concat(e.name,"_repo"),"","[galaxy_server.".concat(e.name,"_repo]"),"url=".concat((0,p.qX)()),"token=<put your token here>"].join("\n");navigator.clipboard.writeText(r),n({title:u.ag._("Successfully copied to clipboard"),variant:"success",description:o().createElement("pre",null,r)})}}),h=i({condition:s.zN,title:u.ag._("Add repository"),onClick:function(e,t){return(0,t.navigate)((0,c.dI)(c.nB.ansibleRepositoryEdit,{name:"_"}))}}),C=i({condition:s.Xn,title:u.ag._("Delete"),modal:function(e){var t=e.addAlert,n=e.query,r=e.setState,a=e.state;return a.deleteModalOpen?o().createElement(l.Iq,{closeAction:function(){return r({deleteModalOpen:null})},deleteAction:function(){return function(e,t){var n=e.name,r=e.pulpId,a=t.addAlert,o=t.setState,l=t.query;return m.UX.delete(r).then((function(e){var t=e.data;a((0,p.zT)(t.task,u.ag._("Removal started for repository {name}",{name:n}))),o({deleteModalOpen:null}),l()})).catch((0,p.rJ)(u.ag._("Failed to remove repository {name}",{name:n}),(function(){return null}),a))}(a.deleteModalOpen,{addAlert:t,setState:r,query:n})},name:a.deleteModalOpen.name}):null},onClick:function(e,t){var n=e.name,r=e.id,a=e.pulp_href;return(0,t.setState)({deleteModalOpen:{pulpId:r||(0,p.LL)(a),name:n}})}}),k=i({condition:s.lo,title:u.ag._("Edit"),onClick:function(e,t){var n=e.name;return(0,t.navigate)((0,c.dI)(c.nB.ansibleRepositoryEdit,{name:n}))}}),S=i({condition:s.vn,title:u.ag._("Sync"),onClick:function(e,t){var n=e.name,r=e.pulp_href,a=t.addAlert,o=t.query,l=(0,p.LL)(r);m.UX.sync(l).then((function(e){var t=e.data;a((0,p.zT)(t.task,u.ag._('Sync started for repository "{name}".',{name:n}))),o()})).catch((0,p.rJ)(u.ag._('Failed to sync repository "{name}"',{name:n}),(function(){return null}),a))},visible:function(e,t){return(0,t.hasPermission)("ansible.change_collectionremote")},disabled:function(e){var t=e.remote,n=e.last_sync_task;return t?n&&["running","waiting"].includes(n.state)?u.ag._("Sync task is already queued."):null:u.ag._("There are no remotes associated with this repository.")}}),E=n(70885),w=n(14744),R=function(e){var t=e.version,n=e.cancelAction,l=e.revertAction,i=(0,a.useState)(!1),c=(0,E.Z)(i,2),s=c[0],d=c[1];return o().createElement(r.Modal,{actions:[o().createElement("div",{"data-cy":"delete-button",key:"delete"},o().createElement(r.Button,{key:"delete",onClick:function(){d(!0),l()},variant:"danger",isDisabled:s},u.ag._("Revert"),s&&o().createElement(r.Spinner,{size:"sm"}))),o().createElement(r.Button,{key:"cancel",onClick:n,variant:"link"},u.ag._("Cancel"))],isOpen:!0,onClose:n,title:u.ag._("Revert repository"),titleIconVariant:"warning",variant:"small","data-cy":"modal_checkbox"},o().createElement(w.cC,{id:"Are you sure you want to revert this repository to the version below?"}),o().createElement("br",null),o().createElement("b",null,t))},O=i({condition:s.Wt,title:u.ag._("Revert to this version"),modal:function(e){var t=e.addAlert,n=e.state,r=e.setState,a=e.query;return n.revertModal?o().createElement(R,{cancelAction:function(){return r({revertModal:null})},revertAction:function(){return function(e,t){var n=e.repositoryName,r=e.pulp_href,a=e.number,o=t.addAlert,l=t.setState,i=t.query,c=(0,p.LL)(r);return m.UX.revert(c,r).then((function(e){var t=e.data;o((0,p.zT)(t.task,u.ag._('Revert started for repository "{repositoryName}".',{repositoryName:n}))),l({revertModal:null}),i()})).catch((0,p.rJ)(u.ag._('Failed to revert repository "{repositoryName}" to version "{number}"',{repositoryName:n,number:a}),(function(){return l({revertModal:null})}),o))}(n.revertModal,{addAlert:t,setState:r,query:a})},version:n.revertModal.number}):null},onClick:function(e,t){var n=e.repositoryName,r=e.number,a=e.pulp_href;return(0,t.setState)({revertModal:{repositoryName:n,number:r,pulp_href:a}})},disabled:function(e){return e.isLatest?u.ag._("Already the current version"):null}})},36176:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(4942),a=n(13855),o=n(92950),l=n.n(o),i=n(75907),u=n(45586),c=n(41315),s=n(61647),d=n(6640),m=n(92518),p=n(70885);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.item,n=e.actionContext,r=n.addAlert,i=n.state.params,v=n.hasPermission,b=n.user,_=(null==t?void 0:t.pulp_href)&&(0,m.LL)(t.pulp_href),y=(0,o.useState)(null==t?void 0:t.name),g=(0,p.Z)(y,2),h=g[0],C=g[1],k=(0,o.useState)(null),S=(0,p.Z)(k,2),E=S[0],w=S[1],R=(0,o.useState)(!1),O=(0,p.Z)(R,2),A=O[0],M=O[1],G=(0,o.useState)(null),P=(0,p.Z)(G,2),D=P[0],I=P[1],j=(0,o.useState)(null),q=(0,p.Z)(j,2),L=q[0],T=q[1],x=(0,o.useState)(null),B=(0,p.Z)(x,2),z=B[0],N=B[1],U=(0,o.useState)(null),Z=(0,p.Z)(U,2),F=Z[0],W=Z[1],J=(0,o.useState)(null),X=(0,p.Z)(J,2),Q=X[0],H=X[1],Y=function(){w(null),u.GC.myPermissions(_).then((function(e){var t=e.data.permissions;M((0,d.yA)({hasPermission:v,hasObjectPermission:function(e){return t.includes(e)},user:b})),u.GC.listRoles(_).then((function(e){var t,n=e.data.roles,r=[],a=f(n);try{for(a.s();!(t=a.n()).done;){var o,l=t.value,i=l.groups,u=l.role,c=f(i);try{var s=function(){var e=o.value,t=r.findIndex((function(t){return t.name===e}));-1==t?r.push({name:e,object_roles:[u]}):r[t].object_roles.push(u)};for(c.s();!(o=c.n()).done;)s()}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}C(h),w(r)})).catch((function(){w([])}))})).catch((function(){w([]),M(!1)}))},V=function(e){var t=e.roles,n=e.alertSuccess,a=e.alertFailure,o=e.stateUpdate;Promise.all(t).then((function(){r({title:n,variant:"success"}),Y()})).catch((function(e){var t=e.response,n=t.status,o=t.statusText;r({title:a,variant:"danger",description:(0,m.N3)(n,o)})})).finally((function(){K(o)}))},K=function(e){Object.entries(e).forEach((function(e){var t=(0,p.Z)(e,2),n=t[0],r=t[1];switch(n){case"showGroupRemoveModal":T(r);break;case"showGroupSelectWizard":N(r);break;case"showRoleRemoveModal":W(r);break;case"showRoleSelectWizard":H(r);break;default:console.error("updateProps",n,r)}}))};return(0,o.useEffect)(Y,[t.pulp_href]),(0,o.useEffect)((function(){E&&(null!=i&&i.group?u.lO.list({name:i.group}).then((function(e){var t=e.data.data;I(E.find((function(e){return e.name===t[0].name})))})):I(null))}),[null==i?void 0:i.group,E]),l().createElement(c.yW,{addGroup:function(e,t){var n=t.map((function(t){return u.GC.addRole(_,{role:t.name,groups:[e.name]})}));V({roles:n,alertSuccess:a.ag._('Group "{0}" has been successfully added to "{name}".',{0:e.name,name:h}),alertFailure:a.ag._('Group "{0}" could not be added to "{name}".',{0:e.name,name:h}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var n=t.map((function(t){return u.GC.addRole(_,{role:t.name,groups:[e.name]})}));V({roles:n,alertSuccess:a.ag._('Group "{0}" roles successfully updated in "{name}".',{0:e.name,name:h}),alertFailure:a.ag._('Group "{0}" roles could not be update in "{name}".',{0:e.name,name:h}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:A,group:D,groups:E,name:h,pulpObjectType:"remotes/ansible/collection",removeGroup:function(e){var t=e.object_roles.map((function(t){return u.GC.removeRole(_,{role:t,groups:[e.name]})}));V({roles:t,alertSuccess:a.ag._('Group "{0}" has been successfully removed from "{name}".',{0:e.name,name:h}),alertFailure:a.ag._('Group "{0}" could not be removed from "{name}".',{0:e.name,name:h}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var n=u.GC.removeRole(_,{role:e,groups:[t.name]});V({roles:[n],alertSuccess:a.ag._('Group "{0}" roles successfully updated in "{name}".',{0:t.name,name:h}),alertFailure:a.ag._('Group "{0}" roles could not be update in "{name}".',{0:t.name,name:h}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:a.ag._("The selected roles will be added to this specific Ansible remote."),showGroupRemoveModal:L,showGroupSelectWizard:z,showRoleRemoveModal:F,showRoleSelectWizard:Q,updateProps:K,urlPrefix:(0,s.dI)(s.nB.ansibleRemoteDetail,{name:h})})},_=n(35356),y=function(e){var t=e.code,n=l().useState(!1),r=(0,p.Z)(n,2),o=r[0],i=r[1],u=l().createElement(l().Fragment,null,l().createElement(_.CodeBlockAction,null,l().createElement(_.ClipboardCopyButton,{id:"basic-copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:function(e){return function(e,t){navigator.clipboard.writeText(t.toString())}(0,t),void i(!0)},exitDelay:o?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:function(){return i(!1)}},o?a.ag._("Successfully copied to clipboard"):a.ag._("Copy to clipboard"))));return l().createElement(_.CodeBlock,{actions:u},l().createElement(_.CodeBlockCode,{id:"code-content"},t))},g=function(e){var t=e.code;return t?l().createElement(y,{code:t}):l().createElement(l().Fragment,null,a.ag._("None"))},h=function(e){var t,n,r=e.item;return l().createElement(c.PO,{fields:[{label:a.ag._("Remote name"),value:null==r?void 0:r.name},{label:a.ag._("URL"),value:l().createElement(c.TO,{url:null==r?void 0:r.url,fallback:!0})},{label:a.ag._("Proxy URL"),value:l().createElement(c.TO,{url:null==r?void 0:r.proxy_url,fallback:!0})},{label:a.ag._("TLS validation"),value:null!=r&&r.tls_validation?a.ag._("Enabled"):a.ag._("Disabled")},{label:a.ag._("Client certificate"),value:(null==r?void 0:r.client_cert)||a.ag._("None")},{label:a.ag._("CA certificate"),value:(null==r?void 0:r.ca_cert)||a.ag._("None")},{label:a.ag._("Download concurrency"),value:null!==(t=null==r?void 0:r.download_concurrency)&&void 0!==t?t:a.ag._("None")},{label:a.ag._("Rate limit"),value:null!==(n=null==r?void 0:r.rate_limit)&&void 0!==n?n:a.ag._("None")},{label:a.ag._("Repositories"),value:l().createElement(c.oK,{remoteHref:null==r?void 0:r.pulp_href})},{label:a.ag._("YAML requirements"),value:l().createElement(g,{code:null==r?void 0:r.requirements_file})}]})};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=[{id:"details",name:a.ag._("Details")},{id:"access",name:a.ag._("Access")}];const E=(0,c.L9)({breadcrumbs:function(e){var t=e.name,n=e.tab,r=e.params.group;return[{url:(0,s.dI)(s.nB.ansibleRemotes),name:a.ag._("Remotes")},{url:(0,s.dI)(s.nB.ansibleRemoteDetail,{name:t}),name:t},"access"===n.id&&r?{url:(0,s.dI)(s.nB.ansibleRepositoryDetail,{name:t},{tab:n.id}),name:n.name}:null,"access"===n.id&&r?{name:a.ag._("Group {group}",{group:r})}:{name:n.name}].filter(Boolean)},condition:d.MT,displayName:"AnsibleRemoteDetail",errorTitle:a.ag._("Remote could not be displayed."),headerActions:[i.JJ,i.Rq,i.MC,i.PU,i.bU],query:function(e){var t=e.name;return u.GC.list({name:t}).then((function(e){return e.data.results[0]})).then((function(e){return u.GC.myPermissions((0,m.LL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch((function(e){return console.error(e),[]})).then((function(t){return k(k({},e),{},{my_permissions:t})}))}))},renderTab:function(e,t,n){return{details:l().createElement(h,{item:t,actionContext:n}),access:l().createElement(b,{item:t,actionContext:n})}[e]},tabs:S,tabUpdateParams:function(e){return delete e.group,e}})},6640:(e,t,n)=>{n.d(t,{DQ:()=>i,MT:()=>u,Wt:()=>b,X0:()=>v,Xn:()=>d,fY:()=>f,lo:()=>m,nm:()=>l,rH:()=>o,vn:()=>p,yA:()=>c,zN:()=>s});var r=function(e){return function(t){var n=t.hasPermission,r=t.user;return n(e)||(null==r?void 0:r.is_superuser)}},a=function(e){return function(t,n){var r=t.hasPermission,a=t.hasObjectPermission,o=t.user;return r(e)||(null==a?void 0:a(e,n))||(null==o?void 0:o.is_superuser)}},o=r("ansible.add_collectionremote"),l=a("ansible.delete_collectionremote"),i=a("ansible.change_collectionremote"),u=a("ansible.view_collectionremote"),c=a("ansible.manage_roles_collectionremote"),s=r("ansible.add_ansiblerepository"),d=a("ansible.delete_ansiblerepository"),m=a("ansible.change_ansiblerepository"),p=m,f=function(e){var t=e.user;return t&&!t.is_anonymous},v=a("ansible.manage_roles_ansiblerepository"),b=m}}]);
//# sourceMappingURL=../sourcemaps/6176.f894728d5e8731ff021fe52f34fae5c8.js.map