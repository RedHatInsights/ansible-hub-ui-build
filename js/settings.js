(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{893:function(e,t,n){(e.exports=n(7)(!1)).push([e.i,".certification-dasboard .toolbar{padding-bottom:16px;display:flex;justify-content:space-between}.certification-dasboard .control-column{display:flex;justify-content:flex-end;align-items:center}.certification-dasboard .footer{padding-top:16px}.certification-dasboard .updating-spinner{color:var(--pf-global--info-color--100)}\n",""])},905:function(e,t,n){var a=n(893);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},o=n(8)(a,r);a.locals&&(e.exports=a.locals),e.hot.accept(893,(function(){var t=n(893);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,a=0;for(n in e){if(!t||e[n]!==t[n])return!1;a++}for(n in t)a--;return 0===a}(a.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");o(t)})),e.hot.dispose((function(){o()}))},918:function(e,t,n){"use strict";n.r(t);var a,r=n(1),o=n(597),i=n(67),c=n(593),s=n(71),l=n(353),u=n(35),p=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={tokenData:void 0},n}return p(t,e),t.prototype.componentDidMount=function(){var e=this;window.insights.chrome.auth.getOfflineToken().then((function(t){e.setState({tokenData:t.data})}))},t.prototype.render=function(){var e=this,t=this.state.tokenData;return r.createElement(r.Fragment,null,r.createElement(l.e,{title:"Connect to Hub"}),r.createElement(l.w,null,r.createElement(i.Section,{className:"body pf-c-content"},r.createElement("h2",null,"Offline token"),r.createElement("p",null,"Use this token to authenticate the ",r.createElement("code",null,"ansible-galaxy")," ","client."),t?r.createElement("div",null,r.createElement(c.a,null,t.refresh_token)):r.createElement(s.a,{onClick:function(){return e.loadToken()}},"Load token"),r.createElement("h2",null,"Manage tokens"),"To remove an existing token, visit"," ",r.createElement("a",{href:"https://sso.redhat.com/auth/realms/redhat-external/account/",target:"_blank"},"Red Hat SSO account management"),"."),r.createElement(i.Section,{className:"body pf-c-content"},r.createElement("h2",null,"Server URL"),r.createElement("p",null,"Use this URL to configure Galaxy server in your the"," ",r.createElement("code",null,"ansible-galaxy")," client."),r.createElement(c.a,{isReadOnly:!0},Object(u.c)(""))),r.createElement(i.Section,{className:"body pf-c-content"},r.createElement("h2",null,"SSO URL"),r.createElement("p",null,"Use this URL to authenticate the ",r.createElement("code",null,"ansible-galaxy")," ","client."," "),r.createElement(c.a,{isReadOnly:!0},"https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token"))))},t.prototype.loadToken=function(){window.insights.chrome.auth.doOffline()},t}(r.Component);t.default=Object(o.a)(d);try{tokeninsights.displayName="tokeninsights",tokeninsights.__docgenInfo={description:"",displayName:"tokeninsights",props:{wrappedComponentRef:{defaultValue:null,description:"",name:"wrappedComponentRef",required:!1,type:{name:"Ref<TokenPage>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/containers/token/token-insights.tsx#tokeninsights"]={docgenInfo:tokeninsights.__docgenInfo,name:"tokeninsights",path:"src/containers/token/token-insights.tsx#tokeninsights"})}catch(e){}},919:function(e,t,n){"use strict";n.r(t);var a,r=n(1),o=(n(905),n(4)),i=n(596),c=n(172),s=n(597),l=n(353),u=n(67),p=n(600),d=n(115),m=n(92),f=n(398),h=n(400),E=n(379),y=n(399),b=n(167),g=n(71),v=n(435),S=n(97),_=n(119),C=n(120),w=n(30),R=n(35),k=n(13),O=n(26),I=n(117),N=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),P=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function c(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((a=a.apply(e,t||[])).next())}))},T=function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},x=function(e){function t(t){var n=e.call(this,t)||this,a=R.a.parseParamString(t.location.search,["page","page_size"]);return a.page_size||(a.page_size=10),a.sort||(a.sort="-pulp_created"),a.repository||(a.repository="staging"),n.state={versions:void 0,itemCount:0,params:a,loading:!0,updatingVersions:[],redirect:void 0,alerts:[]},n}return N(t,e),t.prototype.componentDidMount=function(){this.context.user&&this.context.user.model_permissions.move_collection?this.queryCollections():this.setState({redirect:k.a.notFound})},t.prototype.render=function(){var e=this,t=this.state,n=t.versions,a=t.params,o=t.itemCount,c=t.loading,s=t.redirect;return s?r.createElement(i.a,{to:s}):n?r.createElement(r.Fragment,null,r.createElement(l.e,{title:"Approval dashboard"}),r.createElement(l.c,{alerts:this.state.alerts,closeAlert:function(t){return e.closeAlert(t)}}),r.createElement(l.w,{className:"certification-dashboard"},r.createElement(u.Section,{className:"body"},r.createElement("div",{className:"toolbar"},r.createElement(p.a,null,r.createElement(d.a,null,r.createElement(m.a,null,r.createElement(l.n,{updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},params:a,filterConfig:[{id:"namespace",title:"Namespace"},{id:"name",title:"Collection Name"},{id:"repository",title:"Repository",inputType:"select",options:[{id:O.a.NOTCERTIFIED,title:"Rejected"},{id:O.a.NEEDSREVIEW,title:"Needs Review"},{id:O.a.PUBLISHED,title:"Approved"}]}]})))),r.createElement(l.C,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},count:o,isTop:!0})),r.createElement("div",null,r.createElement(l.d,{updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},params:a,ignoredParams:["page_size","page","sort"]})),c?r.createElement(l.s,null):this.renderTable(n,a),r.createElement("div",{className:"footer"},r.createElement(l.C,{params:a,updateParams:function(t){return e.updateParams(t,(function(){return e.queryCollections()}))},count:o}))))):r.createElement(l.t,null)},t.prototype.renderTable=function(e,t){var n=this;if(0===e.length)return r.createElement(f.a,{className:"empty",variant:f.b.full},r.createElement(h.a,{icon:v.a}),r.createElement(E.a,{headingLevel:"h2",size:"lg"},"No matches"),r.createElement(y.a,null,"Please try adjusting your search query."));return r.createElement("table",{"aria-label":"Collection versions",className:"content-table pf-c-table"},r.createElement(l.J,{options:{headers:[{title:"Namespace",type:"alpha",id:"namespace"},{title:"Collection",type:"alpha",id:"collection"},{title:"Version",type:"number",id:"version"},{title:"Date created",type:"number",id:"pulp_created"},{title:"Status",type:"none",id:"status"},{title:"",type:"none",id:"certify"}]},params:t,updateParams:function(e){return n.updateParams(e,(function(){return n.queryCollections()}))}}),r.createElement("tbody",null,e.map((function(e,t){return n.renderRow(e,t)}))))},t.prototype.renderStatus=function(e){return this.state.updatingVersions.includes(e)?r.createElement("span",{className:"fa fa-lg fa-spin fa-spinner"}):e.repository_list.includes(O.a.PUBLISHED)?r.createElement("span",null,r.createElement(S.a,{style:{color:"var(--pf-global--success-color--100)"}})," ","Approved"):e.repository_list.includes(O.a.NOTCERTIFIED)?r.createElement("span",null,r.createElement(_.a,{style:{color:"var(--pf-global--danger-color--100)"}})," ","Rejected"):e.repository_list.includes(O.a.NEEDSREVIEW)?r.createElement("span",null,r.createElement(C.a,{style:{color:"var(--pf-global--info-color--100)"}})," ","Needs Review"):void 0},t.prototype.renderRow=function(e,t){return r.createElement("tr",{"aria-labelledby":e.namespace+"."+e.name+" v"+e.version,key:t},r.createElement("td",null,e.namespace),r.createElement("td",null,e.name),r.createElement("td",null,r.createElement(c.a,{to:Object(k.b)(k.a.collectionByRepo,{namespace:e.namespace,collection:e.name,repo:e.repository_list[0]},{version:e.version})},e.version)),r.createElement("td",null,o(e.created_at).fromNow()),r.createElement("td",null,this.renderStatus(e)),r.createElement("td",null,r.createElement("div",{className:"control-column"},r.createElement("div",null,this.renderButtons(e)))))},t.prototype.renderButtons=function(e){var t=this;if(!this.state.updatingVersions.includes(e)){var n=r.createElement(b.a,{key:"imports",component:r.createElement(c.a,{to:Object(k.b)(k.a.myImports,{},{namespace:e.namespace,name:e.name,version:e.version})},"View Import Logs")}),a=function(n,a){return r.createElement(b.a,{onClick:function(){return t.updateCertification(e,a,O.a.PUBLISHED)},isDisabled:n,key:"certify"},"Approve")},o=function(n,a){return r.createElement(b.a,{onClick:function(){return t.updateCertification(e,a,O.a.NOTCERTIFIED)},isDisabled:n,className:"rejected-icon",key:"reject"},"Reject")};return e.repository_list.includes(O.a.PUBLISHED)?r.createElement("span",null,r.createElement(l.K,{items:[a(!0,O.a.PUBLISHED),o(!1,O.a.PUBLISHED),n]})):e.repository_list.includes(O.a.NOTCERTIFIED)?r.createElement("span",null,r.createElement(l.K,{items:[a(!1,O.a.NOTCERTIFIED),o(!0,O.a.NOTCERTIFIED),n]})):e.repository_list.includes(O.a.NEEDSREVIEW)?r.createElement("span",null,r.createElement(g.a,{onClick:function(){return t.updateCertification(e,O.a.NEEDSREVIEW,O.a.PUBLISHED)}},r.createElement("span",null,"Approve")),r.createElement(l.K,{items:[o(!1,O.a.NEEDSREVIEW),n]})):void 0}},t.prototype.updateCertification=function(e,t,n){var a=this;this.setState({updatingVersions:[]},(function(){return w.c.setRepository(e.namespace,e.name,e.version,t,n).then((function(t){a.setState({updatingVersions:[e]}),a.waitForUpdate(t.data.remove_task_id,e)})).catch((function(t){a.setState({updatingVersions:[],alerts:a.state.alerts.concat({variant:"danger",title:"API Error: "+t.response.status,description:"Could not update the certification status for "+e.namespace+"."+e.name+"."+e.version+"."})})}))}))},t.prototype.waitForUpdate=function(e,t){var n=this,a=e;return w.m.get(a).then((function(e){return P(n,void 0,void 0,(function(){var n=this;return T(this,(function(r){switch(r.label){case 0:return"waiting"!==e.data.state&&"running"!==e.data.state?[3,2]:[4,new Promise((function(e){return setTimeout(e,500)}))];case 1:return r.sent(),this.waitForUpdate(a,t),[3,3];case 2:if("completed"===e.data.state)return[2,w.c.list(this.state.params).then((function(e){return P(n,void 0,void 0,(function(){return T(this,(function(t){return this.setState({versions:e.data.data,updatingVersions:[]}),[2]}))}))}))];this.setState({updatingVersions:[],alerts:this.state.alerts.concat({variant:"danger",title:"API Error: 500",description:"Could not update the certification status for "+t.namespace+"."+t.name+"."+t.version+"."})}),r.label=3;case 3:return[2]}}))}))}))},t.prototype.queryCollections=function(){var e=this;this.setState({loading:!0},(function(){return w.c.list(e.state.params).then((function(t){e.setState({versions:t.data.data,itemCount:t.data.meta.count,loading:!1,updatingVersions:[]})}))}))},Object.defineProperty(t.prototype,"updateParams",{get:function(){return R.a.updateParamsMixin()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"closeAlert",{get:function(){return Object(l.R)("alerts")},enumerable:!1,configurable:!0}),t}(r.Component);t.default=Object(s.a)(x),x.contextType=I.a;try{certificationdashboard.displayName="certificationdashboard",certificationdashboard.__docgenInfo={description:"",displayName:"certificationdashboard",props:{wrappedComponentRef:{defaultValue:null,description:"",name:"wrappedComponentRef",required:!1,type:{name:"Ref<CertificationDashboard>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/containers/certification-dashboard/certification-dashboard.tsx#certificationdashboard"]={docgenInfo:certificationdashboard.__docgenInfo,name:"certificationdashboard",path:"src/containers/certification-dashboard/certification-dashboard.tsx#certificationdashboard"})}catch(e){}}}]);
//# sourceMappingURL=settings.js.map