"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[809],{98809:(e,t,n)=>{n.r(t),n.d(t,{Repository:()=>M,default:()=>_});var o=n(97326),r=n(79340),a=n(82963),s=n(61120),i=n(4942),c=n(43144),u=n(15671),l=n(13855),m=n(35356),d=n(92950),f=n(62012),h=n(93450),p=n(87150),g=n(42807),E=n(61542),b=n(61647),y=n(7424);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=(0,c.Z)((function e(){(0,u.Z)(this,e)})),P=function(e){(0,r.Z)(v,e);var t,n,E=(t=v,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,s.Z)(t);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,a.Z)(this,e)});function v(e){var t;(0,u.Z)(this,v),t=E.call(this,e),(0,i.Z)((0,o.Z)(t),"nonQueryStringParams",["repository"]),(0,i.Z)((0,o.Z)(t),"selectRemoteToEdit",(function(e){t.unModifiedRemote=O({},e),t.setState({remoteToEdit:O({},e),showRemoteFormModal:!0})})),(0,i.Z)((0,o.Z)(t),"refreshContent",(function(){t.loadContent(!1)})),(0,i.Z)((0,o.Z)(t),"loadContent",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=t.state.params;t.setState({loading:e},(function(){if("remote"==n.tab)h.eU.list(y.q6.getReduced(n,t.nonQueryStringParams)).then((function(e){t.setState({loading:!1,content:e.data.data,itemCount:e.data.meta.count})}));else{var e=h.Pt;"insights"===g.g.INSIGHTS_DEPLOYMENT_MODE&&(e=h.g9),e.list().then((function(e){t.setState({loading:!1,content:e.data.data,itemCount:e.data.meta.count})}))}}))}));var n=y.q6.parseParamString(e.location.search,["page","page_size"]);return n.page_size||(n.page_size=10),n.tab||(n.tab="local"),n.tab||"insights"!==g.g.STANDALONE_DEPLOYMENT_MODE||(n.tab="local"),t.state={itemCount:1,params:n,loading:!1,showRemoteFormModal:!1,content:[],remoteToEdit:void 0,errorMessages:{},unauthorised:!1},t}return(0,c.Z)(v,[{key:"componentDidMount",value:function(){!this.context.user||this.context.user.is_anonymous?this.setState({unauthorised:!0,loading:!1}):this.loadContent()}},{key:"render",value:function(){var e=this,t=this.state,n=t.params,o=t.loading,r=t.content,a=t.remoteToEdit,s=t.showRemoteFormModal,i=t.errorMessages,c=t.unauthorised,u=[{id:"local",name:l.ag._("Local")},{id:"remote",name:l.ag._("Remote")}];return d.createElement(d.Fragment,null,a&&s&&d.createElement(p.bi,{remote:a,updateRemote:function(t){return e.setState({remoteToEdit:t})},saveRemote:function(){var t=e.state.remoteToEdit;try{var n=t.repositories[0].distributions[0].base_path;h.eU.smartUpdate(n,t,e.unModifiedRemote).then((function(){e.setState({errorMessages:{},showRemoteFormModal:!1,remoteToEdit:void 0},(function(){return e.loadContent()}))})).catch((function(t){return e.setState({errorMessages:(0,y.TQ)(t)})}))}catch(t){e.setState({errorMessages:{__nofield:l.ag._("Can't update remote without a distribution attached to it.")}})}},errorMessages:i,showModal:s,closeModal:function(){return e.setState({showRemoteFormModal:!1,errorMessages:{}})}}),d.createElement(p.UP,{title:l.ag._("Repo Management"),pageControls:this.renderControls()},"insights"!==g.g.STANDALONE_DEPLOYMENT_MODE||o||c?null:d.createElement("div",{className:"header-bottom"},d.createElement("div",{className:"hub-tab-link-container"},d.createElement("div",{className:"tabs"},d.createElement(p.mQ,{tabs:u,params:n,updateParams:function(t){e.setState({content:[]},(function(){return e.updateParams(t,(function(){return e.loadContent()}))}))}}))))),o?d.createElement(p.AW,null):c?d.createElement(p.iA,null):this.renderContent(n,r))}},{key:"renderContent",value:function(e,t){var n=this,o=this.context.user;return"insights"===g.g.INSIGHTS_DEPLOYMENT_MODE||e.tab&&"local"===e.tab.toLowerCase()?d.createElement(p.or,{className:"repository-list"},d.createElement("section",{className:"body"},d.createElement(p.j8,{repositories:t,updateParams:this.updateParams}))):e.tab&&"remote"===e.tab.toLowerCase()?0===t.length?d.createElement(p.vv,{title:l.ag._("No remote repositories yet"),description:l.ag._("Remote repositories will appear once added")}):d.createElement(p.or,{className:"repository-list"},d.createElement("section",{className:"body"},d.createElement(p.UK,{remotes:t,updateParams:this.updateParams,editRemote:function(e){return n.selectRemoteToEdit(e)},syncRemote:function(e){return h.eU.sync(e).then((function(){return n.loadContent()}))},user:o,refreshRemotes:this.refreshContent}))):void 0}},{key:"renderControls",value:function(){if("local"==this.state.params.tab)return d.createElement(m.ToolbarItem,null,d.createElement(f.Link,{to:(0,b.dI)(b.nB.token)},d.createElement(m.Button,null,l.ag._("Get token"))))}},{key:"updateParams",get:function(){return y.q6.updateParamsMixin(this.nonQueryStringParams)}}]),v}(d.Component);const _=(0,y.EN)(P);P.contextType=E.I}}]);
//# sourceMappingURL=../sourcemaps/809.65e8d93467108d75b57a922f03136614.js.map