"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[7545],{57545:(e,r,t)=>{t.r(r),t.d(r,{default:()=>y});var n=t(44925),o=t(4942),i=t(13855),a=t(92950),s=t.n(a),l=t(45586),u=t(41315),c=t(61647),p=t(6640),d=t(92518),f=["name"];function _(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?_(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var b={name:"",description:"",retain_repo_versions:1,pulp_labels:{},remote:null};const y=(0,u.T3)({breadcrumbs:function(e){var r=e.name;return[{url:(0,c.dI)(c.nB.ansibleRepositories),name:i.ag._("Repositories")},r&&{url:(0,c.dI)(c.nB.ansibleRepositoryDetail,{name:r}),name:r},r?{name:i.ag._("Edit")}:{name:i.ag._("Add")}].filter(Boolean)},condition:function(e,r){return(0,p.zN)(e)||(0,p.lo)(e,r)},displayName:"AnsibleRepositoryEdit",errorTitle:i.ag._("Repository could not be displayed."),query:function(e){var r=e.name;return l.UX.list({name:r}).then((function(e){return e.data.results[0]})).then((function(e){return l.UX.myPermissions((0,d.LL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch((function(e){return console.error(e),[]})).then((function(r){return m(m({},e),{},{my_permissions:r})}))}))},title:function(e){return e.name||i.ag._("Add new repository")},transformParams:function(e){var r=e.name;return m(m({},(0,n.Z)(e,f)),{},{name:"_"!==r?r:null})},render:function(e,r){var t=r.navigate,n=r.queueAlert,o=r.state,a=r.setState;if(!o.repositoryToEdit){var p=m(m({},b),e);a({repositoryToEdit:p,errorMessages:{}})}var f=o.repositoryToEdit,_=o.errorMessages;return f?s().createElement(u.Vi,{allowEditName:!e,errorMessages:_,onCancel:function(){a({errorMessages:{},repositoryToEdit:void 0}),t(e?(0,c.dI)(c.nB.ansibleRepositoryDetail,{name:e.name}):(0,c.dI)(c.nB.ansibleRepositories))},onSave:function(r){var s=r.createDistribution,u=r.hideFromSearch,p=r.pipeline,f=m({},o.repositoryToEdit);Object.keys(f).forEach((function(e){""===f[e]&&(f[e]=null)})),e&&(delete f.last_sync_task,delete f.last_synced_metadata_time,delete f.latest_version_href,delete f.pulp_created,delete f.pulp_href,delete f.versions_href),f.pulp_labels||(f.pulp_labels={}),u?f.pulp_labels.hide_from_search="":delete f.pulp_labels.hide_from_search,p?f.pulp_labels.pipeline=p:delete f.pulp_labels.pipeline;var _=e?l.UX.update((0,d.LL)(e.pulp_href),f).then((function(r){var t=r.data;return n((0,d.zT)(t,i.ag._("Update started for repository {0}",{0:f.name}))),e.pulp_href})):l.UX.create(f).then((function(e){var r=e.data;return n({variant:"success",title:i.ag._("Successfully created repository {0}",{0:f.name})}),r.pulp_href}));s&&(_=_.then((function(e){return l.Lj.create({name:f.name,base_path:f.name,repository:e})})).then((function(e){var r=e.data;return n((0,d.zT)(r,i.ag._("Creation started for distribution {0}",{0:f.name})))}))),_.then((function(){a({errorMessages:{},repositoryToEdit:void 0}),t((0,c.dI)(c.nB.ansibleRepositoryDetail,{name:f.name}))})).catch((function(e){var r=e.response.data;return a({errorMessages:m({__nofield:r.non_field_errors||r.detail},r)})}))},repository:f,updateRepository:function(e){return a({repositoryToEdit:e})}}):null}})},6640:(e,r,t)=>{t.d(r,{DQ:()=>s,MT:()=>l,Wt:()=>b,X0:()=>m,Xn:()=>p,fY:()=>_,lo:()=>d,nm:()=>a,rH:()=>i,vn:()=>f,yA:()=>u,zN:()=>c});var n=function(e){return function(r){var t=r.hasPermission,n=r.user;return t(e)||(null==n?void 0:n.is_superuser)}},o=function(e){return function(r,t){var n=r.hasPermission,o=r.hasObjectPermission,i=r.user;return n(e)||(null==o?void 0:o(e,t))||(null==i?void 0:i.is_superuser)}},i=n("ansible.add_collectionremote"),a=o("ansible.delete_collectionremote"),s=o("ansible.change_collectionremote"),l=o("ansible.view_collectionremote"),u=o("ansible.manage_roles_collectionremote"),c=n("ansible.add_ansiblerepository"),p=o("ansible.delete_ansiblerepository"),d=o("ansible.change_ansiblerepository"),f=d,_=function(e){var r=e.user;return r&&!r.is_anonymous},m=o("ansible.manage_roles_ansiblerepository"),b=d}}]);
//# sourceMappingURL=../sourcemaps/7545.d0433045bb28f7b8c6f9138514d93220.js.map