"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[1256],{41256:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var a=n(60888),l=n(87088),r=n(92920),i=n(42232),s=n(76184),c=n(36884),o=n(58816),u=n(72956),m=n(77104),d=n(82080),p=n(43548),E=n(18232),_=n.n(E),h=n(50708),k=n(59072),f=n(49368),g=n(47580),D=n(32004),L=n(58860);function v(e,t,n){return t=(0,s.c)(t),(0,i.c)(e,T()?Reflect.construct(t,n||[],(0,s.c)(e).constructor):t.apply(e,n))}function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(T=function(){return!!e})()}var b=function(e){return g.M.TASK_NAMES[e]&&u._s._(g.M.TASK_NAMES[e])||e},y=function(e){function t(e){var n;return(0,l.c)(this,t),(n=v(this,t,[e])).state={loading:!0,task:null,parentTask:null,childTasks:[],alerts:[],cancelModalVisible:!1,taskName:"",resources:[],redirect:null,polling:null},n}return(0,c.c)(t,e),(0,r.c)(t,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"componentWillUnmount",value:function(){this.state.polling&&clearInterval(this.state.polling)}},{key:"componentDidUpdate",value:function(e){e.routeParams.task!==this.props.routeParams.task&&(this.setState({loading:!0}),this.loadContent())}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.task,l=t.parentTask,r=t.childTasks,i=t.cancelModalVisible,s=t.alerts,c=t.taskName,o=t.resources,E=t.redirect,k=[{url:(0,D.oD)(D.uk.taskList),name:u._s._({id:"JET7Si"})},{name:a?c:""}],g=null;return l&&(g=(0,L.oL)(l.pulp_href)),E?_().createElement(h.Navigate,{to:E}):n?_().createElement(f.cI,null):_().createElement(_().Fragment,null,_().createElement(f.WW,{alerts:s,closeAlert:function(t){return e.closeAlert(t)}}),i?this.renderCancelModal():null,_().createElement(f.wy,{title:c,breadcrumbs:_().createElement(f.MF,{links:k}),pageControls:["running","waiting"].includes(a.state)&&_().createElement(m.Button,{variant:"secondary",onClick:function(){return e.setState({cancelModalVisible:!0})}},u._s._({id:"iNUMdZ"})),status:_().createElement(f.CO,{className:"hub-c-task-status",status:a.state})}),_().createElement(f.GK,null,_().createElement(m.Flex,null,_().createElement(m.Flex,{direction:{default:"column"},flex:{default:"flex_1"}},_().createElement(m.FlexItem,null,_().createElement("section",{className:"body card-area"},_().createElement(m.Title,{headingLevel:"h2",size:"lg"},u._s._({id:"fqgZ6m"})),_().createElement("br",null),_().createElement(m.DescriptionList,{isHorizontal:!0},_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"ogBUiv"})),_().createElement(m.DescriptionListDescription,null,a.name)),a.name!==c&&_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"2Yhrad"})),_().createElement(m.DescriptionListDescription,null,c)),_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"IiN/kH"})),_().createElement(m.DescriptionListDescription,null,_().createElement(f.i4,{date:a.finished_at}))),_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"45O6zJ"})),_().createElement(m.DescriptionListDescription,null,_().createElement(f.i4,{date:a.pulp_created})))))),_().createElement(m.FlexItem,null,_().createElement("section",{className:"body card-area"},_().createElement(m.Title,{headingLevel:"h2",size:"lg"},u._s._({id:"j0dOoV"})),_().createElement("br",null),_().createElement(m.DescriptionList,{isHorizontal:!0},_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"In9f9E"})),_().createElement(m.DescriptionListDescription,null,a.task_group?a.task_group:u._s._({id:"0t88cp"}))),_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"ggsFl6"})),_().createElement(m.DescriptionListDescription,null,l?_().createElement(h.Link,{to:(0,D.oD)(D.uk.taskDetail,{task:g})},b(l.name)):u._s._({id:"TInr2q"}))),_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"dKlcTI"})),_().createElement(m.DescriptionListDescription,null,r.length?r.map((function(e){var t=(0,L.oL)(e.pulp_href);return _().createElement(_().Fragment,{key:t},_().createElement(h.Link,{to:(0,D.oD)(D.uk.taskDetail,{task:t})},b(e.name)),_().createElement("br",null))})):u._s._({id:"59KJyD"})))))),_().createElement(m.FlexItem,null,_().createElement("section",{className:"body card-area"},_().createElement(m.Title,{headingLevel:"h2",size:"lg"},u._s._({id:"7Ackjt"})),_().createElement("br",null),o.length?_().createElement(m.DescriptionList,{isHorizontal:!0},o.map((function(e,t){return _().createElement(_().Fragment,{key:e.type+t},_().createElement("hr",null),_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"+zy2Nq"})),_().createElement(m.DescriptionListDescription,null,e.type)),e.pluginName&&_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"fOuPPd"})),_().createElement(m.DescriptionListDescription,null,e.pluginName)),e.name&&_().createElement(m.DescriptionListGroup,null,_().createElement(m.DescriptionListTerm,null,u._s._({id:"6YtxFj"})),_().createElement(m.DescriptionListDescription,null,e.name)))}))):u._s._({id:"CJcaCv"})))),_().createElement(m.Flex,{direction:{default:"column"},flex:{default:"flex_1"}},_().createElement(m.FlexItem,null,!a.error&&_().createElement("section",{className:"body card-area"},_().createElement(m.Title,{headingLevel:"h2",size:"lg"},u._s._({id:"IsjXnX"})),_().createElement("br",null),a.progress_reports.length?_().createElement(m.DescriptionList,{isHorizontal:!0},a.progress_reports.reverse().map((function(e,t){return _().createElement(_().Fragment,{key:t},_().createElement("hr",null),Object.keys(e).map((function(t,n){return!!e[t]&&_().createElement(m.DescriptionListGroup,{key:t+n},_().createElement(m.DescriptionListTerm,null,{message:u._s._({id:"xDAtGP"}),code:u._s._({id:"EWPtMO"}),state:u._s._({id:"RS0o7b"}),done:u._s._({id:"DPfwMq"})}[t]||(0,p.capitalize)(t)),_().createElement(m.DescriptionListDescription,null,e[t]))}))," ")}))):_().createElement(f.uU,{icon:d.cp,title:u._s._({id:"orUwNA"}),description:u._s._({id:"orUwNA"})})),!!a.error&&_().createElement("section",{className:"body card-area"},_().createElement(m.Title,{headingLevel:"h2",size:"lg"},u._s._({id:"xi4nE2"})),_().createElement("br",null),_().createElement(_().Fragment,null,_().createElement(m.Title,{headingLevel:"h3"},u._s._({id:"Nu4oKW"})),_().createElement(m.CodeBlock,null,a.error.description),_().createElement(m.Title,{headingLevel:"h3"},u._s._({id:"g3fe3D"})),_().createElement(m.CodeBlock,{className:"hub-code-block"},a.error.traceback))))))))}},{key:"renderCancelModal",value:function(){var e=this,t=this.state.taskName;return _().createElement(f.GO,{cancelAction:function(){return e.setState({cancelModalVisible:!1})},confirmAction:function(){return e.cancelTask()},title:u._s._({id:"iNUMdZ"}),confirmButtonTitle:u._s._({id:"gspY5b"})},u._s._({id:"NBEgeZ",values:{name:t}}))}},{key:"cancelTask",value:function(){var e=this,t=this.state,n=t.task,l=t.taskName;k.SQ.patch((0,L.oL)(n.pulp_href),{state:"canceled"}).then((function(){e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.c)(e.state.alerts),[{variant:"success",title:l,description:_().createElement(o.mk,{id:"xnof66",values:{taskName:l}})}])}),e.loadContent()})).catch((function(t){var n=t.response,r=n.status,i=n.statusText;e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.c)(e.state.alerts),[{variant:"danger",title:u._s._({id:"M2gqxI",values:{taskName:l}}),description:(0,L._A)(r,i)}])}),e.loadContent()}))}},{key:"loadContent",value:function(){var e=this;this.state.polling||this.state.task||this.setState({polling:setInterval((function(){return e.loadContent()}),1e4)});var t=this.props.routeParams.task;return k.SQ.get(t).then((function(t){var n=[],a=null,l=[],r=[];if(["canceled","completed","failed"].includes(t.data.state)&&(clearInterval(e.state.polling),e.setState({polling:null})),t.data.parent_task){var i=(0,L.oL)(t.data.parent_task);n.push(k.SQ.get(i).then((function(e){a=e.data})).catch((function(){return!0})))}return t.data.child_tasks.length&&t.data.child_tasks.forEach((function(e){var t=(0,L.oL)(e);n.push(k.SQ.get(t).then((function(e){l.push(e.data)})).catch((function(){return!0})))})),t.data.reserved_resources_record.length&&t.data.reserved_resources_record.forEach((function(e){var t=e.replace("/api/automation-hub/pulp/api/v3/",""),a=(0,L.oL)(t),l=t.split("/"),i="",s="";l.length>=3?(i="".concat(l[0],": ").concat(l[2]),s=l[1]):e=l[0],a?n.push(k.MT.get(t).then((function(e){r.push({name:e.data.name,type:i,pluginName:s})})).catch((function(){return!0}))):r.push({type:i})})),Promise.all(n).then((function(){e.setState({task:t.data,childTasks:l,parentTask:a,loading:!1,taskName:b(t.data.name),resources:r})}))})).catch((function(){e.setState({redirect:(0,D.oD)(D.uk.notFound)})}))}},{key:"closeAlert",get:function(){return(0,f.Yi)("alerts")}}]),t}(_().Component);const N=(0,L.Ak)(y)}}]);
//# sourceMappingURL=../sourcemaps/1256.a6c6c516bc535ec56d4be3d5cdd826d5.js.map