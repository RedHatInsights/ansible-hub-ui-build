"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[6176],{36176:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var a=n(4942),r=n(13855),o=n(92950),l=n.n(o),u=n(61811),i=n(45586),c=n(41315),s=n(61647),d=n(6640),m=n(92518),p=n(70885);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){u=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(u)throw o}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var v=function(e){var t=e.item,n=e.actionContext,a=n.addAlert,u=n.state.params,b=n.hasPermission,v=n.user,g=(null==t?void 0:t.pulp_href)&&(0,m.LL)(t.pulp_href),h=(0,o.useState)(null==t?void 0:t.name),y=(0,p.Z)(h,2),_=y[0],R=y[1],w=(0,o.useState)(null),S=(0,p.Z)(w,2),O=S[0],C=S[1],G=(0,o.useState)(!1),E=(0,p.Z)(G,2),P=E[0],j=E[1],k=(0,o.useState)(null),A=(0,p.Z)(k,2),x=A[0],D=A[1],T=(0,o.useState)(null),M=(0,p.Z)(T,2),U=M[0],Z=M[1],B=(0,o.useState)(null),I=(0,p.Z)(B,2),L=I[0],W=I[1],F=(0,o.useState)(null),N=(0,p.Z)(F,2),z=N[0],q=N[1],H=(0,o.useState)(null),J=(0,p.Z)(H,2),K=J[0],Y=J[1],$=function(){C(null),i.GC.myPermissions(g).then((function(e){var t=e.data.permissions;j((0,d.yA)({hasPermission:b,hasObjectPermission:function(e){return t.includes(e)},user:v})),i.GC.listRoles(g).then((function(e){var t,n=e.data.roles,a=[],r=f(n);try{for(r.s();!(t=r.n()).done;){var o,l=t.value,u=l.groups,i=l.role,c=f(u);try{var s=function(){var e=o.value,t=a.findIndex((function(t){return t.name===e}));-1==t?a.push({name:e,object_roles:[i]}):a[t].object_roles.push(i)};for(c.s();!(o=c.n()).done;)s()}catch(e){c.e(e)}finally{c.f()}}}catch(e){r.e(e)}finally{r.f()}R(_),C(a)})).catch((function(){C([])}))})).catch((function(){C([]),j(!1)}))},Q=function(e){var t=e.roles,n=e.alertSuccess,r=e.alertFailure,o=e.stateUpdate;Promise.all(t).then((function(){a({title:n,variant:"success"}),$()})).catch((function(e){var t=e.response,n=t.status,o=t.statusText;a({title:r,variant:"danger",description:(0,m.N3)(n,o)})})).finally((function(){V(o)}))},V=function(e){Object.entries(e).forEach((function(e){var t=(0,p.Z)(e,2),n=t[0],a=t[1];switch(n){case"showGroupRemoveModal":Z(a);break;case"showGroupSelectWizard":W(a);break;case"showRoleRemoveModal":q(a);break;case"showRoleSelectWizard":Y(a);break;default:console.error("updateProps",n,a)}}))};return(0,o.useEffect)($,[t.pulp_href]),(0,o.useEffect)((function(){O&&(null!=u&&u.group?i.lO.list({name:u.group}).then((function(e){var t=e.data.data;D(O.find((function(e){return e.name===t[0].name})))})):D(null))}),[null==u?void 0:u.group,O]),l().createElement(c.yW,{addGroup:function(e,t){var n=t.map((function(t){return i.GC.addRole(g,{role:t.name,groups:[e.name]})}));Q({roles:n,alertSuccess:r.ag._('Group "{0}" has been successfully added to "{name}".',{0:e.name,name:_}),alertFailure:r.ag._('Group "{0}" could not be added to "{name}".',{0:e.name,name:_}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var n=t.map((function(t){return i.GC.addRole(g,{role:t.name,groups:[e.name]})}));Q({roles:n,alertSuccess:r.ag._('Group "{0}" roles successfully updated in "{name}".',{0:e.name,name:_}),alertFailure:r.ag._('Group "{0}" roles could not be update in "{name}".',{0:e.name,name:_}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:P,group:x,groups:O,name:_,pulpObjectType:"remotes/ansible/collection",removeGroup:function(e){var t=e.object_roles.map((function(t){return i.GC.removeRole(g,{role:t,groups:[e.name]})}));Q({roles:t,alertSuccess:r.ag._('Group "{0}" has been successfully removed from "{name}".',{0:e.name,name:_}),alertFailure:r.ag._('Group "{0}" could not be removed from "{name}".',{0:e.name,name:_}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var n=i.GC.removeRole(g,{role:e,groups:[t.name]});Q({roles:[n],alertSuccess:r.ag._('Group "{0}" roles successfully updated in "{name}".',{0:t.name,name:_}),alertFailure:r.ag._('Group "{0}" roles could not be update in "{name}".',{0:t.name,name:_}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:r.ag._("The selected roles will be added to this specific Ansible remote."),showGroupRemoveModal:U,showGroupSelectWizard:L,showRoleRemoveModal:z,showRoleSelectWizard:K,updateProps:V,urlPrefix:(0,s.dI)(s.nB.ansibleRemoteDetail,{name:_})})},g=n(35356),h=function(e){var t=e.code,n=l().useState(!1),a=(0,p.Z)(n,2),o=a[0],u=a[1],i=l().createElement(l().Fragment,null,l().createElement(g.CodeBlockAction,null,l().createElement(g.ClipboardCopyButton,{id:"basic-copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:function(e){return function(e,t){navigator.clipboard.writeText(t.toString())}(0,t),void u(!0)},exitDelay:o?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:function(){return u(!1)}},o?r.ag._("Successfully copied to clipboard"):r.ag._("Copy to clipboard"))));return l().createElement(g.CodeBlock,{actions:i},l().createElement(g.CodeBlockCode,{id:"code-content"},t))},y=function(e){var t=e.code;return t?l().createElement(h,{code:t}):l().createElement(l().Fragment,null,r.ag._("None"))},_=function(e){var t,n,a=e.item;return l().createElement(c.PO,{fields:[{label:r.ag._("Remote name"),value:null==a?void 0:a.name},{label:r.ag._("URL"),value:l().createElement(c.TO,{url:null==a?void 0:a.url,fallback:!0})},{label:r.ag._("Proxy URL"),value:l().createElement(c.TO,{url:null==a?void 0:a.proxy_url,fallback:!0})},{label:r.ag._("TLS validation"),value:null!=a&&a.tls_validation?r.ag._("Enabled"):r.ag._("Disabled")},{label:r.ag._("Client certificate"),value:(null==a?void 0:a.client_cert)||r.ag._("None")},{label:r.ag._("CA certificate"),value:(null==a?void 0:a.ca_cert)||r.ag._("None")},{label:r.ag._("Download concurrency"),value:null!==(t=null==a?void 0:a.download_concurrency)&&void 0!==t?t:r.ag._("None")},{label:r.ag._("Rate limit"),value:null!==(n=null==a?void 0:a.rate_limit)&&void 0!==n?n:r.ag._("None")},{label:r.ag._("Repositories"),value:l().createElement(c.oK,{remoteHref:null==a?void 0:a.pulp_href})},{label:r.ag._("YAML requirements"),value:l().createElement(y,{code:null==a?void 0:a.requirements_file})}]})};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=[{id:"details",name:r.ag._("Details")},{id:"access",name:r.ag._("Access")}];const O=(0,c.L9)({breadcrumbs:function(e){var t=e.name,n=e.tab,a=e.params.group;return[{url:(0,s.dI)(s.nB.ansibleRemotes),name:r.ag._("Remotes")},{url:(0,s.dI)(s.nB.ansibleRemoteDetail,{name:t}),name:t},"access"===n.id&&a?{url:(0,s.dI)(s.nB.ansibleRepositoryDetail,{name:t},{tab:n.id}),name:n.name}:null,"access"===n.id&&a?{name:r.ag._("Group {group}",{group:a})}:{name:n.name}].filter(Boolean)},condition:d.MT,displayName:"AnsibleRemoteDetail",errorTitle:r.ag._("Remote could not be displayed."),headerActions:[u.JJ,u.Rq,u.MC,u.PU,u.bU],query:function(e){var t=e.name;return i.GC.list({name:t}).then((function(e){return e.data.results[0]})).then((function(e){return e?i.GC.myPermissions((0,m.LL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch((function(e){return console.error(e),[]})).then((function(t){return w(w({},e),{},{my_permissions:t})})):Promise.reject({response:{status:404}})}))},renderTab:function(e,t,n){return{details:l().createElement(_,{item:t,actionContext:n}),access:l().createElement(v,{item:t,actionContext:n})}[e]},tabs:S,tabUpdateParams:function(e){return delete e.group,e}})}}]);
//# sourceMappingURL=../sourcemaps/6176.88034667fd450fdfb5000bc87b2cc3af.js.map