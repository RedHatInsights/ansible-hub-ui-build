"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[8118],{48118:(e,t,r)=>{r.r(t),r.d(t,{default:()=>B});var n=r(4942),a=r(70885),o=r(14744),i=r(13855),l=r(92950),s=r.n(l),u=r(61811),c=r(45586),p=r(14057),m=r(61647),d=r(6640),f=r(92518);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,o=r.featureFlags,u=r.hasPermission,b=r.state.params,y=r.user,g=(null==t?void 0:t.pulp_href)&&(0,f.LL)(t.pulp_href),h=(0,l.useState)(null==t?void 0:t.name),_=(0,a.Z)(h,2),O=_[0],E=_[1],P=(0,l.useState)(null),w=(0,a.Z)(P,2),j=w[0],R=w[1],S=(0,l.useState)(!1),D=(0,a.Z)(S,2),C=D[0],Z=D[1],k=(0,l.useState)(null),U=(0,a.Z)(k,2),A=U[0],I=U[1],L=(0,l.useState)(null),N=(0,a.Z)(L,2),x=N[0],T=N[1],G=(0,l.useState)(null),B=(0,a.Z)(G,2),V=B[0],F=B[1],q=(0,l.useState)(null),X=(0,a.Z)(q,2),z=X[0],W=X[1],M=(0,l.useState)(null),H=(0,a.Z)(M,2),Y=H[0],K=H[1],Q=function(){R(null),c.UX.myPermissions(g).then((function(e){var t=e.data.permissions;Z((0,d.X0)({hasPermission:u,hasObjectPermission:function(e){return t.includes(e)},user:y,featureFlags:o})),c.UX.listRoles(g).then((function(e){var t,r=e.data.roles,n=[],a=v(r);try{for(a.s();!(t=a.n()).done;){var o,i=t.value,l=i.groups,s=i.role,u=v(l);try{var c=function(){var e=o.value,t=n.findIndex((function(t){return t.name===e}));-1==t?n.push({name:e,object_roles:[s]}):n[t].object_roles.push(s)};for(u.s();!(o=u.n()).done;)c()}catch(e){u.e(e)}finally{u.f()}}}catch(e){a.e(e)}finally{a.f()}E(O),R(n)})).catch((function(){R([])}))})).catch((function(){R([]),Z(!1)}))},$=function(e){var t=e.roles,r=e.alertSuccess,a=e.alertFailure,o=e.stateUpdate;Promise.all(t).then((function(){n({title:r,variant:"success"}),Q()})).catch((function(e){var t=e.response,r=t.status,o=t.statusText;n({title:a,variant:"danger",description:(0,f.N3)(r,o)})})).finally((function(){J(o)}))},J=function(e){Object.entries(e).forEach((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];switch(r){case"showGroupRemoveModal":T(n);break;case"showGroupSelectWizard":F(n);break;case"showRoleRemoveModal":W(n);break;case"showRoleSelectWizard":K(n);break;default:console.error("updateProps",r,n)}}))};return(0,l.useEffect)(Q,[t.pulp_href]),(0,l.useEffect)((function(){j&&(null!=b&&b.group?c.lO.list({name:b.group}).then((function(e){var t=e.data.data;I(j.find((function(e){return e.name===t[0].name})))})):I(null))}),[null==b?void 0:b.group,j]),s().createElement(p.yW,{addGroup:function(e,t){var r=t.map((function(t){return c.UX.addRole(g,{role:t.name,groups:[e.name]})}));$({roles:r,alertSuccess:i.ag._('Group "{0}" has been successfully added to "{name}".',{0:e.name,name:O}),alertFailure:i.ag._('Group "{0}" could not be added to "{name}".',{0:e.name,name:O}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var r=t.map((function(t){return c.UX.addRole(g,{role:t.name,groups:[e.name]})}));$({roles:r,alertSuccess:i.ag._('Group "{0}" roles successfully updated in "{name}".',{0:e.name,name:O}),alertFailure:i.ag._('Group "{0}" roles could not be update in "{name}".',{0:e.name,name:O}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:C,group:A,groups:j,name:O,pulpObjectType:"repositories/ansible/ansible",removeGroup:function(e){var t=e.object_roles.map((function(t){return c.UX.removeRole(g,{role:t,groups:[e.name]})}));$({roles:t,alertSuccess:i.ag._('Group "{0}" has been successfully removed from "{name}".',{0:e.name,name:O}),alertFailure:i.ag._('Group "{0}" could not be removed from "{name}".',{0:e.name,name:O}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var r=c.UX.removeRole(g,{role:e,groups:[t.name]});$({roles:[r],alertSuccess:i.ag._('Group "{0}" roles successfully updated in "{name}".',{0:t.name,name:O}),alertFailure:i.ag._('Group "{0}" roles could not be update in "{name}".',{0:t.name,name:O}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:i.ag._("The selected roles will be added to this specific Ansible repository."),showGroupRemoveModal:x,showGroupSelectWizard:V,showRoleRemoveModal:z,showRoleSelectWizard:Y,updateProps:J,urlPrefix:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:O})})},g=r(62012);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=function(e){var t=e.item,r=e.actionContext,n=r.addAlert,o=r.hasPermission,d=function(e){var r=_({},e.params);r.ordering=r.sort,delete r.sort;var n=(0,f.LL)(t.pulp_href);return c.eq.list(_({repository:n},r)).then((function(e){var t=e.data;return{data:{count:t.meta.count,results:t.data}}}))},v=(0,l.useState)({repository:t}),b=(0,a.Z)(v,2),y=b[0],h=b[1];return(0,l.useEffect)((function(){return h((function(e){return _(_({},e),{},{repository:t})}))}),[t]),s().createElement(p.qU,{actionContext:{addAlert:n,state:y,setState:h,query:d,hasPermission:o,hasObjectPermission:function(e){var r,n;return null==t||null===(r=t.my_permissions)||void 0===r||null===(n=r.includes)||void 0===n?void 0:n.call(r,e)}},defaultPageSize:10,defaultSort:"name",errorTitle:i.ag._("Collection versions could not be displayed."),filterConfig:[{id:"keywords",title:i.ag._("Keywords")},{id:"namespace",title:i.ag._("Namespace")}],headerActions:[u.Ub],listItemActions:[u.No],noDataButton:u.Ub.button,noDataDescription:i.ag._("Collection versions will appear once the collection is modified."),noDataTitle:i.ag._("No collection versions yet"),query:d,renderTableRow:function(e,t,r,n){var a=e.collection_version,o=a.name,i=a.namespace,l=a.version,u=a.description,c=e.repository,d=n.map((function(t){return t.dropdownItem(e,r)}));return s().createElement("tr",{key:t},s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.collectionByRepo,{repo:c.name,namespace:i,collection:o},{version:l})},i,".",o," v",l)),s().createElement("td",null,u),s().createElement(p.cT,{kebabItems:d}))},sortHeaders:[{title:i.ag._("Collection"),type:"none",id:"col1"},{title:i.ag._("Description"),type:"none",id:"col2"}],title:i.ag._("Collection versions")})},E=function(e){var t,r,n=e.item,o=(0,l.useState)(null),u=(0,a.Z)(o,2),d=u[0],v=u[1];return(0,l.useEffect)((function(){var e=n.remote&&(0,f.LL)(n.remote);e?c.GC.get(e).then((function(e){var t=e.data;return v(t)})):v(null)}),[n.remote]),s().createElement(p.PO,{fields:[{label:i.ag._("Repository name"),value:null==n?void 0:n.name},{label:i.ag._("Description"),value:(null==n?void 0:n.description)||i.ag._("None")},{label:i.ag._("Retained version count"),value:null!==(t=null==n?void 0:n.retain_repo_versions)&&void 0!==t?t:i.ag._("All")},{label:i.ag._("Distribution"),value:s().createElement(p.QW,{distributions:n.distributions})},{label:i.ag._("Repository URL"),value:null!==(r=n.distributions)&&void 0!==r&&r.length?s().createElement(p.TO,{url:(0,f.hv)(n.distributions[0].base_path)}):"---"},{label:i.ag._("Labels"),value:s().createElement(p.rT,{labels:null==n?void 0:n.pulp_labels})},{label:i.ag._("Private"),value:null!=n&&n.private?i.ag._("Yes"):i.ag._("No")},{label:i.ag._("Remote"),value:d?s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRemoteDetail,{name:d.name})},d.name):i.ag._("None")}]})},P=r(87462),w=r(43144),j=r(15671),R=r(97326),S=r(79340),D=r(82963),C=r(61120),Z=r(35356);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=function(e){var t=e.href,r=e.addAlert,o=e.hasPermission,u=e.repositoryName,d=(0,l.useState)({}),f=(0,a.Z)(d,2),v=f[0],b=f[1];if(!t)return null;var y=function(e){return new(function(t){(0,S.Z)(i,t);var r,a,o=(r=i,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,C.Z)(r);if(a){var n=(0,C.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,D.Z)(this,e)});function i(){var t;(0,j.Z)(this,i);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t=o.call.apply(o,[this].concat(a)),(0,n.Z)((0,R.Z)(t),"useOrdering",!0),(0,n.Z)((0,R.Z)(t),"apiPath",e.replace("/api/automation-hub/pulp/api/v3/","")),t}return(0,w.Z)(i)}(c.jx))}(t),h=function(e){var t=e.params;return y.list(t)};return s().createElement(p.qU,{actionContext:{addAlert:r,state:v,setState:b,query:h,hasPermission:o},defaultPageSize:10,defaultSort:"name",errorTitle:i.ag._("Collection versions could not be displayed."),noDataDescription:i.ag._("No collection versions in this repository version."),noDataTitle:i.ag._("No collection versions yet"),query:h,renderTableRow:function(e){var t=e.manifest.collection_info,r=t.namespace,n=t.name,a=t.version,o=e.description;return s().createElement("tr",null,s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.collectionByRepo,{repo:u,namespace:r,collection:n},{version:a})},r,".",n," v",a)),s().createElement("td",null,o))},sortHeaders:[{title:i.ag._("Collection"),type:"none",id:"col1"},{title:i.ag._("Description"),type:"none",id:"col2"}],title:i.ag._("Collection versions")})},I=function(e){var t=e.data;return Object.keys(t).length?s().createElement("table",{className:"pf-c-table"},s().createElement("tr",null,s().createElement("th",null,i.ag._("Count")),s().createElement("th",null,i.ag._("Pulp type"))),Object.entries(t).map((function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1];return s().createElement("tr",{key:r},s().createElement("td",null,n.count),s().createElement("th",null,r))}))):s().createElement(s().Fragment,null,i.ag._("None"))},L=function(e){var t=e.repositoryName,r=e.data;if(!r)return s().createElement(s().Fragment,null,i.ag._("None"));var n=r.split("/").at(-2);return s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t},{repositoryVersion:n,tab:"repository-versions"})},n)},N=function(e){var t,r,n,o=e.item,d=e.actionContext,v=d.addAlert,b=d.state,y=d.hasPermission,h=d.hasObjectPermission,_=(0,f.LL)(o.pulp_href),O=o.latest_version_href,E=o.name,w=function(e){var t=e.params;return c.UX.listVersions(_,t)},j=(0,l.useState)({}),R=(0,a.Z)(j,2),S=R[0],D=R[1],C=(0,l.useState)(null),k=(0,a.Z)(C,2),N=k[0],x=k[1];return(0,l.useEffect)((function(){var e,t;b.params.repositoryVersion?(e={number:b.params.repositoryVersion},t=e.number,c.UX.listVersions(_,{number:t})).then((function(e){var t,r=e.data;null!=r&&null!==(t=r.results)&&void 0!==t&&t[0]||v({variant:"danger",title:i.ag._("Failed to find repository version")}),x(r.results[0])})):x(null)}),[b.params.repositoryVersion]),b.params.repositoryVersion?N?s().createElement(s().Fragment,null,s().createElement(p.PO,{fields:[{label:i.ag._("Version number"),value:N.number},{label:i.ag._("Created date"),value:s().createElement(p.Id,{date:N.pulp_created})},{label:i.ag._("Content added"),value:s().createElement(I,{data:null===(t=N.content_summary)||void 0===t?void 0:t.added})},{label:i.ag._("Content removed"),value:s().createElement(I,{data:null===(r=N.content_summary)||void 0===r?void 0:r.removed})},{label:i.ag._("Current content"),value:s().createElement(I,{data:null===(n=N.content_summary)||void 0===n?void 0:n.present})},{label:i.ag._("Base version"),value:s().createElement(L,{repositoryName:E,data:N.base_version})}]}),s().createElement("div",{className:"pf-c-page__main-section",style:{padding:"8px 0",margin:"24px -16px 0"}}),s().createElement(A,(0,P.Z)({},N.content_summary.present["ansible.collection_version"],{repositoryName:E}))):s().createElement(Z.Spinner,{size:"md"}):s().createElement(p.qU,{actionContext:{addAlert:v,state:S,setState:D,query:w,hasPermission:y,hasObjectPermission:h},defaultPageSize:10,defaultSort:"-pulp_created",errorTitle:i.ag._("Repository versions could not be displayed."),filterConfig:null,listItemActions:[u.W],noDataButton:null,noDataDescription:i.ag._("Repository versions will appear once the repository is modified."),noDataTitle:i.ag._("No repository versions yet"),query:w,renderTableRow:function(e,t,r,n){var a=e.number,o=e.pulp_created,l=e.pulp_href,u=O===l,c=n.map((function(t){return t.dropdownItem(U(U({},e),{},{isLatest:u,repositoryName:E}),r)}));return s().createElement("tr",{key:t},s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:E},{repositoryVersion:a,tab:"repository-versions"})},a),u?" "+i.ag._("(latest)"):null),s().createElement("td",null,s().createElement(p.Id,{date:o})),s().createElement(p.cT,{kebabItems:c}))},sortHeaders:[{title:i.ag._("Version number"),type:"numeric",id:"number"},{title:i.ag._("Created date"),type:"numeric",id:"pulp_created"}],title:i.ag._("Repository versions")})};function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G=[{id:"details",name:i.ag._("Details")},{id:"access",name:i.ag._("Access")},{id:"collection-versions",name:i.ag._("Collection versions")},{id:"repository-versions",name:i.ag._("Versions")}];const B=(0,p.L9)({breadcrumbs:function(e){var t=e.name,r=e.tab,n=e.params,a=n.repositoryVersion,o=n.group;return[{url:(0,m.dI)(m.nB.ansibleRepositories),name:i.ag._("Repositories")},{url:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t}),name:t},"repository-versions"===r.id&&a||"access"===r.id&&o?{url:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t},{tab:r.id}),name:r.name}:null,"repository-versions"===r.id&&a?{name:i.ag._("Version {repositoryVersion}",{repositoryVersion:a})}:"access"===r.id&&o?{name:i.ag._("Group {group}",{group:o})}:{name:r.name}].filter(Boolean)},condition:d.fY,displayName:"AnsibleRepositoryDetail",errorTitle:i.ag._("Repository could not be displayed."),headerActions:[u.cv,u.hE,u.sO,u.e5],headerDetails:function(e){return s().createElement(s().Fragment,null,(null==e?void 0:e.last_sync_task)&&s().createElement("p",{className:"hub-m-truncated"},s().createElement(o.cC,{id:"Last updated from registry {0}",values:{0:(0,f.Fr)(e)}})," ",(0,f.Eb)(e)))},query:function(e){var t=e.name;return c.UX.list({name:t}).then((function(e){return e.data.results[0]})).then((function(e){if(!e)return Promise.reject({response:{status:404}});var t=function(e){return console.error(e),[]};return Promise.all([c.Lj.list({repository:e.pulp_href}).then((function(e){return e.data.results})).catch(t),c.UX.myPermissions((0,f.LL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch(t)]).then((function(t){var r=(0,a.Z)(t,2),n=r[0],o=r[1];return T(T({},e),{},{distributions:n,my_permissions:o})}))}))},renderTab:function(e,t,r){return{details:s().createElement(E,{item:t,actionContext:r}),access:s().createElement(y,{item:t,actionContext:r}),"collection-versions":s().createElement(O,{item:t,actionContext:r}),"repository-versions":s().createElement(N,{item:t,actionContext:r})}[e]},tabs:G,tabUpdateParams:function(e){return delete e.repositoryVersion,delete e.group,e}})}}]);
//# sourceMappingURL=../sourcemaps/8118.130d1ef5b656c946ba60990860177651.js.map