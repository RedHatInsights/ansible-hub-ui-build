"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[8118],{48118:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var a=r(4942),n=r(70885),l=r(82080),o=r(89555),i=r(92950),s=r.n(i),u=r(61811),c=r(92403),d=r(27515),m=r(61647),p=r(6640),f=r(15751),v=function(e){var t=e.item,r=e.actionContext,a=r.addAlert,l=r.featureFlags,u=r.hasPermission,v=r.state.params,g=r.user,b=(null==t?void 0:t.pulp_href)&&(0,f.LL)(t.pulp_href),y=(0,i.useState)(null==t?void 0:t.name),h=(0,n.Z)(y,2),_=h[0],E=h[1],O=(0,i.useState)(null),P=(0,n.Z)(O,2),R=P[0],w=P[1],S=(0,i.useState)(null),j=(0,n.Z)(S,2),U=j[0],Z=j[1],D=(0,i.useState)(!1),k=(0,n.Z)(D,2),z=k[0],B=k[1],x=(0,i.useState)(null),C=(0,n.Z)(x,2),L=C[0],N=C[1],I=(0,i.useState)(null),T=(0,n.Z)(I,2),q=T[0],X=T[1],A=(0,i.useState)(null),F=(0,n.Z)(A,2),G=F[0],V=F[1],W=(0,i.useState)(null),M=(0,n.Z)(W,2),Q=M[0],H=M[1],Y=(0,i.useState)(null),K=(0,n.Z)(Y,2),J=K[0],$=K[1],ee=(0,i.useState)(null),te=(0,n.Z)(ee,2),re=te[0],ae=te[1],ne=(0,i.useState)(null),le=(0,n.Z)(ne,2),oe=le[0],ie=le[1],se=(0,i.useState)(null),ue=(0,n.Z)(se,2),ce=ue[0],de=ue[1],me=function(){Z(null),w(null),c.UX.myPermissions(b).then((function(e){var t=e.data.permissions;B((0,p.X0)({hasPermission:u,hasObjectPermission:function(e){return t.includes(e)},user:g,featureFlags:l})),c.UX.listRoles(b,{page_size:100}).then((function(e){var t=e.data.roles,r=(0,f.lR)(t),a=r.users,n=r.groups;E(_),Z(a),w(n)})).catch((function(){Z([]),w([])}))})).catch((function(){Z([]),w([]),B(!1)}))},pe=function(e){var t=e.roles,r=e.alertSuccess,n=e.alertFailure,l=e.stateUpdate;Promise.all(t).then((function(){a({title:r,variant:"success"}),me()})).catch((function(e){var t=e.response,r=t.status,l=t.statusText;a({title:n,variant:"danger",description:(0,f.N3)(r,l)})})).finally((function(){fe(l)}))},fe=function(e){Object.entries(e).forEach((function(e){var t=(0,n.Z)(e,2),r=t[0],a=t[1];switch(r){case"showUserRemoveModal":V(a);break;case"showUserSelectWizard":H(a);break;case"showGroupRemoveModal":$(a);break;case"showGroupSelectWizard":ae(a);break;case"showRoleRemoveModal":ie(a);break;case"showRoleSelectWizard":de(a);break;default:console.error("updateProps",r,a)}}))};return(0,i.useEffect)(me,[t.pulp_href]),(0,i.useEffect)((function(){U&&(null!=v&&v.user?c.vq.list({username:v.user}).then((function(e){var t=e.data.data;X(U.find((function(e){return e.username===t[0].username})))})):X(null))}),[null==v?void 0:v.user,U]),(0,i.useEffect)((function(){R&&(null!=v&&v.group?c.lO.list({name:v.group}).then((function(e){var t=e.data.data;N(R.find((function(e){return e.name===t[0].name})))})):N(null))}),[null==v?void 0:v.group,R]),s().createElement(d.yW,{addGroup:function(e,t){var r=t.map((function(t){return c.UX.addRole(b,{role:t.name,groups:[e.name]})}));pe({roles:r,alertSuccess:o.ag._({id:"lylrvu",values:{0:e.name,name:_}}),alertFailure:o.ag._({id:"9/YKZd",values:{0:e.name,name:_}}),stateUpdate:{showGroupSelectWizard:null}})},addRole:function(e,t){var r=t.map((function(t){return c.UX.addRole(b,{role:t.name,groups:[e.name]})}));pe({roles:r,alertSuccess:o.ag._({id:"svLSRe",values:{0:e.name,name:_}}),alertFailure:o.ag._({id:"eeQk9h",values:{0:e.name,name:_}}),stateUpdate:{showRoleSelectWizard:null}})},addUser:function(e,t){var r=t.map((function(t){return c.UX.addRole(b,{role:t.name,users:[e.username]})}));pe({roles:r,alertSuccess:o.ag._({id:"J7EvK0",values:{0:e.username,name:_}}),alertFailure:o.ag._({id:"0P+eGj",values:{0:e.username,name:_}}),stateUpdate:{showUserSelectWizard:null}})},addUserRole:function(e,t){var r=t.map((function(t){return c.UX.addRole(b,{role:t.name,users:[e.username]})}));pe({roles:r,alertSuccess:o.ag._({id:"ifVlo4",values:{0:e.username,name:_}}),alertFailure:o.ag._({id:"xJC6dy",values:{0:e.username,name:_}}),stateUpdate:{showRoleSelectWizard:null}})},canEditOwners:z,group:L,groups:R,name:_,pulpObjectType:"repositories/ansible/ansible",removeGroup:function(e){var t=e.object_roles.map((function(t){return c.UX.removeRole(b,{role:t,groups:[e.name]})}));pe({roles:t,alertSuccess:o.ag._({id:"94LxzI",values:{0:e.name,name:_}}),alertFailure:o.ag._({id:"j17tAi",values:{0:e.name,name:_}}),stateUpdate:{showGroupRemoveModal:null}})},removeRole:function(e,t){var r=c.UX.removeRole(b,{role:e,groups:[t.name]});pe({roles:[r],alertSuccess:o.ag._({id:"svLSRe",values:{0:t.name,name:_}}),alertFailure:o.ag._({id:"eeQk9h",values:{0:t.name,name:_}}),stateUpdate:{showRoleRemoveModal:null}})},removeUser:function(e){var t=e.object_roles.map((function(t){return c.UX.removeRole(b,{role:t,users:[e.username]})}));pe({roles:t,alertSuccess:o.ag._({id:"ekGBsh",values:{0:e.username,name:_}}),alertFailure:o.ag._({id:"O21voo",values:{0:e.username,name:_}}),stateUpdate:{showUserRemoveModal:null}})},removeUserRole:function(e,t){var r=c.UX.removeRole(b,{role:e,users:[t.username]});pe({roles:[r],alertSuccess:o.ag._({id:"ifVlo4",values:{0:t.username,name:_}}),alertFailure:o.ag._({id:"xJC6dy",values:{0:t.username,name:_}}),stateUpdate:{showRoleRemoveModal:null}})},selectRolesMessage:o.ag._({id:"WoaabF"}),showGroupRemoveModal:J,showGroupSelectWizard:re,showRoleRemoveModal:oe,showRoleSelectWizard:ce,showUserRemoveModal:G,showUserSelectWizard:Q,updateProps:fe,user:q,users:U,urlPrefix:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:_})})},g=r(62012);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h=function(e){var t=e.item,r=e.actionContext,a=r.addAlert,l=r.hasPermission,p=function(){var e=y({},(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params);e.ordering=e.sort,delete e.sort;var r=(0,f.LL)(t.pulp_href);return c.eq.list(y({repository:r},e)).then((function(e){var t=e.data;return{data:{count:t.meta.count,results:t.data}}}))},v=(0,i.useState)({repository:t}),b=(0,n.Z)(v,2),h=b[0],_=b[1];return(0,i.useEffect)((function(){return _((function(e){return y(y({},e),{},{repository:t})}))}),[t]),s().createElement(d.qU,{actionContext:{addAlert:a,state:h,setState:_,query:p,hasPermission:l,hasObjectPermission:function(e){var r,a;return null==t||null===(r=t.my_permissions)||void 0===r||null===(a=r.includes)||void 0===a?void 0:a.call(r,e)}},defaultPageSize:10,defaultSort:"name",errorTitle:o.ag._({id:"GNyQoC"}),filterConfig:[{id:"keywords",title:o.ag._({id:"/n/HCO"})},{id:"namespace",title:o.ag._({id:"wMe2Qp"})}],headerActions:[u.Ub],listItemActions:[u.No],noDataButton:u.Ub.button,noDataDescription:o.ag._({id:"wATscz"}),noDataTitle:o.ag._({id:"Ut02fq"}),query:p,renderTableRow:function(e,t,r,a){var n=e.collection_version,l=n.name,o=n.namespace,i=n.version,u=n.description,c=e.repository,p=a.map((function(t){return t.dropdownItem(e,r)}));return s().createElement("tr",{key:t},s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.collectionByRepo,{repo:c.name,namespace:o,collection:l},{version:i})},o,".",l," v",i)),s().createElement("td",null,u),s().createElement(d.cT,{kebabItems:p}))},sortHeaders:[{title:o.ag._({id:"q+hNag"}),type:"none",id:"col1"},{title:o.ag._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:o.ag._({id:"QGV1gp"})})},_=function(e){var t,r=e.item;return s().createElement(d.PO,{fields:[{label:o.ag._({id:"0xnmlQ"}),value:null==r?void 0:r.name},{label:o.ag._({id:"Nu4oKW"}),value:(null==r?void 0:r.description)||o.ag._({id:"EdQY6l"})},{label:o.ag._({id:"B/CcxR"}),value:null!==(t=null==r?void 0:r.retain_repo_versions)&&void 0!==t?t:o.ag._({id:"N40H+G"})},{label:o.ag._({id:"vU/Hht"}),value:s().createElement(d.fM,{repositoryHref:null==r?void 0:r.pulp_href})},{label:o.ag._({id:"UXGlf6"}),value:null!=r&&r.distroBasePath?s().createElement(d.TO,{url:(0,f.hv)(r.distroBasePath)}):"---"},{label:o.ag._({id:"h8DugX"}),value:s().createElement(d.rT,{labels:null==r?void 0:r.pulp_labels})},{label:o.ag._({id:"zwBp5t"}),value:null!=r&&r.private?o.ag._({id:"l75CjT"}):o.ag._({id:"1UzENP"})},{label:o.ag._({id:"qlAIQ1"}),value:null!=r&&r.remote?s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRemoteDetail,{name:null==r?void 0:r.remote.name})},null==r?void 0:r.remote.name):o.ag._({id:"EdQY6l"})}]})},E=r(87462),O=r(43144),P=r(15671),R=r(97326),w=r(79340),S=r(82963),j=r(61120),U=r(15021);function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k=function(e){var t=e.href,r=e.addAlert,l=e.hasPermission,u=e.repositoryName,p=(0,i.useState)({}),f=(0,n.Z)(p,2),v=f[0],b=f[1];if(!t)return null;var y=function(e){return new(function(t){(0,w.Z)(o,t);var r,n,l=(r=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,j.Z)(r);if(n){var a=(0,j.Z)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,S.Z)(this,e)});function o(){var t;(0,P.Z)(this,o);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=l.call.apply(l,[this].concat(n)),(0,a.Z)((0,R.Z)(t),"apiPath",e.replace("/api/automation-hub/pulp/api/v3/","")),t}return(0,O.Z)(o)}(c.jx))}(t),h=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).params;return y.list(e)};return s().createElement(d.qU,{actionContext:{addAlert:r,state:v,setState:b,query:h,hasPermission:l},defaultPageSize:10,defaultSort:"name",errorTitle:o.ag._({id:"GNyQoC"}),noDataDescription:o.ag._({id:"RXBYdl"}),noDataTitle:o.ag._({id:"Ut02fq"}),query:h,renderTableRow:function(e){var t=e.manifest.collection_info,r=t.namespace,a=t.name,n=t.version,l=e.description;return s().createElement("tr",null,s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.collectionByRepo,{repo:u,namespace:r,collection:a},{version:n})},r,".",a," v",n)),s().createElement("td",null,l))},sortHeaders:[{title:o.ag._({id:"q+hNag"}),type:"none",id:"col1"},{title:o.ag._({id:"Nu4oKW"}),type:"none",id:"col2"}],title:o.ag._({id:"QGV1gp"})})},z=function(e){var t=e.data;return Object.keys(t).length?s().createElement("table",{className:"pf-c-table"},s().createElement("tr",null,s().createElement("th",null,o.ag._({id:"wBMjJ2"})),s().createElement("th",null,o.ag._({id:"rZfa42"}))),Object.entries(t).map((function(e){var t=(0,n.Z)(e,2),r=t[0],a=t[1];return s().createElement("tr",{key:r},s().createElement("td",null,a.count),s().createElement("th",null,r))}))):s().createElement(s().Fragment,null,o.ag._({id:"EdQY6l"}))},B=function(e){var t=e.repositoryName,r=e.data;if(!r)return s().createElement(s().Fragment,null,o.ag._({id:"EdQY6l"}));var a=r.split("/").at(-2);return s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t},{repositoryVersion:a,tab:"repository-versions"})},a)},x=function(e){var t,r,a,l=e.item,p=e.actionContext,v=p.addAlert,b=p.state,y=p.hasPermission,h=p.hasObjectPermission,_=(0,f.LL)(l.pulp_href),O=l.latest_version_href,P=l.name,R=function(e){var t=e.params;return c.UX.listVersions(_,t)},w=(0,i.useState)({}),S=(0,n.Z)(w,2),j=S[0],Z=S[1],x=(0,i.useState)(null),C=(0,n.Z)(x,2),L=C[0],N=C[1];return(0,i.useEffect)((function(){var e,t;b.params.repositoryVersion?(e={number:b.params.repositoryVersion},t=e.number,c.UX.listVersions(_,{number:t})).then((function(e){var t,r=e.data;null!=r&&null!==(t=r.results)&&void 0!==t&&t[0]||v({variant:"danger",title:o.ag._({id:"/NE1Mg"})}),N(r.results[0])})):N(null)}),[b.params.repositoryVersion]),b.params.repositoryVersion?L?s().createElement(s().Fragment,null,s().createElement(d.PO,{fields:[{label:o.ag._({id:"jazdz0"}),value:L.number},{label:o.ag._({id:"69Z/4c"}),value:s().createElement(d.Id,{date:L.pulp_created})},{label:o.ag._({id:"4w69Y9"}),value:s().createElement(z,{data:null===(t=L.content_summary)||void 0===t?void 0:t.added})},{label:o.ag._({id:"aE2TFq"}),value:s().createElement(z,{data:null===(r=L.content_summary)||void 0===r?void 0:r.removed})},{label:o.ag._({id:"ESNb89"}),value:s().createElement(z,{data:null===(a=L.content_summary)||void 0===a?void 0:a.present})},{label:o.ag._({id:"DgzWiz"}),value:s().createElement(B,{repositoryName:P,data:L.base_version})}]}),s().createElement("div",{className:"pf-c-page__main-section",style:{padding:"8px 0",margin:"24px -16px 0"}}),s().createElement(k,(0,E.Z)({},L.content_summary.present["ansible.collection_version"],{repositoryName:P}))):s().createElement(U.Spinner,{size:"md"}):s().createElement(d.qU,{actionContext:{addAlert:v,state:j,setState:Z,query:R,hasPermission:y,hasObjectPermission:h},defaultPageSize:10,defaultSort:"-pulp_created",errorTitle:o.ag._({id:"0e4kDo"}),filterConfig:null,listItemActions:[u.W],noDataButton:null,noDataDescription:o.ag._({id:"fjbxkP"}),noDataTitle:o.ag._({id:"asZQa0"}),query:R,renderTableRow:function(e,t,r,a){var n=e.number,l=e.pulp_created,i=e.pulp_href,u=O===i,c=a.map((function(t){return t.dropdownItem(D(D({},e),{},{isLatest:u,repositoryName:P}),r)}));return s().createElement("tr",{key:t},s().createElement("td",null,s().createElement(g.Link,{to:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:P},{repositoryVersion:n,tab:"repository-versions"})},n),u?" "+o.ag._({id:"DlLZIu"}):null),s().createElement("td",null,s().createElement(d.Id,{date:l})),s().createElement(d.cT,{kebabItems:c}))},sortHeaders:[{title:o.ag._({id:"jazdz0"}),type:"numeric",id:"number"},{title:o.ag._({id:"69Z/4c"}),type:"numeric",id:"pulp_created"}],title:o.ag._({id:"K9TbzM"})})};function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const N=(0,d.L9)({breadcrumbs:function(e){var t=e.name,r=e.tab,a=e.params,n=a.repositoryVersion,l=a.user,i=a.group;return[{url:(0,m.dI)(m.nB.ansibleRepositories),name:o.ag._({id:"ooullr"})},{url:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t}),name:t},"access"===r.id&&(i||l)||"repository-versions"===r.id&&n?{url:(0,m.dI)(m.nB.ansibleRepositoryDetail,{name:t},{tab:r.id}),name:r.name}:null,"access"===r.id&&i?{name:o.ag._({id:"8uT/P7",values:{group:i}})}:null,"access"===r.id&&l?{name:o.ag._({id:"AkUbn7",values:{user:l}})}:null,"repository-versions"===r.id&&n?{name:o.ag._({id:"s7PA8t",values:{repositoryVersion:n}})}:null,"access"===r.id&&!l&&!i||"repository-versions"===r.id&&!n?{name:r.name}:null].filter(Boolean)},condition:p.fY,displayName:"AnsibleRepositoryDetail",errorTitle:{id:"tKqvEr"},headerActions:[u.cv,u.hE,u.sO,u.e5],headerDetails:function(e){return s().createElement(s().Fragment,null,(null==e?void 0:e.last_sync_task)&&s().createElement("p",{className:"hub-m-truncated"},s().createElement(l.cC,{id:"Lpz3xV",values:{0:(0,f.Fr)(e)}})," ",(0,f.Eb)(e)))},listUrl:(0,m.dI)(m.nB.ansibleRepositories),query:function(e){var t=e.name;return c.UX.list({name:t,page_size:1}).then((function(e){return e.data.results[0]})).then((function(e){if(!e)return Promise.reject({response:{status:404}});var t=function(e){return function(t){return console.error(t),e}};return Promise.all([(0,f.YH)(e.name,e.pulp_href).catch(t(null)),c.UX.myPermissions((0,f.LL)(e.pulp_href)).then((function(e){return e.data.permissions})).catch(t([])),e.remote?c.GC.get((0,f.LL)(e.remote)).then((function(e){return e.data})).catch((function(){return null})):null]).then((function(t){var r=(0,n.Z)(t,3),a=r[0],l=r[1],o=r[2];return L(L({},e),{},{distroBasePath:a,my_permissions:l,remote:o})}))}))},renderTab:function(e,t,r){return{details:s().createElement(_,{item:t,actionContext:r}),access:s().createElement(v,{item:t,actionContext:r}),"collection-versions":s().createElement(h,{item:t,actionContext:r}),"repository-versions":s().createElement(x,{item:t,actionContext:r})}[e]},tabs:[{id:"details",name:{id:"URmyfc"}},{id:"access",name:{id:"LuXP9q"}},{id:"collection-versions",name:{id:"QGV1gp"}},{id:"repository-versions",name:{id:"IYNSdp"}}],tabUpdateParams:function(e){return delete e.repositoryVersion,delete e.group,delete e.user,e}})}}]);
//# sourceMappingURL=../sourcemaps/8118.1481612d1b8b668ce6286877af395a77.js.map