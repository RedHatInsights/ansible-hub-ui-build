"use strict";(self.webpackChunkautomationHub=self.webpackChunkautomationHub||[]).push([[9671],{89671:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a=n(45458),l=n(23029),r=n(92901),i=n(56822),c=n(53954),s=n(15361),o=n(42328),u=n(47712),m=n(85889),d=n(3913),p=n(21079),E=n(44914),h=n.n(E),f=n(49634),g=n(88756),k=n(90593),D=n(60165),_=n(75841);function L(e,t,n){return t=(0,c.A)(t),(0,i.A)(e,v()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var R=function(e){function t(e){var n;return(0,l.A)(this,t),(n=L(this,t,[e])).state={loading:!0,task:null,parentTask:null,childTasks:[],alerts:[],cancelModalVisible:!1,taskName:"",resources:[],redirect:null,polling:null},n}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidMount",value:function(){this.loadContent()}},{key:"componentWillUnmount",value:function(){this.state.polling&&clearInterval(this.state.polling)}},{key:"componentDidUpdate",value:function(e){e.routeParams.task!==this.props.routeParams.task&&(this.setState({loading:!0}),this.loadContent())}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.task,l=t.parentTask,r=t.childTasks,i=t.cancelModalVisible,c=t.alerts,s=t.taskName,o=t.resources,g=t.redirect,L=[{url:(0,D.jV)(D.Jh.taskList),name:u.Ru._({id:"JET7Si"})},{name:a?s:""}],v=null;return l&&(v=(0,_.dx)(l.pulp_href)),g?h().createElement(f.Navigate,{to:g}):n?h().createElement(k.hQ,null):h().createElement(h().Fragment,null,h().createElement(k.NS,{alerts:c,closeAlert:function(t){return e.closeAlert(t)}}),i?this.renderCancelModal():null,h().createElement(k.T$,{title:s,breadcrumbs:h().createElement(k.BI,{links:L}),pageControls:["running","waiting"].includes(a.state)&&h().createElement(m.Button,{variant:"secondary",onClick:function(){return e.setState({cancelModalVisible:!0})}},u.Ru._({id:"iNUMdZ"})),status:h().createElement(k.kx,{className:"hub-c-task-status",status:a.state})}),h().createElement(k.gZ,null,h().createElement(m.Flex,null,h().createElement(m.Flex,{direction:{default:"column"},flex:{default:"flex_1"}},h().createElement(m.FlexItem,null,h().createElement("section",{className:"body card-area"},h().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.Ru._({id:"fqgZ6m"})),h().createElement("br",null),h().createElement(m.DescriptionList,{isHorizontal:!0},h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"ogBUiv"})),h().createElement(m.DescriptionListDescription,null,a.name)),a.name!==s&&h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"2Yhrad"})),h().createElement(m.DescriptionListDescription,null,s)),h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"IiN/kH"})),h().createElement(m.DescriptionListDescription,null,h().createElement(k.gz,{date:a.finished_at}))),h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"45O6zJ"})),h().createElement(m.DescriptionListDescription,null,h().createElement(k.gz,{date:a.pulp_created})))))),h().createElement(m.FlexItem,null,h().createElement("section",{className:"body card-area"},h().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.Ru._({id:"j0dOoV"})),h().createElement("br",null),h().createElement(m.DescriptionList,{isHorizontal:!0},h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"In9f9E"})),h().createElement(m.DescriptionListDescription,null,a.task_group?a.task_group:u.Ru._({id:"0t88cp"}))),h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"ggsFl6"})),h().createElement(m.DescriptionListDescription,null,l?h().createElement(f.Link,{to:(0,D.jV)(D.Jh.taskDetail,{task:v})},(0,_.qo)(l.name)):u.Ru._({id:"TInr2q"}))),h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"dKlcTI"})),h().createElement(m.DescriptionListDescription,null,r.length?r.map((function(e){var t=(0,_.dx)(e.pulp_href);return h().createElement(E.Fragment,{key:t},h().createElement(f.Link,{to:(0,D.jV)(D.Jh.taskDetail,{task:t})},(0,_.qo)(e.name)),h().createElement("br",null))})):u.Ru._({id:"59KJyD"})))))),h().createElement(m.FlexItem,null,h().createElement("section",{className:"body card-area"},h().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.Ru._({id:"7Ackjt"})),h().createElement("br",null),o.length?h().createElement(m.DescriptionList,{isHorizontal:!0},o.map((function(e,t){return h().createElement(E.Fragment,{key:e.type+t},h().createElement("hr",null),h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"+zy2Nq"})),h().createElement(m.DescriptionListDescription,null,e.type)),e.pluginName&&h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"fOuPPd"})),h().createElement(m.DescriptionListDescription,null,e.pluginName)),e.name&&h().createElement(m.DescriptionListGroup,null,h().createElement(m.DescriptionListTerm,null,u.Ru._({id:"6YtxFj"})),h().createElement(m.DescriptionListDescription,null,e.name)))}))):u.Ru._({id:"CJcaCv"})))),h().createElement(m.Flex,{direction:{default:"column"},flex:{default:"flex_1"}},h().createElement(m.FlexItem,null,!a.error&&h().createElement("section",{className:"body card-area"},h().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.Ru._({id:"IsjXnX"})),h().createElement("br",null),a.progress_reports.length?h().createElement(m.DescriptionList,{isHorizontal:!0},a.progress_reports.reverse().map((function(e,t){return h().createElement(E.Fragment,{key:t},h().createElement("hr",null),Object.keys(e).map((function(t,n){return!!e[t]&&h().createElement(m.DescriptionListGroup,{key:t+n},h().createElement(m.DescriptionListTerm,null,{message:u.Ru._({id:"xDAtGP"}),code:u.Ru._({id:"EWPtMO"}),state:u.Ru._({id:"RS0o7b"}),done:u.Ru._({id:"DPfwMq"})}[t]||(0,p.capitalize)(t)),h().createElement(m.DescriptionListDescription,null,e[t]))}))," ")}))):h().createElement(k.IL,{icon:d.Ay,title:u.Ru._({id:"orUwNA"}),description:u.Ru._({id:"orUwNA"})})),!!a.error&&h().createElement("section",{className:"body card-area"},h().createElement(m.Title,{headingLevel:"h2",size:"lg"},u.Ru._({id:"xi4nE2"})),h().createElement("br",null),h().createElement(h().Fragment,null,h().createElement(m.Title,{headingLevel:"h3"},u.Ru._({id:"Nu4oKW"})),h().createElement(m.CodeBlock,null,a.error.description),h().createElement(m.Title,{headingLevel:"h3"},u.Ru._({id:"g3fe3D"})),h().createElement(m.CodeBlock,{className:"hub-code-block"},a.error.traceback))))))))}},{key:"renderCancelModal",value:function(){var e=this,t=this.state.taskName;return h().createElement(k.uo,{cancelAction:function(){return e.setState({cancelModalVisible:!1})},confirmAction:function(){return e.cancelTask()},title:u.Ru._({id:"iNUMdZ"}),confirmButtonTitle:u.Ru._({id:"gspY5b"})},u.Ru._({id:"NBEgeZ",values:{name:t}}))}},{key:"cancelTask",value:function(){var e=this,t=this.state,n=t.task,l=t.taskName;g.dw.patch((0,_.dx)(n.pulp_href),{state:"canceled"}).then((function(){e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.A)(e.state.alerts),[{variant:"success",title:l,description:h().createElement(o.x6,{id:"xnof66",values:{taskName:l}})}])}),e.loadContent()})).catch((function(t){var n=t.response,r=n.status,i=n.statusText;e.setState({loading:!0,cancelModalVisible:!1,alerts:[].concat((0,a.A)(e.state.alerts),[{variant:"danger",title:u.Ru._({id:"M2gqxI",values:{taskName:l}}),description:(0,_.gJ)(r,i)}])}),e.loadContent()}))}},{key:"loadContent",value:function(){var e=this;this.state.polling||this.state.task||this.setState({polling:setInterval((function(){return e.loadContent()}),1e4)});var t=this.props.routeParams.task;return g.dw.get(t).then((function(t){var n=[],a=null,l=[],r=[];if(["canceled","completed","failed"].includes(t.data.state)&&(clearInterval(e.state.polling),e.setState({polling:null})),t.data.parent_task){var i=(0,_.dx)(t.data.parent_task);n.push(g.dw.get(i).then((function(e){a=e.data})).catch((function(){return!0})))}return t.data.child_tasks.length&&t.data.child_tasks.forEach((function(e){var t=(0,_.dx)(e);n.push(g.dw.get(t).then((function(e){l.push(e.data)})).catch((function(){return!0})))})),t.data.reserved_resources_record.length&&t.data.reserved_resources_record.forEach((function(e){var t=e.replace("/api/automation-hub/pulp/api/v3/",""),a=(0,_.dx)(t),l=t.split("/"),i="",c="";l.length>=3?(i="".concat(l[0],": ").concat(l[2]),c=l[1]):e=l[0],a?n.push(g.X_.get(t).then((function(e){r.push({name:e.data.name,type:i,pluginName:c})})).catch((function(){return!0}))):r.push({type:i})})),Promise.all(n).then((function(){e.setState({task:t.data,childTasks:l,parentTask:a,loading:!1,taskName:(0,_.qo)(t.data.name),resources:r})}))})).catch((function(){e.setState({redirect:(0,D.jV)(D.Jh.notFound)})}))}},{key:"closeAlert",get:function(){return(0,k.Ap)("alerts")}}]),t}(E.Component);const T=(0,_.y)(R)}}]);
//# sourceMappingURL=../sourcemaps/9671.98996729c256271b8f5af69624388c67.js.map