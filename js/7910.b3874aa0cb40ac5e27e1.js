"use strict";(self.webpackChunkansible_hub_ui=self.webpackChunkansible_hub_ui||[]).push([[7910],{9473:(e,n,t)=>{t.d(n,{Y:()=>u});var o=t(70885),a=t(4942),c=t(45586),r=t(61647);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var l={repository:null,namespace:null,name:null,version:null,collections:[],collectionsCount:0,collection:null,content:null};function u(e){var n=e.forceReload,t=e.matchParams,a=e.navigate,s=e.setCollection,u=e.stateParams.version,p=t.collection,d=t.namespace,m=t.repo;if(n||l.repository!==m||l.namespace!==d||l.name!==p||l.version!==u){var f=i(i({},m?{repository_name:m}:{}),{},{namespace:d,name:p}),v=(u?c.eq.list(i(i({},f),{},{version:u})):c.eq.list(i(i({},f),{},{is_highest:!0}))).then((function(e){return e.data.data[0]})),y=v.then((function(e){return c.gu.getContent(d,p,e.collection_version.version)})).then((function(e){return e.data.results[0]})).catch((function(){return a((0,r.dI)(r.nB.notFound))})),h=c.eq.list(i(i({},f),{},{order_by:"-version",page_size:10})).then((function(e){return e.data})).catch((function(){return{data:[],meta:{count:0}}}));return Promise.all([h,v,y]).then((function(e){var n=(0,o.Z)(e,3),t=n[0],a=t.data,c=t.meta.count,r=n[1],i=n[2];s(a,r,i,c),l.repository=m,l.namespace=d,l.name=p,l.version=u,l.collections=a,l.collectionsCount=c,l.collection=r,l.content=i}))}s(l.collections,l.collection,l.content,l.collectionsCount)}},27910:(e,n,t)=>{t.r(n),t.d(n,{default:()=>_});var o=t(42982),a=t(70885),c=t(15671),r=t(43144),s=t(97326),i=t(79340),l=t(82963),u=t(61120),p=t(4942),d=t(13855),m=t(92950),f=t(45586),v=t(14057),y=t(61542),h=t(61647),g=t(92518),b=t(9473);function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?D(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var P=function(e){(0,i.Z)(D,e);var n,t,y=(n=D,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,u.Z)(n);if(t){var a=(0,u.Z)(this).constructor;e=Reflect.construct(o,arguments,a)}else e=o.apply(this,arguments);return(0,l.Z)(this,e)});function D(e){var n;(0,c.Z)(this,D),n=y.call(this,e),(0,p.Z)((0,s.Z)(n),"ignoredParams",["page_size","page","sort","name__icontains"]);var t=g.q6.parseParamString(e.location.search,["page","page_size"]);return t.sort=t.sort?"collection":"-collection",n.state={collections:[],collectionsCount:0,collection:null,content:null,dependencies_repos:[],params:t,usedByDependencies:[],usedByDependenciesCount:0,usedByDependenciesLoading:!0,alerts:[]},n}return(0,r.Z)(D,[{key:"componentDidMount",value:function(){this.loadData(!1)}},{key:"render",value:function(){var e=this,n=this.state,t=n.collections,o=n.collectionsCount,a=n.collection,c=n.content,r=n.params,s=n.usedByDependencies,i=n.usedByDependenciesCount,l=n.usedByDependenciesLoading,u=n.alerts;if(t.length<=0)return m.createElement(v.gO,null);var p=a.collection_version,f=a.repository,y=[h.Th,{url:(0,h.dI)(h.nB.namespaceDetail,{namespace:p.namespace}),name:p.namespace},{url:(0,h.dI)(h.nB.collectionByRepo,{namespace:p.namespace,collection:p.name,repo:f.name}),name:p.name},{name:d.ag._("Dependencies")}],b=g.q6.getReduced(r,this.ignoredParams),D=g.q6.getReduced(r,["version"]),O=!Object.keys(p.dependencies).length;return m.createElement(m.Fragment,null,m.createElement(v.UW,{alerts:u,closeAlert:function(n){return e.closeAlert(n)}}),m.createElement(v.X8,{reload:function(){return e.loadData(!0)},collections:t,collectionsCount:o,collection:a,content:c,params:b,updateParams:function(n){e.updateParams(e.combineParams(e.state.params,n),(function(){return e.loadData(!0)}))},breadcrumbs:y,activeTab:"dependencies",repo:f.name}),m.createElement(v.or,null,m.createElement("section",{className:"body"},m.createElement("div",{className:"pf-c-content collection-dependencies"},m.createElement("h1",null,d.ag._("Dependencies")),!O||i||(0,g.vS)(r,["name__icontains"])?m.createElement(m.Fragment,null,m.createElement("p",null,d.ag._("This collections requires the following collections for use")),O?m.createElement(v.vv,{title:d.ag._("No dependencies"),description:d.ag._("Collection does not have any dependencies.")}):m.createElement(v.nW,{collection:this.state.collection,dependencies_repos:this.state.dependencies_repos}),m.createElement("p",null,d.ag._("This collection is being used by")),m.createElement(v.KQ,{usedByDependencies:s,itemCount:i,params:D,usedByDependenciesLoading:l,updateParams:function(n){return e.updateParams(e.combineParams(e.state.params,n),(function(){return e.loadUsedByDependencies()}))}})):m.createElement(v.vv,{title:d.ag._("No dependencies"),description:d.ag._("Collection does not have any dependencies.")})))))}},{key:"loadData",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loadCollection(n,(function(){return e.loadCollectionsDependenciesRepos((function(){return e.loadUsedByDependencies()}))}))}},{key:"loadCollectionsDependenciesRepos",value:function(e){var n=this,t=this.state.collection.collection_version.dependencies,o=[],c=[];Object.keys(t).forEach((function(e){var r=e.split("."),s=(0,a.Z)(r,2),i=s[0],l={name:s[1],namespace:i,version_range:t[e],repo:"",path:""};o.push(l);var u=n.loadDependencyRepo(l);c.push(u)})),Promise.all(c).then((function(){n.setState({dependencies_repos:o},e())}))}},{key:"loadDependencyRepo",value:function(e){return f.eq.list({namespace:e.namespace,name:e.name,version_range:e.version_range,page_size:1}).then((function(n){var t=(0,a.Z)(n.data.data,1)[0];e.repo=t.repository.name,e.path=(0,h.dI)(h.nB.collectionByRepo,{collection:e.name,namespace:e.namespace,repo:e.repo})})).catch((function(){}))}},{key:"loadUsedByDependencies",value:function(){var e=this;this.setState({usedByDependenciesLoading:!0},(function(){e.cancelToken&&e.cancelToken.cancel("request-canceled"),e.cancelToken=f.gu.getCancelToken();var n=e.state.collection.collection_version,t=n.name,a=n.namespace;f.gu.getUsedDependenciesByCollection(a,t,g.q6.getReduced(e.state.params,["version"]),e.cancelToken).then((function(n){var t=n.data;e.setState({usedByDependencies:t.data,usedByDependenciesCount:t.meta.count,usedByDependenciesLoading:!1})})).catch((function(n){var t=n.response;if("request-canceled"!==n.message){var a=t.status,c=t.statusText;e.setState({usedByDependenciesLoading:!1,alerts:[].concat((0,o.Z)(e.state.alerts),[{variant:"danger",title:d.ag._("Dependent collections could not be displayed."),description:(0,g.N3)(a,c)}])})}})).finally((function(){e.cancelToken=void 0}))}))}},{key:"loadCollection",value:function(e,n){var t=this;(0,b.Y)({forceReload:e,matchParams:this.props.routeParams,navigate:this.props.navigate,setCollection:function(e,o,a,c){return t.setState({collections:e,collection:o,content:a,collectionsCount:c},n)},stateParams:this.state.params.version?{version:this.state.params.version}:{}})}},{key:"updateParams",get:function(){return g.q6.updateParamsMixin()}},{key:"combineParams",value:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.reduce((function(e,n){return O(O({},e),n)}))}},{key:"closeAlert",get:function(){return(0,v.NQ)("alerts")}},{key:"separateVersion",value:function(e){var n=e.match(/((\d+\.*)+)/);return n?{version:n[0]}:{}}}]),D}(m.Component);const _=(0,g.EN)(P);P.contextType=y.I}}]);
//# sourceMappingURL=../sourcemaps/7910.f0a2ceccebf1a1496c822950dd989204.js.map