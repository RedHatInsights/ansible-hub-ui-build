{"version":3,"file":"js/5868.7b95704500271d898f09.js","mappings":"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","sources":["webpack:///./src/containers/certification-dashboard/certification-dashboard.tsx"],"sourcesContent":["import { t } from '@lingui/macro';\nimport {\n  Button,\n  ButtonVariant,\n  DropdownItem,\n  Label,\n  LabelGroup,\n  Toolbar,\n  ToolbarGroup,\n  ToolbarItem,\n} from '@patternfly/react-core';\nimport {\n  CheckCircleIcon,\n  DownloadIcon,\n  ExclamationCircleIcon,\n  ExclamationTriangleIcon,\n} from '@patternfly/react-icons';\nimport * as React from 'react';\nimport { Link } from 'react-router-dom';\nimport {\n  AnsibleDistributionAPI,\n  AnsibleRepositoryAPI,\n  CertificateUploadAPI,\n  CollectionAPI,\n  CollectionVersionAPI,\n  CollectionVersionSearch,\n  Repositories,\n} from 'src/api';\nimport { Repository } from 'src/api/response-types/repositories';\nimport {\n  ApproveModal,\n  BaseHeader,\n  DateComponent,\n  EmptyStateFilter,\n  EmptyStateNoData,\n  EmptyStateUnauthorized,\n  ListItemActions,\n  Main,\n} from 'src/components';\nimport {\n  AlertList,\n  AlertType,\n  AppliedFilters,\n  CompoundFilter,\n  LoadingPageSpinner,\n  LoadingPageWithHeader,\n  Pagination,\n  SortTable,\n  UploadSingCertificateModal,\n  closeAlertMixin,\n} from 'src/components';\nimport { Constants } from 'src/constants';\nimport { AppContext } from 'src/loaders/app-context';\nimport { Paths, formatPath } from 'src/paths';\nimport {\n  ParamHelper,\n  RepositoriesUtils,\n  RouteProps,\n  errorMessage,\n  filterIsSet,\n  parsePulpIDFromURL,\n  waitForTask,\n  withRouter,\n} from 'src/utilities';\nimport './certification-dashboard.scss';\n\ninterface IState {\n  params: {\n    certification?: string;\n    namespace?: string;\n    collection?: string;\n    page?: number;\n    page_size?: number;\n    status?: string;\n    sort?: string;\n  };\n  alerts: AlertType[];\n  versions: CollectionVersionSearch[];\n  itemCount: number;\n  loading: boolean;\n  updatingVersions: CollectionVersionSearch[];\n  unauthorized: boolean;\n  inputText: string;\n  uploadCertificateModalOpen: boolean;\n  versionToUploadCertificate?: CollectionVersionSearch;\n  approveModalInfo: {\n    collectionVersion;\n  };\n  approvedRepositoryList: Repository[];\n  stagingRepoNames: string[];\n  rejectedRepoName: string;\n}\n\nclass CertificationDashboard extends React.Component<RouteProps, IState> {\n  constructor(props) {\n    super(props);\n\n    const params = ParamHelper.parseParamString(props.location.search, [\n      'page',\n      'page_size',\n    ]);\n\n    if (!params['page_size']) {\n      params['page_size'] = 10;\n    }\n\n    if (!params['sort']) {\n      params['sort'] = '-pulp_created';\n    }\n\n    if (!params['status']) {\n      params['status'] = Constants.NEEDSREVIEW;\n    }\n\n    this.state = {\n      versions: undefined,\n      itemCount: 0,\n      params: params,\n      loading: true,\n      updatingVersions: [],\n      alerts: [],\n      unauthorized: false,\n      inputText: '',\n      uploadCertificateModalOpen: false,\n      versionToUploadCertificate: null,\n      approveModalInfo: null,\n      approvedRepositoryList: [],\n      rejectedRepoName: null,\n      stagingRepoNames: [],\n    };\n  }\n\n  componentDidMount() {\n    const { user, hasPermission } = this.context;\n    if (\n      !user ||\n      user.is_anonymous ||\n      !hasPermission('ansible.modify_ansible_repo_content')\n    ) {\n      this.setState({ unauthorized: true });\n    } else {\n      this.setState({ loading: true });\n\n      const promises = [];\n\n      promises.push(this.loadRepo('staging'));\n      promises.push(this.loadRepo('rejected'));\n\n      promises.push(\n        RepositoriesUtils.listApproved()\n          .then((data) => {\n            this.setState({ approvedRepositoryList: data });\n          })\n          .catch(({ response: { status, statusText } }) => {\n            this.addAlertObj({\n              title: t`Failed to load repositories.`,\n              variant: 'danger',\n              description: errorMessage(status, statusText),\n            });\n          }),\n      );\n\n      promises.push(this.queryCollections(false));\n\n      Promise.all(promises).then(() => {\n        this.setState({ loading: false });\n        this.setState({ updatingVersions: [] });\n      });\n    }\n  }\n\n  private loadRepo(pipeline) {\n    return Repositories.list({ pulp_label_select: `pipeline=${pipeline}` })\n      .then((data) => {\n        if (data.data.results.length > 0) {\n          if (pipeline == 'staging') {\n            this.setState({\n              stagingRepoNames: data.data.results.map((res) => res.name),\n            });\n          }\n\n          if (pipeline == 'rejected') {\n            this.setState({ rejectedRepoName: data.data.results[0].name });\n          }\n        }\n      })\n      .catch((error) => {\n        this.addAlert(\n          t`Error loading repository with label ${pipeline}.`,\n          'danger',\n          error?.message,\n        );\n      });\n  }\n\n  render() {\n    const { versions, params, itemCount, loading, unauthorized } = this.state;\n    if (!versions && !unauthorized) {\n      return <LoadingPageWithHeader></LoadingPageWithHeader>;\n    }\n\n    return (\n      <React.Fragment>\n        <BaseHeader title={t`Approval dashboard`}></BaseHeader>\n        <AlertList\n          alerts={this.state.alerts}\n          closeAlert={(i) => this.closeAlert(i)}\n        />\n        {unauthorized ? (\n          <EmptyStateUnauthorized />\n        ) : (\n          <Main className='hub-certification-dashboard'>\n            <section className='body' data-cy='body'>\n              <div className='toolbar hub-toolbar'>\n                <Toolbar>\n                  <ToolbarGroup>\n                    <ToolbarItem>\n                      <CompoundFilter\n                        inputText={this.state.inputText}\n                        onChange={(text) => {\n                          this.setState({ inputText: text });\n                        }}\n                        updateParams={(p) =>\n                          this.updateParams(p, () =>\n                            this.queryCollections(true),\n                          )\n                        }\n                        params={params}\n                        filterConfig={[\n                          {\n                            id: 'namespace',\n                            title: t`Namespace`,\n                          },\n                          {\n                            id: 'name',\n                            title: t`Collection Name`,\n                          },\n                          {\n                            id: 'status',\n                            title: t`Status`,\n                            inputType: 'select',\n                            options: [\n                              {\n                                id: Constants.NOTCERTIFIED,\n                                title: t`Rejected`,\n                              },\n                              {\n                                id: Constants.NEEDSREVIEW,\n                                title: t`Needs Review`,\n                              },\n                              {\n                                id: Constants.APPROVED,\n                                title: t`Approved`,\n                              },\n                            ],\n                          },\n                        ]}\n                      />\n                    </ToolbarItem>\n                  </ToolbarGroup>\n                </Toolbar>\n\n                <Pagination\n                  params={params}\n                  updateParams={(p) =>\n                    this.updateParams(p, () => this.queryCollections(true))\n                  }\n                  count={itemCount}\n                  isTop\n                />\n              </div>\n              <div>\n                <AppliedFilters\n                  updateParams={(p) => {\n                    this.updateParams(p, () => this.queryCollections(true));\n                    this.setState({ inputText: '' });\n                  }}\n                  params={params}\n                  ignoredParams={['page_size', 'page', 'sort']}\n                  niceValues={{\n                    status: {\n                      [Constants.APPROVED]: t`Approved`,\n                      [Constants.NEEDSREVIEW]: t`Needs Review`,\n                      [Constants.NOTCERTIFIED]: t`Rejected`,\n                    },\n                  }}\n                  niceNames={{\n                    status: t`Status`,\n                  }}\n                />\n              </div>\n              {loading ? (\n                <LoadingPageSpinner />\n              ) : (\n                this.renderTable(versions, params)\n              )}\n\n              <div className='footer'>\n                <Pagination\n                  params={params}\n                  updateParams={(p) =>\n                    this.updateParams(p, () => this.queryCollections(true))\n                  }\n                  count={itemCount}\n                />\n              </div>\n            </section>\n            <UploadSingCertificateModal\n              isOpen={this.state.uploadCertificateModalOpen}\n              onCancel={() => this.closeUploadCertificateModal()}\n              onSubmit={(d) => this.submitCertificate(d)}\n            />\n            {this.state.approveModalInfo && (\n              <ApproveModal\n                closeAction={() => {\n                  this.setState({ approveModalInfo: null });\n                }}\n                finishAction={() => {\n                  this.setState({ approveModalInfo: null });\n                  this.queryCollections(true);\n                }}\n                collectionVersion={\n                  this.state.approveModalInfo.collectionVersion\n                }\n                addAlert={(alert) => this.addAlertObj(alert)}\n                allRepositories={this.state.approvedRepositoryList}\n                stagingRepoNames={this.state.stagingRepoNames}\n                rejectedRepoName={this.state.rejectedRepoName}\n              />\n            )}\n          </Main>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  private renderTable(versions, params) {\n    if (versions.length === 0) {\n      return filterIsSet(params, ['namespace', 'name', 'status']) ? (\n        <EmptyStateFilter />\n      ) : (\n        <EmptyStateNoData\n          title={t`No managed collections yet`}\n          description={t`Collections will appear once uploaded`}\n        />\n      );\n    }\n    const sortTableOptions = {\n      headers: [\n        {\n          title: t`Namespace`,\n          type: 'alpha',\n          id: 'namespace',\n        },\n        {\n          title: t`Collection`,\n          type: 'alpha',\n          id: 'name',\n        },\n        {\n          title: t`Version`,\n          type: 'number',\n          id: 'version',\n        },\n        {\n          title: t`Date created`,\n          type: 'number',\n          id: 'pulp_created',\n        },\n        {\n          title: t`Repository`,\n          type: 'none',\n          id: '',\n        },\n        {\n          title: t`Status`,\n          type: 'none',\n          id: 'status',\n        },\n        {\n          title: '',\n          type: 'none',\n          id: 'certify',\n        },\n      ],\n    };\n\n    return (\n      <table\n        aria-label={t`Collection versions`}\n        className='hub-c-table-content pf-c-table'\n      >\n        <SortTable\n          options={sortTableOptions}\n          params={params}\n          updateParams={(p) =>\n            this.updateParams(p, () => this.queryCollections(true))\n          }\n        />\n        <tbody>\n          {versions.map((version, i) => this.renderRow(version, i))}\n        </tbody>\n      </table>\n    );\n  }\n\n  private isVersionUpdating(collection: CollectionVersionSearch) {\n    return this.state.updatingVersions.find((v) => {\n      return v == collection;\n    });\n  }\n\n  private renderStatus(collectionData: CollectionVersionSearch) {\n    const { repository } = collectionData;\n    const repoStatus = repository.pulp_labels?.pipeline;\n\n    if (this.isVersionUpdating(collectionData)) {\n      return <span className='fa fa-lg fa-spin fa-spinner' />;\n    }\n\n    if (this.isApproved(collectionData)) {\n      const { display_signatures } = this.context.featureFlags;\n      return (\n        <Label variant='outline' color='green' icon={<CheckCircleIcon />}>\n          {display_signatures && collectionData.is_signed\n            ? t`Signed and approved`\n            : t`Approved`}\n        </Label>\n      );\n    }\n    if (repoStatus === Constants.NOTCERTIFIED) {\n      return (\n        <Label variant='outline' color='red' icon={<ExclamationCircleIcon />}>\n          {t`Rejected`}\n        </Label>\n      );\n    }\n    if (repoStatus === Constants.NEEDSREVIEW) {\n      const { can_upload_signatures, require_upload_signatures } =\n        this.context.featureFlags;\n      return (\n        <Label\n          variant='outline'\n          color='orange'\n          icon={<ExclamationTriangleIcon />}\n        >\n          {!collectionData.is_signed &&\n          can_upload_signatures &&\n          require_upload_signatures\n            ? t`Needs signature and review`\n            : t`Needs review`}\n        </Label>\n      );\n    }\n  }\n\n  private renderRow(collectionData: CollectionVersionSearch, index) {\n    const { collection_version: version, repository } = collectionData;\n    const data_cy = `CertificationDashboard-row-${collectionData.repository.name}-${collectionData.collection_version.namespace}-${collectionData.collection_version.name}`;\n    return (\n      <tr key={index} data-cy={data_cy}>\n        <td>{version.namespace}</td>\n        <td>{version.name}</td>\n        <td>\n          <Link\n            to={formatPath(\n              Paths.collectionByRepo,\n              {\n                namespace: version.namespace,\n                collection: version.name,\n                repo: repository.name,\n              },\n              {\n                version: version.version,\n              },\n            )}\n          >\n            {version.version}\n          </Link>\n          <Button\n            variant={ButtonVariant.link}\n            onClick={() => {\n              this.download(\n                repository,\n                version.namespace,\n                version.name,\n                version.version,\n              );\n            }}\n          >\n            <DownloadIcon />\n          </Button>\n        </td>\n        <td>\n          <DateComponent date={version.pulp_created} />\n        </td>\n        <td>\n          <LabelGroup>{repository.name}</LabelGroup>\n        </td>\n        <td>{this.renderStatus(collectionData)}</td>\n        {this.renderButtons(collectionData)}\n      </tr>\n    );\n  }\n\n  private renderButtons(collectionData: CollectionVersionSearch) {\n    // not checking namespace permissions here, auto_sign happens API side, so is the permission check\n    const { collection_version: version, repository } = collectionData;\n    const {\n      can_upload_signatures,\n      collection_auto_sign,\n      require_upload_signatures,\n    } = this.context.featureFlags;\n    if (this.isVersionUpdating(collectionData)) {\n      return <ListItemActions />; // empty td;\n    }\n\n    const canUploadSignature =\n      can_upload_signatures && !collectionData.is_signed;\n    const mustUploadSignature = canUploadSignature && require_upload_signatures;\n    const autoSign = collection_auto_sign && !require_upload_signatures;\n\n    const approveButton = [\n      canUploadSignature && (\n        <React.Fragment key='upload'>\n          <Button\n            onClick={() => this.openUploadCertificateModal(collectionData)}\n          >\n            {t`Upload signature`}\n          </Button>{' '}\n        </React.Fragment>\n      ),\n      <Button\n        key='approve'\n        isDisabled={mustUploadSignature}\n        data-cy='approve-button'\n        onClick={() => {\n          this.approve(collectionData);\n        }}\n      >\n        {autoSign ? t`Sign and approve` : t`Approve`}\n      </Button>,\n    ].filter(Boolean);\n\n    const importsLink = (\n      <DropdownItem\n        key='imports'\n        component={\n          <Link\n            to={formatPath(\n              Paths.myImports,\n              {},\n              {\n                namespace: version.namespace,\n                name: version.name,\n                version: version.version,\n              },\n            )}\n          >\n            {t`View Import Logs`}\n          </Link>\n        }\n      />\n    );\n\n    const certifyDropDown = (isDisabled: boolean) => (\n      <DropdownItem\n        onClick={() => this.approve(collectionData)}\n        isDisabled={isDisabled}\n        key='certify'\n      >\n        {autoSign ? t`Sign and approve` : t`Approve`}\n      </DropdownItem>\n    );\n\n    const rejectDropDown = (isDisabled: boolean) => (\n      <DropdownItem\n        onClick={() => {\n          this.reject(collectionData);\n        }}\n        isDisabled={isDisabled}\n        className='rejected-icon'\n        key='reject'\n      >\n        {t`Reject`}\n      </DropdownItem>\n    );\n\n    const repoStatus = repository.pulp_labels?.pipeline;\n\n    if (this.isApproved(collectionData)) {\n      return (\n        <ListItemActions\n          kebabItems={[\n            certifyDropDown(true),\n            rejectDropDown(false),\n            importsLink,\n          ]}\n        />\n      );\n    }\n\n    if (repoStatus === Constants.NOTCERTIFIED) {\n      // render reject button if version is in multiple repositories including rejected state - handles inconsistency\n      // and allows user to reject it again to move it all to rejected state\n      return (\n        <ListItemActions\n          kebabItems={[\n            certifyDropDown(false),\n            rejectDropDown(true),\n            importsLink,\n          ]}\n        />\n      );\n    }\n\n    if (repoStatus === Constants.NEEDSREVIEW) {\n      return (\n        <ListItemActions\n          kebabItems={[rejectDropDown(false), importsLink]}\n          buttons={approveButton}\n        />\n      );\n    }\n  }\n\n  private openUploadCertificateModal(version: CollectionVersionSearch) {\n    this.setState({\n      uploadCertificateModalOpen: true,\n      versionToUploadCertificate: version,\n    });\n  }\n\n  private closeUploadCertificateModal() {\n    this.setState({\n      uploadCertificateModalOpen: false,\n      versionToUploadCertificate: null,\n    });\n  }\n\n  private submitCertificate(file: File) {\n    const { collection_version, repository } =\n      this.state.versionToUploadCertificate;\n    const signed_collection = collection_version.pulp_href;\n    const { name, namespace, version } = collection_version;\n    CertificateUploadAPI.upload({\n      file,\n      repository: repository.pulp_href,\n      signed_collection,\n    })\n      .then((result) => waitForTask(parsePulpIDFromURL(result.data.task)))\n      .then(() =>\n        this.addAlert(\n          t`Certificate for collection \"${namespace} ${name} v${version}\" has been successfully uploaded.`,\n          'success',\n        ),\n      )\n      .then(() => this.queryCollections(true))\n      .catch((error) => {\n        const description = !error.response\n          ? error\n          : errorMessage(error.response.status, error.response.statusText);\n\n        this.addAlert(\n          t`The certificate for \"${namespace} ${name} v${version}\" could not be saved.`,\n          'danger',\n          description,\n        );\n      })\n      .finally(() => this.closeUploadCertificateModal());\n  }\n\n  private isApproved(collection: CollectionVersionSearch) {\n    if (!collection) {\n      return false;\n    }\n\n    return this.state.approvedRepositoryList.find(\n      (r) => r.name == collection.repository.name,\n    );\n  }\n\n  private approve(collection) {\n    if (!collection) {\n      // I hope that this may not occure ever, but to be sure...\n      this.addAlert(\n        t`Approval failed.`,\n        'danger',\n        t`Collection not found in any repository.`,\n      );\n      return;\n    }\n\n    const { approvedRepositoryList } = this.state;\n\n    if (approvedRepositoryList.length == 1) {\n      if (collection.repository) {\n        this.updateCertification(\n          collection.collection_version,\n          collection.repository.name,\n          this.state.approvedRepositoryList[0].name,\n        );\n      } else {\n        // I hope that this may not occure ever, but to be sure...\n        this.addAlert(\n          t`Approval failed.`,\n          'danger',\n          t`Collection has to be in rejected or staging repository.`,\n        );\n      }\n    } else {\n      this.transformToCollectionVersion(collection).then(\n        (collectionVersion) => {\n          this.setState({ approveModalInfo: { collectionVersion } });\n        },\n      );\n    }\n  }\n\n  private reject(collection) {\n    const originalRepo = collection.repository.name;\n    const version = collection.collection_version;\n\n    this.transformToCollectionVersion(collection)\n      .then((versionWithRepos) => {\n        this.setState({ updatingVersions: [collection] });\n        if (\n          versionWithRepos.repository_list.includes(this.state.rejectedRepoName)\n        ) {\n          // collection already in rejected repository, so remove it from aproved repo\n\n          RepositoriesUtils.deleteCollection(originalRepo, version.pulp_href)\n            .then(() => {\n              this.addAlert(\n                t`Certification status for collection \"${version.namespace} ${version.name} v${version.version}\" has been successfully updated.`,\n                'success',\n              );\n              this.queryCollections(true);\n            })\n            .catch((error) => {\n              this.setState({ updatingVersions: [] });\n              const description = !error.response\n                ? error\n                : errorMessage(\n                    error.response.status,\n                    error.response.statusText,\n                  );\n\n              this.addAlert(\n                t`Changes to certification status for collection \"${version.namespace} ${version.name} v${version.version}\" could not be saved.`,\n                'danger',\n                description,\n              );\n            });\n        } else {\n          // collection is not in rejected state, move it there\n          this.updateCertification(\n            version,\n            originalRepo,\n            this.state.rejectedRepoName,\n          );\n        }\n      })\n      .catch((error) => {\n        const description = !error.response\n          ? error\n          : errorMessage(error.response.status, error.response.statusText);\n\n        this.addAlert(\n          t`Changes to certification status for collection \"${version.namespace} ${version.name} v${version.version}\" could not be saved.`,\n          'danger',\n          description,\n        );\n      });\n  }\n\n  private async distributionByRepoName(name) {\n    const repository = (await AnsibleRepositoryAPI.list({ name }))?.data\n      ?.results?.[0];\n    if (!repository) {\n      return Promise.reject(t`Failed to find repository ${name}`);\n    }\n\n    const distribution = (\n      await AnsibleDistributionAPI.list({ repository: repository.pulp_href })\n    )?.data?.results?.[0];\n    if (!distribution) {\n      return Promise.reject(\n        t`Failed to find a distribution for repository ${name}`,\n      );\n    }\n\n    return distribution;\n  }\n\n  private updateCertification(version, originalRepo, destinationRepo) {\n    // galaxy_ng CollectionRepositoryMixing.get_repos uses the distribution base path to look up repository pk\n    // there ..may be room for simplification since we already know the repo; OTOH also compatibility concerns\n    return Promise.all([\n      this.distributionByRepoName(originalRepo),\n      this.distributionByRepoName(destinationRepo),\n    ])\n      .then(([source, destination]) =>\n        CollectionVersionAPI.move(\n          version.namespace,\n          version.name,\n          version.version,\n          source.base_path,\n          destination.base_path,\n        ),\n      )\n      .then((result) =>\n        waitForTask(result.data.remove_task_id, { waitMs: 500 }),\n      )\n      .then(() =>\n        this.addAlert(\n          t`Certification status for collection \"${version.namespace} ${version.name} v${version.version}\" has been successfully updated.`,\n          'success',\n        ),\n      )\n      .then(() => this.queryCollections(true))\n      .catch((error) => {\n        const description = !error.response\n          ? error\n          : errorMessage(error.response.status, error.response.statusText);\n\n        this.addAlert(\n          t`Changes to certification status for collection \"${version.namespace} ${version.name} v${version.version}\" could not be saved.`,\n          'danger',\n          description,\n        );\n      });\n  }\n\n  private queryCollections(handleLoading) {\n    if (handleLoading) {\n      this.setState({\n        loading: true,\n      });\n    }\n\n    const { status, sort, ...params } = this.state.params;\n\n    const updatedParams = {\n      order_by: sort,\n      ...params,\n    };\n\n    if (status) {\n      updatedParams['repository_label'] = `pipeline=${status}`;\n    }\n\n    return CollectionVersionAPI.list(updatedParams)\n      .then((result) => {\n        this.setState({\n          versions: result.data.data,\n          itemCount: result.data.meta.count,\n        });\n        if (handleLoading) {\n          this.setState({\n            loading: false,\n            updatingVersions: [],\n          });\n        }\n      })\n      .catch((error) => {\n        this.addAlert(t`Error loading collections.`, 'danger', error?.message);\n        this.setState({\n          loading: false,\n          updatingVersions: [],\n        });\n      });\n  }\n\n  private download(\n    repository: CollectionVersionSearch['repository'],\n    namespace: string,\n    name: string,\n    version: string,\n  ) {\n    CollectionAPI.getDownloadURL(repository, namespace, name, version).then(\n      (downloadURL: string) => {\n        window.location.assign(downloadURL);\n      },\n    );\n  }\n\n  private get updateParams() {\n    return ParamHelper.updateParamsMixin();\n  }\n\n  private get closeAlert() {\n    return closeAlertMixin('alerts');\n  }\n\n  private addAlert(title, variant, description?) {\n    this.setState({\n      alerts: [\n        ...this.state.alerts,\n        {\n          description,\n          title,\n          variant,\n        },\n      ],\n    });\n  }\n\n  private addAlertObj(alert) {\n    this.addAlert(alert.title, alert.variant, alert.description);\n  }\n\n  async getCollectionRepoList(collection: CollectionVersionSearch) {\n    const { name, namespace, version } = collection.collection_version;\n\n    // get repository list for selected collection\n    const collectionInRepos = await CollectionVersionAPI.list({\n      namespace,\n      name,\n      version,\n      page_size: 100000,\n      offset: 0,\n    });\n\n    const collectionRepos = collectionInRepos.data.data.map(\n      ({ repository }) => repository.name,\n    );\n\n    return collectionRepos;\n  }\n\n  // compose from collectionVersionSearch to CollectionVersion structure for approval modal\n  async transformToCollectionVersion(collection: CollectionVersionSearch) {\n    const repoList = await this.getCollectionRepoList(collection);\n\n    const { collection_version } = collection;\n    const id = parsePulpIDFromURL(collection_version.pulp_href);\n    const collectionVersion = {\n      id,\n      version: collection_version.version,\n      namespace: collection_version.namespace,\n      name: collection_version.name,\n      repository_list: repoList,\n    };\n\n    return collectionVersion;\n  }\n}\n\nexport default withRouter(CertificationDashboard);\n\nCertificationDashboard.contextType = AppContext;\n"],"names":["CertificationDashboard","_React$Component","_inherits","_transformToCollectionVersion","_getCollectionRepoList","_distributionByRepoName","_super","props","_this","_classCallCheck","call","params","ParamHelper","location","search","Constants","state","versions","undefined","itemCount","loading","updatingVersions","alerts","unauthorized","inputText","uploadCertificateModalOpen","versionToUploadCertificate","approveModalInfo","approvedRepositoryList","rejectedRepoName","stagingRepoNames","_createClass","key","value","_this2","_this$context","this","context","user","hasPermission","is_anonymous","setState","promises","push","loadRepo","RepositoriesUtils","then","data","_ref","_ref$response","response","status","statusText","addAlertObj","title","i18n","variant","description","errorMessage","queryCollections","Promise","all","pipeline","_this3","Repositories","pulp_label_select","concat","results","length","map","res","name","error","addAlert","message","_status","_this4","_this$state","React","BaseHeader","AlertList","closeAlert","i","EmptyStateUnauthorized","Main","className","Toolbar","ToolbarGroup","ToolbarItem","CompoundFilter","onChange","text","updateParams","p","filterConfig","id","inputType","options","Pagination","count","isTop","AppliedFilters","ignoredParams","niceValues","_defineProperty","niceNames","LoadingPageSpinner","renderTable","UploadSingCertificateModal","isOpen","onCancel","closeUploadCertificateModal","onSubmit","d","submitCertificate","ApproveModal","closeAction","finishAction","collectionVersion","alert","allRepositories","LoadingPageWithHeader","_this5","filterIsSet","EmptyStateFilter","EmptyStateNoData","sortTableOptions","headers","type","SortTable","version","renderRow","collection","find","v","collectionData","_repository$pulp_labe","repoStatus","repository","pulp_labels","isVersionUpdating","isApproved","display_signatures","featureFlags","Label","color","icon","CheckCircleIcon","is_signed","ExclamationCircleIcon","_this$context$feature","can_upload_signatures","require_upload_signatures","ExclamationTriangleIcon","index","_this6","collection_version","data_cy","namespace","Link","to","formatPath","Paths","repo","Button","ButtonVariant","onClick","download","DownloadIcon","DateComponent","date","pulp_created","LabelGroup","renderStatus","renderButtons","_repository$pulp_labe2","_this7","_this$context$feature2","collection_auto_sign","ListItemActions","canUploadSignature","mustUploadSignature","autoSign","approveButton","openUploadCertificateModal","isDisabled","approve","filter","Boolean","importsLink","DropdownItem","component","certifyDropDown","rejectDropDown","reject","kebabItems","buttons","file","_this8","_this$state$versionTo","signed_collection","pulp_href","CertificateUploadAPI","result","waitForTask","parsePulpIDFromURL","task","r","_this9","updateCertification","transformToCollectionVersion","_this10","originalRepo","versionWithRepos","repository_list","includes","_asyncToGenerator","_regeneratorRuntime","_callee","_yield$AnsibleReposit","_yield$AnsibleReposit2","_yield$AnsibleReposit3","_yield$AnsibleDistrib","_yield$AnsibleDistrib2","_yield$AnsibleDistrib3","distribution","_context","prev","next","AnsibleRepositoryAPI","t1","sent","t0","t2","abrupt","AnsibleDistributionAPI","t4","t3","t5","stop","_x","apply","arguments","destinationRepo","_this11","distributionByRepoName","_ref2","_ref3","_slicedToArray","source","destination","CollectionVersionAPI","base_path","remove_task_id","waitMs","handleLoading","_this12","_this$state$params","updatedParams","_objectSpread","order_by","sort","_objectWithoutProperties","_excluded","meta","CollectionAPI","downloadURL","window","assign","get","closeAlertMixin","_toConsumableArray","_callee2","_collection$collectio","collectionInRepos","collectionRepos","_context2","page_size","offset","_ref4","_x2","_callee3","repoList","_context3","getCollectionRepoList","_x3","withRouter","contextType","AppContext"],"sourceRoot":""}