{"version":3,"file":"js/5868.95a6a2844428b8ad78a5.js","mappings":"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","sources":["webpack:///./src/containers/certification-dashboard/certification-dashboard.tsx"],"sourcesContent":["import { t } from '@lingui/macro';\nimport {\n  Button,\n  ButtonVariant,\n  DropdownItem,\n  Label,\n  LabelGroup,\n  Toolbar,\n  ToolbarContent,\n  ToolbarGroup,\n  ToolbarItem,\n} from '@patternfly/react-core';\nimport {\n  CheckCircleIcon,\n  DownloadIcon,\n  ExclamationCircleIcon,\n  ExclamationTriangleIcon,\n} from '@patternfly/react-icons';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport {\n  AnsibleRepositoryAPI,\n  AnsibleRepositoryType,\n  CertificateUploadAPI,\n  CollectionAPI,\n  CollectionVersionAPI,\n  CollectionVersionSearch,\n} from 'src/api';\nimport {\n  ApproveModal,\n  BaseHeader,\n  DateComponent,\n  EmptyStateFilter,\n  EmptyStateNoData,\n  EmptyStateUnauthorized,\n  ListItemActions,\n  Main,\n} from 'src/components';\nimport {\n  AlertList,\n  AlertType,\n  AppliedFilters,\n  CompoundFilter,\n  LoadingPageSpinner,\n  LoadingPageWithHeader,\n  Pagination,\n  SortTable,\n  UploadSingCertificateModal,\n  closeAlertMixin,\n} from 'src/components';\nimport { Constants } from 'src/constants';\nimport { AppContext } from 'src/loaders/app-context';\nimport { Paths, formatPath } from 'src/paths';\nimport {\n  ParamHelper,\n  RepositoriesUtils,\n  RouteProps,\n  errorMessage,\n  filterIsSet,\n  parsePulpIDFromURL,\n  repositoryBasePath,\n  waitForTask,\n  withRouter,\n} from 'src/utilities';\nimport './certification-dashboard.scss';\n\ninterface IState {\n  params: {\n    certification?: string;\n    namespace?: string;\n    collection?: string;\n    page?: number;\n    page_size?: number;\n    repository_label?: string;\n    sort?: string;\n  };\n  alerts: AlertType[];\n  versions: CollectionVersionSearch[];\n  itemCount: number;\n  loading: boolean;\n  updatingVersions: CollectionVersionSearch[];\n  unauthorized: boolean;\n  inputText: string;\n  uploadCertificateModalOpen: boolean;\n  versionToUploadCertificate?: CollectionVersionSearch;\n  approveModalInfo: {\n    collectionVersion;\n  };\n  approvedRepositoryList: AnsibleRepositoryType[];\n  stagingRepoNames: string[];\n  rejectedRepoName: string;\n}\n\nclass CertificationDashboard extends React.Component<RouteProps, IState> {\n  constructor(props) {\n    super(props);\n\n    const params = ParamHelper.parseParamString(props.location.search, [\n      'page',\n      'page_size',\n    ]);\n\n    if (!params['page_size']) {\n      params['page_size'] = 10;\n    }\n\n    if (!params['sort']) {\n      params['sort'] = '-pulp_created';\n    }\n\n    if (!params['repository_label']) {\n      params['repository_label'] = `pipeline=${Constants.NEEDSREVIEW}`;\n    }\n\n    this.state = {\n      versions: undefined,\n      itemCount: 0,\n      params: params,\n      loading: true,\n      updatingVersions: [],\n      alerts: [],\n      unauthorized: false,\n      inputText: '',\n      uploadCertificateModalOpen: false,\n      versionToUploadCertificate: null,\n      approveModalInfo: null,\n      approvedRepositoryList: [],\n      rejectedRepoName: null,\n      stagingRepoNames: [],\n    };\n  }\n\n  componentDidMount() {\n    const { user, hasPermission } = this.context;\n    if (\n      !user ||\n      user.is_anonymous ||\n      !hasPermission('ansible.modify_ansible_repo_content')\n    ) {\n      this.setState({ unauthorized: true });\n    } else {\n      this.setState({ loading: true });\n\n      const promises = [];\n\n      promises.push(\n        this.loadRepos('staging').then((stagingRepoNames) =>\n          this.setState({\n            stagingRepoNames,\n          }),\n        ),\n      );\n      promises.push(\n        this.loadRepos('rejected').then(([rejectedRepoName]) =>\n          this.setState({ rejectedRepoName }),\n        ),\n      );\n\n      promises.push(\n        // TODO: replace getAll pagination\n        RepositoriesUtils.listApproved()\n          .then((data) => {\n            this.setState({ approvedRepositoryList: data });\n          })\n          .catch(({ response: { status, statusText } }) => {\n            this.addAlertObj({\n              title: t`Failed to load repositories.`,\n              variant: 'danger',\n              description: errorMessage(status, statusText),\n            });\n          }),\n      );\n\n      promises.push(this.queryCollections(false));\n\n      Promise.all(promises).then(() => {\n        this.setState({ loading: false });\n        this.setState({ updatingVersions: [] });\n      });\n    }\n  }\n\n  private loadRepos(pipeline) {\n    return AnsibleRepositoryAPI.list({\n      pulp_label_select: `pipeline=${pipeline}`,\n    })\n      .then(({ data: { results } }) => (results || []).map(({ name }) => name))\n      .catch((error) => {\n        this.addAlert(\n          t`Error loading repository with label ${pipeline}.`,\n          'danger',\n          error?.message,\n        );\n      });\n  }\n\n  render() {\n    const { versions, params, itemCount, loading, unauthorized } = this.state;\n    if (!versions && !unauthorized) {\n      return <LoadingPageWithHeader />;\n    }\n\n    return (\n      <React.Fragment>\n        <BaseHeader title={t`Approval dashboard`} />\n        <AlertList\n          alerts={this.state.alerts}\n          closeAlert={(i) => this.closeAlert(i)}\n        />\n        {unauthorized ? (\n          <EmptyStateUnauthorized />\n        ) : (\n          <Main className='hub-certification-dashboard'>\n            <section className='body' data-cy='body'>\n              <div className='hub-toolbar'>\n                <Toolbar>\n                  <ToolbarContent>\n                    <ToolbarGroup>\n                      <ToolbarItem>\n                        <CompoundFilter\n                          inputText={this.state.inputText}\n                          onChange={(text) => {\n                            this.setState({ inputText: text });\n                          }}\n                          updateParams={(p) =>\n                            this.updateParams(p, () =>\n                              this.queryCollections(true),\n                            )\n                          }\n                          params={params}\n                          filterConfig={[\n                            {\n                              id: 'namespace',\n                              title: t`Namespace`,\n                            },\n                            {\n                              id: 'name',\n                              title: t`Collection name`,\n                            },\n                            {\n                              id: 'repository_label',\n                              title: t`Status`,\n                              inputType: 'select',\n                              options: [\n                                {\n                                  id: `pipeline=${Constants.NOTCERTIFIED}`,\n                                  title: t`Rejected`,\n                                },\n                                {\n                                  id: `pipeline=${Constants.NEEDSREVIEW}`,\n                                  title: t`Needs Review`,\n                                },\n                                {\n                                  id: `pipeline=${Constants.APPROVED}`,\n                                  title: t`Approved`,\n                                },\n                              ],\n                            },\n                          ]}\n                        />\n                      </ToolbarItem>\n                    </ToolbarGroup>\n                  </ToolbarContent>\n                </Toolbar>\n\n                <Pagination\n                  params={params}\n                  updateParams={(p) =>\n                    this.updateParams(p, () => this.queryCollections(true))\n                  }\n                  count={itemCount}\n                  isTop\n                />\n              </div>\n              <div>\n                <AppliedFilters\n                  updateParams={(p) => {\n                    this.updateParams(p, () => this.queryCollections(true));\n                    this.setState({ inputText: '' });\n                  }}\n                  params={params}\n                  ignoredParams={['page_size', 'page', 'sort']}\n                  niceValues={{\n                    repository_label: {\n                      [`pipeline=${Constants.APPROVED}`]: t`Approved`,\n                      [`pipeline=${Constants.NEEDSREVIEW}`]: t`Needs Review`,\n                      [`pipeline=${Constants.NOTCERTIFIED}`]: t`Rejected`,\n                    },\n                  }}\n                  niceNames={{\n                    name: t`Collection name`,\n                    namespace: t`Namespace`,\n                    repository_label: t`Status`,\n                  }}\n                />\n              </div>\n              {loading ? (\n                <LoadingPageSpinner />\n              ) : (\n                this.renderTable(versions, params)\n              )}\n\n              <div className='footer'>\n                <Pagination\n                  params={params}\n                  updateParams={(p) =>\n                    this.updateParams(p, () => this.queryCollections(true))\n                  }\n                  count={itemCount}\n                />\n              </div>\n            </section>\n            <UploadSingCertificateModal\n              isOpen={this.state.uploadCertificateModalOpen}\n              onCancel={() => this.closeUploadCertificateModal()}\n              onSubmit={(d) => this.submitCertificate(d)}\n            />\n            {this.state.approveModalInfo && (\n              <ApproveModal\n                closeAction={() => {\n                  this.setState({ approveModalInfo: null });\n                }}\n                finishAction={() => {\n                  this.setState({ approveModalInfo: null });\n                  this.queryCollections(true);\n                }}\n                collectionVersion={\n                  this.state.approveModalInfo.collectionVersion\n                }\n                addAlert={(alert) => this.addAlertObj(alert)}\n                allRepositories={this.state.approvedRepositoryList}\n                stagingRepoNames={this.state.stagingRepoNames}\n                rejectedRepoName={this.state.rejectedRepoName}\n              />\n            )}\n          </Main>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  private renderTable(versions, params) {\n    if (versions.length === 0) {\n      return filterIsSet(params, ['namespace', 'name', 'repository_label']) ? (\n        <EmptyStateFilter />\n      ) : (\n        <EmptyStateNoData\n          title={t`No managed collections yet`}\n          description={t`Collections will appear once uploaded`}\n        />\n      );\n    }\n    const sortTableOptions = {\n      headers: [\n        {\n          title: t`Namespace`,\n          type: 'alpha',\n          id: 'namespace',\n        },\n        {\n          title: t`Collection`,\n          type: 'alpha',\n          id: 'name',\n        },\n        {\n          title: t`Version`,\n          type: 'number',\n          id: 'version',\n        },\n        {\n          title: t`Date created`,\n          type: 'number',\n          id: 'pulp_created',\n        },\n        {\n          title: t`Repository`,\n          type: 'none',\n          id: '',\n        },\n        {\n          title: t`Status`,\n          type: 'none',\n          id: 'repository_label',\n        },\n        {\n          title: '',\n          type: 'none',\n          id: 'certify',\n        },\n      ],\n    };\n\n    return (\n      <table\n        aria-label={t`Collection versions`}\n        className='hub-c-table-content pf-c-table'\n      >\n        <SortTable\n          options={sortTableOptions}\n          params={params}\n          updateParams={(p) =>\n            this.updateParams(p, () => this.queryCollections(true))\n          }\n        />\n        <tbody>\n          {versions.map((version, i) => this.renderRow(version, i))}\n        </tbody>\n      </table>\n    );\n  }\n\n  private isVersionUpdating(collection: CollectionVersionSearch) {\n    return this.state.updatingVersions.find((v) => {\n      return v == collection;\n    });\n  }\n\n  private renderStatus(collectionData: CollectionVersionSearch) {\n    const { repository } = collectionData;\n    const repoStatus = repository.pulp_labels?.pipeline;\n\n    if (this.isVersionUpdating(collectionData)) {\n      return <span className='fa fa-lg fa-spin fa-spinner' />;\n    }\n\n    if (this.isApproved(collectionData)) {\n      const { display_signatures } = this.context.featureFlags;\n      return (\n        <Label variant='outline' color='green' icon={<CheckCircleIcon />}>\n          {display_signatures && collectionData.is_signed\n            ? t`Signed and approved`\n            : t`Approved`}\n        </Label>\n      );\n    }\n    if (repoStatus === Constants.NOTCERTIFIED) {\n      return (\n        <Label variant='outline' color='red' icon={<ExclamationCircleIcon />}>\n          {t`Rejected`}\n        </Label>\n      );\n    }\n    if (repoStatus === Constants.NEEDSREVIEW) {\n      const { can_upload_signatures, require_upload_signatures } =\n        this.context.featureFlags;\n      return (\n        <Label\n          variant='outline'\n          color='orange'\n          icon={<ExclamationTriangleIcon />}\n        >\n          {!collectionData.is_signed &&\n          can_upload_signatures &&\n          require_upload_signatures\n            ? t`Needs signature and review`\n            : t`Needs review`}\n        </Label>\n      );\n    }\n  }\n\n  private renderRow(collectionData: CollectionVersionSearch, index) {\n    const { collection_version: version, repository } = collectionData;\n    const data_cy = `CertificationDashboard-row-${collectionData.repository.name}-${collectionData.collection_version.namespace}-${collectionData.collection_version.name}`;\n    return (\n      <tr key={index} data-cy={data_cy}>\n        <td>{version.namespace}</td>\n        <td>{version.name}</td>\n        <td>\n          <Link\n            to={formatPath(\n              Paths.collectionByRepo,\n              {\n                namespace: version.namespace,\n                collection: version.name,\n                repo: repository.name,\n              },\n              {\n                version: version.version,\n              },\n            )}\n          >\n            {version.version}\n          </Link>\n          <Button\n            variant={ButtonVariant.link}\n            onClick={() => {\n              this.download(\n                repository,\n                version.namespace,\n                version.name,\n                version.version,\n              );\n            }}\n          >\n            <DownloadIcon />\n          </Button>\n        </td>\n        <td>\n          <DateComponent date={version.pulp_created} />\n        </td>\n        <td>\n          <LabelGroup>{repository.name}</LabelGroup>\n        </td>\n        <td>{this.renderStatus(collectionData)}</td>\n        {this.renderButtons(collectionData)}\n      </tr>\n    );\n  }\n\n  private renderButtons(collectionData: CollectionVersionSearch) {\n    // not checking namespace permissions here, auto_sign happens API side, so is the permission check\n    const { collection_version: version, repository } = collectionData;\n    const {\n      can_upload_signatures,\n      collection_auto_sign,\n      require_upload_signatures,\n    } = this.context.featureFlags;\n    if (this.isVersionUpdating(collectionData)) {\n      return <ListItemActions />; // empty td;\n    }\n\n    const canUploadSignature =\n      can_upload_signatures && !collectionData.is_signed;\n    const mustUploadSignature = canUploadSignature && require_upload_signatures;\n    const autoSign = collection_auto_sign && !require_upload_signatures;\n\n    const approveButton = [\n      canUploadSignature && (\n        <React.Fragment key='upload'>\n          <Button\n            onClick={() => this.openUploadCertificateModal(collectionData)}\n          >\n            {t`Upload signature`}\n          </Button>{' '}\n        </React.Fragment>\n      ),\n      <Button\n        key='approve'\n        isDisabled={mustUploadSignature}\n        data-cy='approve-button'\n        onClick={() => {\n          this.approve(collectionData);\n        }}\n      >\n        {autoSign ? t`Sign and approve` : t`Approve`}\n      </Button>,\n    ].filter(Boolean);\n\n    const importsLink = (\n      <DropdownItem\n        key='imports'\n        component={\n          <Link\n            to={formatPath(\n              Paths.myImports,\n              {},\n              {\n                namespace: version.namespace,\n                name: version.name,\n                version: version.version,\n              },\n            )}\n          >\n            {t`View Import Logs`}\n          </Link>\n        }\n      />\n    );\n\n    const certifyDropDown = (isDisabled: boolean) => (\n      <DropdownItem\n        onClick={() => this.approve(collectionData)}\n        isDisabled={isDisabled}\n        key='certify'\n      >\n        {autoSign ? t`Sign and approve` : t`Approve`}\n      </DropdownItem>\n    );\n\n    const rejectDropDown = (isDisabled: boolean) => (\n      <DropdownItem\n        onClick={() => {\n          this.reject(collectionData);\n        }}\n        isDisabled={isDisabled}\n        className='rejected-icon'\n        key='reject'\n      >\n        {t`Reject`}\n      </DropdownItem>\n    );\n\n    const repoStatus = repository.pulp_labels?.pipeline;\n\n    if (this.isApproved(collectionData)) {\n      return (\n        <ListItemActions\n          kebabItems={[\n            certifyDropDown(true),\n            rejectDropDown(false),\n            importsLink,\n          ]}\n        />\n      );\n    }\n\n    if (repoStatus === Constants.NOTCERTIFIED) {\n      // render reject button if version is in multiple repositories including rejected state - handles inconsistency\n      // and allows user to reject it again to move it all to rejected state\n      return (\n        <ListItemActions\n          kebabItems={[\n            certifyDropDown(false),\n            rejectDropDown(true),\n            importsLink,\n          ]}\n        />\n      );\n    }\n\n    if (repoStatus === Constants.NEEDSREVIEW) {\n      return (\n        <ListItemActions\n          kebabItems={[rejectDropDown(false), importsLink]}\n          buttons={approveButton}\n        />\n      );\n    }\n  }\n\n  private openUploadCertificateModal(version: CollectionVersionSearch) {\n    this.setState({\n      uploadCertificateModalOpen: true,\n      versionToUploadCertificate: version,\n    });\n  }\n\n  private closeUploadCertificateModal() {\n    this.setState({\n      uploadCertificateModalOpen: false,\n      versionToUploadCertificate: null,\n    });\n  }\n\n  private submitCertificate(file: File) {\n    const { collection_version, repository } =\n      this.state.versionToUploadCertificate;\n    const signed_collection = collection_version.pulp_href;\n    const { name, namespace, version } = collection_version;\n    CertificateUploadAPI.upload({\n      file,\n      repository: repository.pulp_href,\n      signed_collection,\n    })\n      .then((result) => waitForTask(parsePulpIDFromURL(result.data.task)))\n      .then(() =>\n        this.addAlert(\n          t`Certificate for collection \"${namespace} ${name} v${version}\" has been successfully uploaded.`,\n          'success',\n        ),\n      )\n      .then(() => this.queryCollections(true))\n      .catch((error) => {\n        const description = !error.response\n          ? error\n          : errorMessage(error.response.status, error.response.statusText);\n\n        this.addAlert(\n          t`The certificate for \"${namespace} ${name} v${version}\" could not be saved.`,\n          'danger',\n          description,\n        );\n      })\n      .finally(() => this.closeUploadCertificateModal());\n  }\n\n  private isApproved(collection: CollectionVersionSearch) {\n    if (!collection) {\n      return false;\n    }\n\n    return this.state.approvedRepositoryList.find(\n      (r) => r.name == collection.repository.name,\n    );\n  }\n\n  private approve(collection) {\n    if (!collection) {\n      // I hope that this may not occure ever, but to be sure...\n      this.addAlert(\n        t`Approval failed.`,\n        'danger',\n        t`Collection not found in any repository.`,\n      );\n      return;\n    }\n\n    const { approvedRepositoryList } = this.state;\n\n    if (approvedRepositoryList.length == 1) {\n      if (collection.repository) {\n        this.updateCertification(\n          collection.collection_version,\n          collection.repository.name,\n          this.state.approvedRepositoryList[0].name,\n        );\n      } else {\n        // I hope that this may not occure ever, but to be sure...\n        this.addAlert(\n          t`Approval failed.`,\n          'danger',\n          t`Collection has to be in rejected or staging repository.`,\n        );\n      }\n    } else {\n      this.transformToCollectionVersion(collection).then(\n        (collectionVersion) => {\n          this.setState({ approveModalInfo: { collectionVersion } });\n        },\n      );\n    }\n  }\n\n  private reject(collection) {\n    const originalRepo = collection.repository.name;\n    const version = collection.collection_version;\n\n    this.transformToCollectionVersion(collection)\n      .then((versionWithRepos) => {\n        this.setState({ updatingVersions: [collection] });\n        if (\n          versionWithRepos.repository_list.includes(this.state.rejectedRepoName)\n        ) {\n          // collection already in rejected repository, so remove it from aproved repo\n\n          RepositoriesUtils.deleteCollection(originalRepo, version.pulp_href)\n            .then(() => {\n              this.addAlert(\n                t`Certification status for collection \"${version.namespace} ${version.name} v${version.version}\" has been successfully updated.`,\n                'success',\n              );\n              this.queryCollections(true);\n            })\n            .catch((error) => {\n              this.setState({ updatingVersions: [] });\n              const description = !error.response\n                ? error\n                : errorMessage(\n                    error.response.status,\n                    error.response.statusText,\n                  );\n\n              this.addAlert(\n                t`Changes to certification status for collection \"${version.namespace} ${version.name} v${version.version}\" could not be saved.`,\n                'danger',\n                description,\n              );\n            });\n        } else {\n          // collection is not in rejected state, move it there\n          this.updateCertification(\n            version,\n            originalRepo,\n            this.state.rejectedRepoName,\n          );\n        }\n      })\n      .catch((error) => {\n        const description = !error.response\n          ? error\n          : errorMessage(error.response.status, error.response.statusText);\n\n        this.addAlert(\n          t`Changes to certification status for collection \"${version.namespace} ${version.name} v${version.version}\" could not be saved.`,\n          'danger',\n          description,\n        );\n      });\n  }\n\n  private updateCertification(version, originalRepo, destinationRepo) {\n    // galaxy_ng CollectionRepositoryMixing.get_repos uses the distribution base path to look up repository pk\n    // there ..may be room for simplification since we already know the repo; OTOH also compatibility concerns\n    return Promise.all([\n      repositoryBasePath(originalRepo),\n      repositoryBasePath(destinationRepo),\n    ])\n      .then(([source, destination]) =>\n        CollectionVersionAPI.move(\n          version.namespace,\n          version.name,\n          version.version,\n          source,\n          destination,\n        ),\n      )\n      .then((result) =>\n        waitForTask(result.data.remove_task_id, { waitMs: 500 }),\n      )\n      .then(() =>\n        this.addAlert(\n          t`Certification status for collection \"${version.namespace} ${version.name} v${version.version}\" has been successfully updated.`,\n          'success',\n        ),\n      )\n      .then(() => this.queryCollections(true))\n      .catch((error) => {\n        const description = !error.response\n          ? error\n          : errorMessage(error.response.status, error.response.statusText);\n\n        this.addAlert(\n          t`Changes to certification status for collection \"${version.namespace} ${version.name} v${version.version}\" could not be saved.`,\n          'danger',\n          description,\n        );\n      });\n  }\n\n  private queryCollections(handleLoading) {\n    if (handleLoading) {\n      this.setState({\n        loading: true,\n      });\n    }\n\n    const { sort, ...params } = this.state.params;\n    const updatedParams = {\n      order_by: sort,\n      ...params,\n    };\n\n    return CollectionVersionAPI.list(updatedParams)\n      .then((result) => {\n        this.setState({\n          versions: result.data.data,\n          itemCount: result.data.meta.count,\n        });\n        if (handleLoading) {\n          this.setState({\n            loading: false,\n            updatingVersions: [],\n          });\n        }\n      })\n      .catch((error) => {\n        this.addAlert(t`Error loading collections.`, 'danger', error?.message);\n        this.setState({\n          loading: false,\n          updatingVersions: [],\n        });\n      });\n  }\n\n  private download(\n    repository: CollectionVersionSearch['repository'],\n    namespace: string,\n    name: string,\n    version: string,\n  ) {\n    CollectionAPI.getDownloadURL(repository, namespace, name, version).then(\n      (downloadURL: string) => {\n        window.location.assign(downloadURL);\n      },\n    );\n  }\n\n  private get updateParams() {\n    return ParamHelper.updateParamsMixin();\n  }\n\n  private get closeAlert() {\n    return closeAlertMixin('alerts');\n  }\n\n  private addAlert(title, variant, description?) {\n    this.setState({\n      alerts: [\n        ...this.state.alerts,\n        {\n          description,\n          title,\n          variant,\n        },\n      ],\n    });\n  }\n\n  private addAlertObj(alert) {\n    this.addAlert(alert.title, alert.variant, alert.description);\n  }\n\n  // compose from collectionVersionSearch to CollectionVersion structure for approval modal\n  async transformToCollectionVersion(collection: CollectionVersionSearch) {\n    const repoList = await RepositoriesUtils.getCollectionRepoList(collection);\n\n    const { collection_version } = collection;\n    const id = parsePulpIDFromURL(collection_version.pulp_href);\n    const collectionVersion = {\n      id,\n      version: collection_version.version,\n      namespace: collection_version.namespace,\n      name: collection_version.name,\n      repository_list: repoList,\n    };\n\n    return collectionVersion;\n  }\n}\n\nexport default withRouter(CertificationDashboard);\n\nCertificationDashboard.contextType = AppContext;\n"],"names":["CertificationDashboard","_React$Component","_inherits","_transformToCollectionVersion","_super","props","_this","_classCallCheck","call","params","ParamHelper","parseParamString","location","search","concat","Constants","NEEDSREVIEW","state","versions","undefined","itemCount","loading","updatingVersions","alerts","unauthorized","inputText","uploadCertificateModalOpen","versionToUploadCertificate","approveModalInfo","approvedRepositoryList","rejectedRepoName","stagingRepoNames","_createClass","key","value","_this2","_this$context","this","context","user","hasPermission","is_anonymous","setState","promises","push","loadRepos","then","_ref","_slicedToArray","RepositoriesUtils","listApproved","data","_ref3","_ref3$response","response","status","statusText","addAlertObj","title","i18n","_","id","variant","description","errorMessage","queryCollections","Promise","all","pipeline","_this3","AnsibleRepositoryAPI","list","pulp_label_select","_ref4","results","map","_ref5","name","error","addAlert","values","message","_repository_label","_this4","_this$state","React","BaseHeader","AlertList","closeAlert","i","EmptyStateUnauthorized","Main","className","Toolbar","ToolbarContent","ToolbarGroup","ToolbarItem","CompoundFilter","onChange","text","updateParams","p","filterConfig","inputType","options","NOTCERTIFIED","APPROVED","Pagination","count","isTop","AppliedFilters","ignoredParams","niceValues","repository_label","_defineProperty","niceNames","namespace","LoadingPageSpinner","renderTable","UploadSingCertificateModal","isOpen","onCancel","closeUploadCertificateModal","onSubmit","d","submitCertificate","ApproveModal","closeAction","finishAction","collectionVersion","alert","allRepositories","LoadingPageWithHeader","_this5","length","filterIsSet","EmptyStateFilter","EmptyStateNoData","sortTableOptions","headers","type","SortTable","version","renderRow","collection","find","v","collectionData","_repository$pulp_labe","repoStatus","repository","pulp_labels","isVersionUpdating","isApproved","display_signatures","featureFlags","Label","color","icon","CheckCircleIcon","is_signed","ExclamationCircleIcon","_this$context$feature","can_upload_signatures","require_upload_signatures","ExclamationTriangleIcon","index","_this6","collection_version","data_cy","Link","to","formatPath","Paths","collectionByRepo","repo","Button","ButtonVariant","link","onClick","download","DownloadIcon","DateComponent","date","pulp_created","LabelGroup","renderStatus","renderButtons","_repository$pulp_labe2","_this7","_this$context$feature2","collection_auto_sign","ListItemActions","canUploadSignature","mustUploadSignature","autoSign","approveButton","openUploadCertificateModal","isDisabled","approve","filter","Boolean","importsLink","DropdownItem","component","myImports","certifyDropDown","rejectDropDown","reject","kebabItems","buttons","file","_this8","_this$state$versionTo","signed_collection","pulp_href","CertificateUploadAPI","upload","result","waitForTask","parsePulpIDFromURL","task","r","_this9","updateCertification","transformToCollectionVersion","_this10","originalRepo","versionWithRepos","repository_list","includes","deleteCollection","destinationRepo","_this11","repositoryBasePath","_ref6","_ref7","source","destination","CollectionVersionAPI","move","remove_task_id","waitMs","handleLoading","_this12","_this$state$params","updatedParams","_objectSpread","order_by","sort","_objectWithoutProperties","_excluded","meta","CollectionAPI","getDownloadURL","downloadURL","window","assign","get","updateParamsMixin","closeAlertMixin","_toConsumableArray","_asyncToGenerator","_regeneratorRuntime","_callee","repoList","_context","prev","next","getCollectionRepoList","sent","abrupt","stop","_x","apply","arguments","withRouter","contextType","AppContext"],"sourceRoot":""}