{"version":3,"file":"js/8973.e8538ade407c02f8301e.js","mappings":"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","sources":["webpack:///./src/containers/signature-keys/list.tsx"],"sourcesContent":["import { t } from '@lingui/macro';\nimport {\n  DropdownItem,\n  Toolbar,\n  ToolbarContent,\n  ToolbarGroup,\n  ToolbarItem,\n} from '@patternfly/react-core';\nimport React from 'react';\nimport { SigningServiceAPI, SigningServiceType } from 'src/api';\nimport {\n  AlertList,\n  AlertType,\n  AppliedFilters,\n  BaseHeader,\n  ClipboardCopy,\n  CompoundFilter,\n  DateComponent,\n  EmptyStateFilter,\n  EmptyStateNoData,\n  EmptyStateUnauthorized,\n  ListItemActions,\n  LoadingPageSpinner,\n  Main,\n  Pagination,\n  SortTable,\n  closeAlertMixin,\n} from 'src/components';\nimport { AppContext } from 'src/loaders/app-context';\nimport { RouteProps, withRouter } from 'src/utilities';\nimport { ParamHelper, errorMessage, filterIsSet } from 'src/utilities';\n\ninterface IState {\n  params: {\n    page?: number;\n    page_size?: number;\n  };\n  loading: boolean;\n  items: SigningServiceType[];\n  itemCount: number;\n  alerts: AlertType[];\n  unauthorised: boolean;\n  inputText: string;\n}\n\nexport class SignatureKeysList extends React.Component<RouteProps, IState> {\n  constructor(props) {\n    super(props);\n\n    const params = ParamHelper.parseParamString(props.location.search, [\n      'page',\n      'page_size',\n    ]);\n\n    if (!params['page_size']) {\n      params['page_size'] = 100;\n    }\n\n    this.state = {\n      params: params,\n      items: [],\n      loading: true,\n      itemCount: 0,\n      alerts: [],\n      unauthorised: false,\n      inputText: '',\n    };\n  }\n\n  componentDidMount() {\n    if (!this.context.user || this.context.user.is_anonymous) {\n      this.setState({ loading: false, unauthorised: true });\n    } else {\n      this.query();\n    }\n  }\n\n  render() {\n    const { params, itemCount, loading, items, alerts, unauthorised } =\n      this.state;\n\n    const noData = items.length === 0 && !filterIsSet(params, ['name']);\n\n    return (\n      <React.Fragment>\n        <AlertList alerts={alerts} closeAlert={(i) => this.closeAlert(i)} />\n        <BaseHeader title={t`Signature keys`} />\n        {unauthorised ? (\n          <EmptyStateUnauthorized />\n        ) : noData && !loading ? (\n          <EmptyStateNoData\n            title={t`No signature keys yet`}\n            description={t`Signature keys will appear once created.`}\n          />\n        ) : (\n          <Main>\n            {loading ? (\n              <LoadingPageSpinner />\n            ) : (\n              <section className='body'>\n                <div className='hub-toolbar'>\n                  <Toolbar>\n                    <ToolbarContent>\n                      <ToolbarGroup>\n                        <ToolbarItem>\n                          <CompoundFilter\n                            inputText={this.state.inputText}\n                            onChange={(text) =>\n                              this.setState({ inputText: text })\n                            }\n                            updateParams={(p) => {\n                              p['page'] = 1;\n                              this.updateParams(p, () => this.query());\n                            }}\n                            params={params}\n                            filterConfig={[\n                              {\n                                id: 'name',\n                                title: t`Name`,\n                              },\n                            ]}\n                          />\n                        </ToolbarItem>\n                      </ToolbarGroup>\n                    </ToolbarContent>\n                  </Toolbar>\n                  <Pagination\n                    params={params}\n                    updateParams={(p) =>\n                      this.updateParams(p, () => this.query())\n                    }\n                    count={itemCount}\n                    isTop\n                  />\n                </div>\n                <div>\n                  <AppliedFilters\n                    updateParams={(p) => {\n                      this.updateParams(p, () => this.query());\n                      this.setState({ inputText: '' });\n                    }}\n                    params={params}\n                    ignoredParams={['page_size', 'page', 'sort', 'ordering']}\n                    niceNames={{\n                      name: t`Name`,\n                    }}\n                  />\n                </div>\n                {loading ? <LoadingPageSpinner /> : this.renderTable(params)}\n\n                <Pagination\n                  params={params}\n                  updateParams={(p) => this.updateParams(p, () => this.query())}\n                  count={itemCount}\n                />\n              </section>\n            )}\n          </Main>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  private renderTable(params) {\n    const { items } = this.state;\n    if (!items.length) {\n      return <EmptyStateFilter />;\n    }\n\n    const sortTableOptions = {\n      headers: [\n        {\n          title: t`Name`,\n          type: 'none',\n          id: 'name',\n        },\n        {\n          title: t`Key fingerprint`,\n          type: 'none',\n          id: 'pubkey_fingerprint',\n        },\n        {\n          title: t`Created on`,\n          type: 'none',\n          id: 'pulp_created',\n        },\n        {\n          title: t`Public key`,\n          type: 'none',\n          id: 'public_key',\n        },\n        {\n          title: '',\n          type: 'none',\n          id: 'kebab',\n        },\n      ],\n    };\n\n    return (\n      <table\n        aria-label={t`Signature keys`}\n        className='hub-c-table-content pf-c-table'\n      >\n        <SortTable\n          options={sortTableOptions}\n          params={params}\n          updateParams={(p) => {\n            p['page'] = 1;\n            this.updateParams(p, () => this.query());\n          }}\n        />\n        <tbody>{items.map((item, i) => this.renderTableRow(item, i))}</tbody>\n      </table>\n    );\n  }\n\n  private renderTableRow(item, index: number) {\n    const { name, pubkey_fingerprint, public_key, pulp_created } = item;\n\n    const dropdownItems = [\n      <DropdownItem\n        key='download-key'\n        onClick={() => {\n          document.location =\n            'data:application/octet-stream,' + encodeURIComponent(public_key);\n        }}\n      >\n        {t`Download key`}\n      </DropdownItem>,\n    ];\n\n    return (\n      <tr key={index}>\n        <td>{name}</td>\n        <td data-cy='hub-signature-list-fingerprint'>{pubkey_fingerprint}</td>\n        <td>\n          <DateComponent date={pulp_created} />\n        </td>\n        <td>\n          <ClipboardCopy isCode isReadOnly variant={'expansion'}>\n            {public_key}\n          </ClipboardCopy>\n        </td>\n        <ListItemActions kebabItems={dropdownItems} />\n      </tr>\n    );\n  }\n\n  private get closeAlert() {\n    return closeAlertMixin('alerts');\n  }\n\n  private query() {\n    this.setState({ loading: true }, () => {\n      SigningServiceAPI.list({ sort: 'name', ...this.state.params })\n        .then((result) => {\n          this.setState({\n            items: result.data.results,\n            itemCount: result.data.count,\n            loading: false,\n          });\n        })\n        .catch((e) => {\n          const { status, statusText } = e.response;\n          this.setState({\n            loading: false,\n            items: [],\n            itemCount: 0,\n          });\n          this.addAlert({\n            title: t`Signature keys could not be displayed.`,\n            variant: 'danger',\n            description: errorMessage(status, statusText),\n          });\n        });\n    });\n  }\n\n  private addAlert(alert: AlertType) {\n    this.setState({\n      alerts: [...this.state.alerts, alert],\n    });\n  }\n\n  private get updateParams() {\n    return ParamHelper.updateParamsMixin();\n  }\n}\n\nexport default withRouter(SignatureKeysList);\n\nSignatureKeysList.contextType = AppContext;\n"],"names":["SignatureKeysList","_React$Component","props","_this","_classCallCheck","_callSuper","params","ParamHelper","parseParamString","location","search","state","items","loading","itemCount","alerts","unauthorised","inputText","_inherits","_createClass","key","value","this","context","user","is_anonymous","setState","query","_this2","_this$state","noData","length","filterIsSet","React","AlertList","closeAlert","i","BaseHeader","title","i18n","_","id","EmptyStateUnauthorized","EmptyStateNoData","description","Main","LoadingPageSpinner","className","Toolbar","ToolbarContent","ToolbarGroup","ToolbarItem","CompoundFilter","onChange","text","updateParams","p","filterConfig","Pagination","count","isTop","AppliedFilters","ignoredParams","niceNames","name","renderTable","_this3","EmptyStateFilter","sortTableOptions","headers","type","SortTable","options","map","item","renderTableRow","index","pubkey_fingerprint","public_key","pulp_created","dropdownItems","DropdownItem","onClick","document","encodeURIComponent","DateComponent","date","ClipboardCopy","isCode","isReadOnly","variant","ListItemActions","kebabItems","get","closeAlertMixin","_this4","SigningServiceAPI","list","_objectSpread","sort","then","result","data","results","e","_e$response","response","status","statusText","addAlert","errorMessage","alert","concat","_toConsumableArray","updateParamsMixin","withRouter","contextType","AppContext"],"sourceRoot":""}