{"version":3,"file":"js/namespace_list.1671199638045.4945b5b883628c0840f3.js","mappings":"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","sources":["webpack:///./src/containers/namespace-list/my-namespaces.tsx","webpack:///./src/containers/namespace-list/namespace-list.tsx","webpack:///./src/containers/namespace-list/partners.tsx"],"sourcesContent":["import * as React from 'react';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\n\nimport { NamespaceList } from './namespace-list';\nimport { Paths } from 'src/paths';\nimport { AppContext } from 'src/loaders/app-context';\nimport { EmptyStateUnauthorized } from 'src/components';\n\nclass MyNamespaces extends React.Component<RouteComponentProps> {\n  render() {\n    if (!this.context.user || this.context.user.is_anonymous) {\n      return <EmptyStateUnauthorized />;\n    }\n    return (\n      <NamespaceList\n        {...this.props}\n        namespacePath={Paths.myCollectionsByRepo}\n        filterOwner={true}\n      />\n    );\n  }\n}\n\nexport default withRouter(MyNamespaces);\nMyNamespaces.contextType = AppContext;\n","import * as React from 'react';\nimport {\n  Button,\n  Toolbar,\n  ToolbarContent,\n  ToolbarGroup,\n  ToolbarItem,\n} from '@patternfly/react-core';\nimport { RouteComponentProps, Redirect } from 'react-router-dom';\nimport { t } from '@lingui/macro';\n\nimport { ParamHelper } from 'src/utilities/param-helper';\nimport {\n  AlertList,\n  AppliedFilters,\n  BaseHeader,\n  CompoundFilter,\n  EmptyStateFilter,\n  EmptyStateNoData,\n  LinkTabs,\n  LoadingPageSpinner,\n  LoadingPageWithHeader,\n  NamespaceCard,\n  NamespaceModal,\n  Pagination,\n  Sort,\n} from 'src/components';\nimport { NamespaceAPI, NamespaceListType, MyNamespaceAPI } from 'src/api';\nimport { formatPath, namespaceBreadcrumb, Paths } from 'src/paths';\nimport { Constants } from 'src/constants';\nimport { errorMessage, filterIsSet } from 'src/utilities';\nimport { AppContext } from 'src/loaders/app-context';\nimport { i18n } from '@lingui/core';\n\nimport './namespace-list.scss';\n\ninterface IState {\n  namespaces: NamespaceListType[];\n  itemCount: number;\n  params: {\n    name?: string;\n    sort?: string;\n    page?: number;\n    page_size?: number;\n    tenant?: string;\n    keywords?: string;\n  };\n  hasPermission: boolean;\n  isModalOpen: boolean;\n  loading: boolean;\n  redirect?: string;\n  inputText: string;\n}\n\ninterface IProps extends RouteComponentProps {\n  namespacePath: Paths;\n  filterOwner?: boolean;\n}\n\nexport class NamespaceList extends React.Component<IProps, IState> {\n  nonURLParams = ['tenant'];\n\n  constructor(props) {\n    super(props);\n\n    const params = ParamHelper.parseParamString(props.location.search, [\n      'page',\n      'page_size',\n    ]);\n\n    if (!params['page_size']) {\n      params['page_size'] = 20;\n    }\n\n    if (!params['sort']) {\n      params['sort'] = 'name';\n    }\n\n    this.state = {\n      namespaces: undefined,\n      itemCount: 0,\n      params: params,\n      hasPermission: true,\n      isModalOpen: false,\n      loading: true,\n      inputText: params['keywords'] || '',\n    };\n  }\n\n  private handleModalToggle = () => {\n    this.setState(({ isModalOpen }) => ({\n      isModalOpen: !isModalOpen,\n    }));\n  };\n\n  componentDidMount() {\n    if (this.props.filterOwner) {\n      // Make a query with no params and see if it returns results to tell\n      // if the user can edit namespaces\n      MyNamespaceAPI.list({})\n        .then((results) => {\n          if (results.data.meta.count !== 0) {\n            this.loadNamespaces();\n          } else {\n            this.setState({\n              hasPermission: false,\n              namespaces: [],\n              loading: false,\n            });\n          }\n        })\n        .catch((e) => {\n          const { status, statusText } = e.response;\n          this.setState(\n            {\n              namespaces: [],\n              itemCount: 0,\n              loading: false,\n            },\n            () =>\n              this.context.setAlerts([\n                ...this.context.alerts,\n                {\n                  variant: 'danger',\n                  title: t`Namespaces list could not be displayed.`,\n                  description: errorMessage(status, statusText),\n                },\n              ]),\n          );\n        });\n    } else {\n      this.loadNamespaces();\n    }\n  }\n\n  componentWillUnmount() {\n    this.context.setAlerts([]);\n  }\n\n  render() {\n    if (this.state.redirect) {\n      return <Redirect push to={this.state.redirect} />;\n    }\n\n    const { namespaces, params, itemCount, loading, inputText } = this.state;\n    const { filterOwner } = this.props;\n    const { alerts, hasPermission } = this.context;\n    const noData =\n      !filterIsSet(this.state.params, ['keywords']) &&\n      namespaces !== undefined &&\n      namespaces.length === 0;\n\n    if (loading) {\n      return <LoadingPageWithHeader></LoadingPageWithHeader>;\n    }\n\n    // Namespaces or Partners\n    const title = i18n._(namespaceBreadcrumb.name);\n\n    return (\n      <div className='hub-namespace-page'>\n        <NamespaceModal\n          isOpen={this.state.isModalOpen}\n          toggleModal={this.handleModalToggle}\n          onCreateSuccess={(result) =>\n            this.setState({\n              redirect: formatPath(\n                Paths.namespaceByRepo,\n                {\n                  repo: 'published',\n                  namespace: result.name,\n                },\n                { tab: 'owners' },\n              ),\n            })\n          }\n        ></NamespaceModal>\n        <AlertList alerts={alerts} closeAlert={() => this.closeAlert()} />\n        <BaseHeader title={title}>\n          {!this.context.user.is_anonymous && (\n            <div className='hub-tab-link-container'>\n              <div className='tabs'>\n                <LinkTabs\n                  tabs={[\n                    {\n                      title: t`All`,\n                      link: Paths[NAMESPACE_TERM],\n                      active: !filterOwner,\n                    },\n                    {\n                      title: t`My namespaces`,\n                      link: Paths.myNamespaces,\n                      active: filterOwner,\n                    },\n                  ]}\n                />\n              </div>\n            </div>\n          )}\n          {noData ? null : (\n            <div className='toolbar'>\n              <Toolbar>\n                <ToolbarContent>\n                  <ToolbarGroup style={{ marginLeft: 0 }}>\n                    <ToolbarItem>\n                      <CompoundFilter\n                        inputText={inputText}\n                        onChange={(text) => this.setState({ inputText: text })}\n                        updateParams={(p) =>\n                          this.updateParams(p, () => this.loadNamespaces())\n                        }\n                        params={params}\n                        filterConfig={[{ id: 'keywords', title: t`keywords` }]}\n                      />\n                      <AppliedFilters\n                        style={{ marginTop: '16px' }}\n                        updateParams={(p) => {\n                          this.updateParams(p, () => this.loadNamespaces());\n                          this.setState({ inputText: '' });\n                        }}\n                        params={params}\n                        ignoredParams={['page_size', 'page', 'sort']}\n                      />\n                    </ToolbarItem>\n                  </ToolbarGroup>\n                  <ToolbarGroup style={{ alignSelf: 'start' }}>\n                    <ToolbarItem>\n                      <Sort\n                        options={[\n                          { title: t`Name`, id: 'name', type: 'alpha' },\n                        ]}\n                        params={params}\n                        updateParams={(p) =>\n                          this.updateParams(p, () => this.loadNamespaces())\n                        }\n                      />\n                    </ToolbarItem>\n                    {hasPermission('galaxy.add_namespace') && (\n                      <ToolbarItem key='create-button'>\n                        <Button\n                          variant='primary'\n                          onClick={this.handleModalToggle}\n                        >\n                          {t`Create`}\n                        </Button>\n                      </ToolbarItem>\n                    )}\n                  </ToolbarGroup>\n                </ToolbarContent>\n              </Toolbar>\n              <div>\n                <Pagination\n                  params={params}\n                  updateParams={(p) =>\n                    this.updateParams(p, () => this.loadNamespaces())\n                  }\n                  count={itemCount}\n                  isCompact\n                  perPageOptions={Constants.CARD_DEFAULT_PAGINATION_OPTIONS}\n                />\n              </div>\n            </div>\n          )}\n        </BaseHeader>\n        <section className='card-area'>{this.renderBody()}</section>\n        {noData || loading ? null : (\n          <section className='footer'>\n            <Pagination\n              params={params}\n              updateParams={(p) =>\n                this.updateParams(p, () => this.loadNamespaces())\n              }\n              perPageOptions={Constants.CARD_DEFAULT_PAGINATION_OPTIONS}\n              count={itemCount}\n            />\n          </section>\n        )}\n      </div>\n    );\n  }\n\n  private renderBody() {\n    const { namespaces, loading } = this.state;\n    const { namespacePath, filterOwner } = this.props;\n    const { hasPermission } = this.context;\n\n    const noDataTitle = t`No namespaces yet`;\n    const noDataDescription = !filterOwner\n      ? t`Namespaces will appear once created`\n      : t`This account is not set up to manage any namespaces`;\n\n    const noDataButton = hasPermission('galaxy.add_namespace') ? (\n      <Button variant='primary' onClick={() => this.handleModalToggle()}>\n        {t`Create`}\n      </Button>\n    ) : null;\n\n    if (loading) {\n      return (\n        <section>\n          <LoadingPageSpinner></LoadingPageSpinner>;\n        </section>\n      );\n    }\n\n    if (namespaces.length === 0) {\n      return (\n        <section>\n          {filterIsSet(this.state.params, ['keywords']) ? (\n            <EmptyStateFilter />\n          ) : (\n            <EmptyStateNoData\n              title={noDataTitle}\n              description={noDataDescription}\n              button={noDataButton}\n            />\n          )}\n        </section>\n      );\n    }\n\n    return (\n      <section className='card-layout'>\n        {namespaces.map((ns, i) => (\n          <div key={i} className='card-wrapper'>\n            <NamespaceCard\n              namespaceURL={formatPath(namespacePath, {\n                namespace: ns.name,\n                repo: this.context.selectedRepo,\n              })}\n              key={i}\n              {...ns}\n            ></NamespaceCard>\n          </div>\n        ))}\n      </section>\n    );\n  }\n\n  private loadNamespaces() {\n    const { filterOwner } = this.props;\n    const api = filterOwner ? MyNamespaceAPI : NamespaceAPI;\n\n    this.setState({ loading: true }, () => {\n      api\n        .list(this.state.params)\n        .then((results) => {\n          this.setState({\n            namespaces: results.data.data,\n            itemCount: results.data.meta.count,\n            loading: false,\n          });\n        })\n        .catch((e) => {\n          const { status, statusText } = e.response;\n          this.setState(\n            {\n              namespaces: [],\n              itemCount: 0,\n              loading: false,\n            },\n            () =>\n              this.context.setAlerts([\n                ...this.context.alerts,\n                {\n                  variant: 'danger',\n                  title: t`Namespaces list could not be displayed.`,\n                  description: errorMessage(status, statusText),\n                },\n              ]),\n          );\n        });\n    });\n  }\n\n  private get updateParams() {\n    return ParamHelper.updateParamsMixin(this.nonURLParams);\n  }\n\n  private closeAlert() {\n    this.context.setAlerts([]);\n  }\n}\n\nNamespaceList.contextType = AppContext;\n","import * as React from 'react';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\n\nimport { NamespaceList } from './namespace-list';\nimport { Paths } from 'src/paths';\n\nclass Partners extends React.Component<RouteComponentProps> {\n  render() {\n    return (\n      <NamespaceList\n        {...this.props}\n        namespacePath={Paths.namespaceByRepo}\n        filterOwner={false}\n      />\n    );\n  }\n}\n\nexport default withRouter(Partners);\n"],"names":["MyNamespaces","this","context","user","is_anonymous","props","namespacePath","Paths","filterOwner","React","withRouter","contextType","AppContext","NamespaceList","setState","isModalOpen","params","ParamHelper","location","search","state","namespaces","undefined","itemCount","hasPermission","loading","inputText","MyNamespaceAPI","then","results","data","meta","count","loadNamespaces","e","response","status","statusText","setAlerts","alerts","variant","title","description","errorMessage","redirect","Redirect","push","to","noData","filterIsSet","length","i18n","namespaceBreadcrumb","className","isOpen","toggleModal","handleModalToggle","onCreateSuccess","result","formatPath","repo","namespace","name","tab","closeAlert","tabs","link","active","Toolbar","ToolbarContent","ToolbarGroup","style","marginLeft","ToolbarItem","onChange","text","updateParams","p","filterConfig","id","marginTop","ignoredParams","alignSelf","options","type","key","Button","onClick","isCompact","perPageOptions","Constants","renderBody","noDataTitle","noDataDescription","noDataButton","button","map","ns","i","namespaceURL","selectedRepo","api","NamespaceAPI","list","nonURLParams","Partners"],"sourceRoot":""}